//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors

//     Underscore may be freely distributed under the MIT license.

/*!
   * Helper function that returns the first function found among its arguments.
   * If no function if found, it return a noop (empty function).
   *
   * @return {[type]} [description]
   */

/*!
   * If the value of the first argument is a function then invoke
   * it with the rest of the args, otherwise, return it.
   */

/*!
  * Actual extension loading.
  *
  * The sequence is:
  *
  * * resolves the extension reference
  * * register and requires its dependencies if any
  * * init the extension
  *
  * This method also returns a promise that allows
  * to keep track of the app's loading sequence.
  *
  * If the extension provides a `afterAppStart` method,
  * the promise will resolve to that function that
  * will be called at the end of the app loading sequence.
  *
  * @param {String|Object|Function} extDef the reference and context of the extension
  */

/*!
  * Extension resolution before actual loading.
  * If `ext` is a String, it is considered as a reference
  * to an AMD module that has to be loaded.
  *
  * This method returns a promise that resolves to the actual extension,
  * With all its dependencies already required' too.
  *
  * @param {String|Object|Function} ext the reference of the extension
  * @param {Object} context the thing this extension is supposed to extend
  */

/*!
     * App Sandboxes
     */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/**
 * @license RequireJS i18n 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/i18n for details
 */

//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors

//     Backbone may be freely distributed under the MIT license.

/**
 * turn.js 4th release
 * turnjs.com
 * turnjs.com/license.txt
 *
 * Copyright (C) 2012 Emmanuel Garcia
 * All rights reserved
 **/

/*! Hammer.JS - v1.0.9 - 2014-03-18
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */

/*!    SWFObject v2.3.20130521 <http://github.com/swfobject/swfobject>
    is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
*/

/*! jQuery requestAnimationFrame - v0.1.2 - 2013-04-15
* https://github.com/gnarf37/jquery-requestAnimationFrame
* Copyright (c) 2013 Corey Frang; Licensed MIT */

/*!

 handlebars v1.1.2

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.

//     Underscore is freely distributable under the MIT license.

/**
 * @license Handlebars hbs 0.4.0 - Alex Sexton, but Handlebars has it's own licensing junk
 *
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/require-cs for details on the plugin this was based off of
 */

(function(){(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.2";var T=x.each=x.forEach=function(e,t,r){if(e==null)return;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return arguments.length<2||n?e[x.random(e.length-1)]:x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={},s=n==null?x.identity:k(n);return T(t,function(n,o){var u=s.call(r,n,o,t);e(i,u,n)}),i}};x.groupBy=L(function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=n==null?x.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u;return function(){s=this,i=arguments,o=new Date;var a=function(){var f=new Date-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i)))},f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i)),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),!function(e,t){function n(){this._events={},this._conf&&r.call(this,this._conf)}function r(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners&&(this._events.maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this.newListener=e.newListener),this.wildcard&&(this.listenerTree={}))}function i(e){this._events={},this.newListener=!1,r.call(this,e)}function s(e,t,n,r){if(!n)return[];var i=[],o,u,a,f,l,c,h,p=t.length,d=t[r],v=t[r+1];if(r===p&&n._listeners){if(typeof n._listeners=="function")return e&&e.push(n._listeners),[n];for(o=0,u=n._listeners.length;o<u;o++)e&&e.push(n._listeners[o]);return[n]}if(d==="*"||d==="**"||n[d]){if(d==="*"){for(a in n)a!=="_listeners"&&n.hasOwnProperty(a)&&(i=i.concat(s(e,t,n[a],r+1)));return i}if(d==="**"){h=r+1===p||r+2===p&&v==="*",h&&n._listeners&&(i=i.concat(s(e,t,n,p)));for(a in n)a!=="_listeners"&&n.hasOwnProperty(a)&&(a==="*"||a==="**"?(n[a]._listeners&&!h&&(i=i.concat(s(e,t,n[a],p))),i=i.concat(s(e,t,n[a],r))):a===v?i=i.concat(s(e,t,n[a],r+2)):i=i.concat(s(e,t,n[a],r)));return i}i=i.concat(s(e,t,n[d],r+1))}f=n["*"],f&&s(e,t,f,r+1),l=n["**"];if(l)if(r<p){l._listeners&&s(e,t,l,p);for(a in l)a!=="_listeners"&&l.hasOwnProperty(a)&&(a===v?s(e,t,l[a],r+2):a===d?s(e,t,l[a],r+1):(c={},c[a]=l[a],s(e,t,{"**":c},r+1)))}else l._listeners?s(e,t,l,p):l["*"]&&l["*"]._listeners&&s(e,t,l["*"],p);return i}function o(e,t){e=typeof e=="string"?e.split(this.delimiter):e.slice();for(var n=0,r=e.length;n+1<r;n++)if(e[n]==="**"&&e[n+1]==="**")return;var i=this.listenerTree,s=e.shift();while(s){i[s]||(i[s]={}),i=i[s];if(e.length===0){if(!i._listeners)i._listeners=t;else if(typeof i._listeners=="function")i._listeners=[i._listeners,t];else if(u(i._listeners)){i._listeners.push(t);if(!i._listeners.warned){var o=a;typeof this._events.maxListeners!="undefined"&&(o=this._events.maxListeners),o>0&&i._listeners.length>o&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}return!0}s=e.shift()}return!0}var u=Array.isArray?Array.isArray:function(e){return Object.prototype.toString.call(e)==="[object Array]"},a=10;i.prototype.delimiter=".",i.prototype.setMaxListeners=function(e){this._events||n.call(this),this._events.maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e},i.prototype.event="",i.prototype.once=function(e,t){return this.many(e,1,t),this},i.prototype.many=function(e,t,n){function r(){--t===0&&i.off(e,r),n.apply(this,arguments)}var i=this;if(typeof n!="function")throw new Error("many only accepts instances of Function");return r._origin=n,this.on(e,r),i},i.prototype.emit=function(){this._events||n.call(this);var e=arguments[0];if(e==="newListener"&&!this.newListener&&!this._events.newListener)return!1;if(this._all){var t=arguments.length,r=new Array(t-1);for(var i=1;i<t;i++)r[i-1]=arguments[i];for(i=0,t=this._all.length;i<t;i++)this.event=e,this._all[i].apply(this,r)}if(e==="error"&&!this._all&&!this._events.error&&(!this.wildcard||!this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var o;if(this.wildcard){o=[];var u=typeof e=="string"?e.split(this.delimiter):e.slice();s.call(this,o,u,this.listenerTree,0)}else o=this._events[e];if(typeof o=="function"){this.event=e;if(arguments.length===1)o.call(this);else if(arguments.length>1)switch(arguments.length){case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:var t=arguments.length,r=new Array(t-1);for(var i=1;i<t;i++)r[i-1]=arguments[i];o.apply(this,r)}return!0}if(o){var t=arguments.length,r=new Array(t-1);for(var i=1;i<t;i++)r[i-1]=arguments[i];var a=o.slice();for(var i=0,t=a.length;i<t;i++)this.event=e,a[i].apply(this,r);return a.length>0||this._all}return this._all},i.prototype.on=function(e,t){if(typeof e=="function")return this.onAny(e),this;if(typeof t!="function")throw new Error("on only accepts instances of Function");this._events||n.call(this),this.emit("newListener",e,t);if(this.wildcard)return o.call(this,e,t),this;if(!this._events[e])this._events[e]=t;else if(typeof this._events[e]=="function")this._events[e]=[this._events[e],t];else if(u(this._events[e])){this._events[e].push(t);if(!this._events[e].warned){var r=a;typeof this._events.maxListeners!="undefined"&&(r=this._events.maxListeners),r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}return this},i.prototype.onAny=function(e){this._all||(this._all=[]);if(typeof e!="function")throw new Error("onAny only accepts instances of Function");return this._all.push(e),this},i.prototype.addListener=i.prototype.on,i.prototype.off=function(e,t){if(typeof t!="function")throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i=typeof e=="string"?e.split(this.delimiter):e.slice();r=s.call(this,null,i,this.listenerTree,0)}else{if(!this._events[e])return this;n=this._events[e],r.push({_listeners:n})}for(var o=0;o<r.length;o++){var a=r[o];n=a._listeners;if(u(n)){var f=-1;for(var l=0,c=n.length;l<c;l++)if(n[l]===t||n[l].listener&&n[l].listener===t||n[l]._origin&&n[l]._origin===t){f=l;break}if(f<0)continue;return this.wildcard?a._listeners.splice(f,1):this._events[e].splice(f,1),n.length===0&&(this.wildcard?delete a._listeners:delete this._events[e]),this}if(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)this.wildcard?delete a._listeners:delete this._events[e]}return this},i.prototype.offAny=function(e){var t=0,n=0,r;if(e&&this._all&&this._all.length>0){r=this._all;for(t=0,n=r.length;t<n;t++)if(e===r[t])return r.splice(t,1),this}else this._all=[];return this},i.prototype.removeListener=i.prototype.off,i.prototype.removeAllListeners=function(e){if(arguments.length===0)return!this._events||n.call(this),this;if(this.wildcard){var t=typeof e=="string"?e.split(this.delimiter):e.slice(),r=s.call(this,null,t,this.listenerTree,0);for(var i=0;i<r.length;i++){var o=r[i];o._listeners=null}}else{if(!this._events[e])return this;this._events[e]=null}return this},i.prototype.listeners=function(e){if(this.wildcard){var t=[],r=typeof e=="string"?e.split(this.delimiter):e.slice();return s.call(this,t,r,this.listenerTree,0),t}return this._events||n.call(this),this._events[e]||(this._events[e]=[]),u(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},i.prototype.listenersAny=function(){return this._all?this._all:[]},typeof define=="function"&&define.amd?define("eventemitter",[],function(){return i}):e.EventEmitter2=i}(typeof process!="undefined"&&typeof process.title!="undefined"&&typeof exports!="undefined"?exports:window),define("aura/ext/mediator",["eventemitter","underscore"],function(){return{name:"mediator",require:{paths:{eventemitter:"bower_components/eventemitter2/lib/eventemitter2",underscore:"bower_components/underscore/underscore"},shim:{underscore:{exports:"_"}}},initialize:function(e){var t=require("eventemitter"),n=require("underscore");e.config.mediator=n.defaults(e.config.mediator||{},{wildcard:!0,delimiter:".",newListener:!0,maxListeners:20});var r=new t(e.config.mediator);e.core.mediator=r;var i=function(t){return function(i,s,o){if(!n.isFunction(s)||!n.isString(i))throw new Error("Invalid arguments passed to sandbox."+t);o=o||this;var u=function(){var t=Array.prototype.slice.call(arguments);try{s.apply(o,t)}catch(n){console.warn("App logger: ",e.logger),e.logger.error("Error caught in listener '"+i+"', called with arguments: ",t,"\nError:",n.message,n,t)}};this._events=this._events||[],this._events.push({name:i,listener:s,callback:u}),r[t](i,u)}};e.sandbox.on=i("on"),e.sandbox.once=i("once"),e.sandbox.off=function(e,t){if(!this._events)return;this._events=n.reject(this._events,function(n){var i=n.name===e&&n.listener===t;return i&&r.off(e,n.callback),i})},e.sandbox.emit=function(){var t=e.config.debug;if(t.enable&&(t.components.length===0||t.components.indexOf("aura:mediator")!==-1)){var n=Array.prototype.slice.call(arguments);n.unshift("Event emitted"),e.logger.log.apply(e.logger,n)}r.emit.apply(r,arguments)},e.sandbox.stopListening=function(){if(!this._events)return;n.each(this._events,function(e){r.off(e.name,e.callback)})};var s=["aura","sandbox","stop"].join(e.config.mediator.delimiter);e.core.mediator.on(s,function(e){e.stopListening()})}}}),define("aura/ext/components",[],function(){return function(e){function t(t,n,r,i){var s=l[t+":"+n]||[],o=[];e.core.util.each(s,function(e,t){typeof t=="function"&&o.push(t.apply(r,i))});var u=e.core.data.when.apply(undefined,o).promise();return u}function n(n,r){var i;if(typeof n=="string")i=n,n=r[i]||function(){};else{if(typeof n.name!="string")throw new Error("Error invoking Component with callbacks: ",r.options.name,". first argument should be either the name of a function or of the form : { name: 'fnName', fn: function() { ... } } ");i=n.name,n=n.fn||function(){}}var s=e.core.data.deferred(),o,u,a=[].slice.call(arguments,2);o=t("before",i,r,a);var f;return o.then(function(){var e=n.apply(r,a);return e}).then(function(){t("after",i,r,a).then(function(){s.resolve(f)},s.reject)}).fail(function(t){e.logger.error("Error in Component "+r.options.name+" "+i+" callback",t),s.reject(t)}),s.promise()}function r(e){var t=a.clone(e);return this.options=a.defaults(t||{},this.options||{}),this._ref=t._ref,this.$el=u.dom.find(t.el),this.invokeWithCallbacks("initialize",this.options),this}function i(e,t,n){var r=a.clone(n||{});r.el=e,r.require={};var i,o=u.dom.data(e);return u.util.each(o,function(e,n){e=e.replace(new RegExp("^"+t),""),e=e.charAt(0).toLowerCase()+e.slice(1),e!=="component"&&e!=="widget"?r[e]=n:i=n}),s(i,r)}function s(t,n){var r=t.split("@"),i=u.util.decamelize(r[0]),s=r[1]||"default",o=require.s.contexts._,a=e.config.sources[s]||"./aura_components";return n.name=i,n.ref="./__component__$"+i+"@"+s,n.baseUrl=a+"/"+i,n.require=n.require||{},n.require.packages=n.require.packages||[],n.require.packages.push({name:n.ref,location:a+"/"+i}),n}var o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u=e.core,a=e.core.util._;u.Components=u.Components||{};var f={},l={};r.prototype.initialize=function(){},r.prototype.html=function(e){var t=this.$el;t.html(e);var n=this;return a.defer(function(){n.sandbox.start(t,{reset:!0})}),this},r.prototype.$find=function(e){return this.$el.find(e)},r.prototype.invokeWithCallbacks=function(e){return n.apply(undefined,[e,this].concat([].slice.call(arguments,1)))};var c=function(e,t){var n=this,r;e&&o(e,"constructor")?r=e.constructor:r=function(){n.apply(this,arguments)},u.util.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.util.extend(r.prototype,e),r.__super__=n.prototype,r};return r.extend=c,r.load=function(t,n){var i=u.data.deferred(),s=n.ref,o,l,c=n.el;n._ref=u.util._.uniqueId(s+"+");var h=a.clone(n);return e.logger.log("Start loading component:",t),i.fail(function(n){e.logger.error("Error loading component:",t,n)}),require.config(h.require),require([s],function(o){if(!o)return i.reject("component "+s+" Definition is empty !");try{if(f[s])l=f[s];else{o.type?l=u.Components[o.type]:l=r;if(!l)throw new Error("Can't find component of type '"+o.type+"', did you forget to include the extension that provides it ?");u.util._.isObject(o)&&(l=f[s]=l.extend(o))}var a=e.sandboxes.create(n._ref,{el:c});a.logger.setName("Component '"+t+"'("+a.logger.name+")");var p={sandbox:a};typeof o=="function"&&(p.initialize=o),l=l.extend(p);var d=new l(h);d.$el.data("__sandbox_ref__",a.ref);var v=u.data.when(d);return v.then(function(e){i.resolve(e)}),v.fail(function(e){i.reject(e)}),v}catch(m){e.logger.error(m.message),i.reject(m)}},function(e){i.reject(e)}),i.promise()},r.parseList=function(t){var n=[];if(Array.isArray(t))a.map(t,function(e){var t=s(e.name,e.options);n.push({name:e.name,options:t})});else if(t&&u.dom.find(t)){var r=e.config.namespace,o=["[data-aura-component]","[data-aura-widget]"];r&&(o.push("[data-"+r+"-component]"),o.push("[data-"+r+"-widget]")),o=o.join(","),u.dom.find(o,t||"body").each(function(){var e="aura";r&&(this.getAttribute("data-"+r+"-component")||this.getAttribute("data-"+r+"-widget"))&&(e=r);var t=i(this,e);n.push({name:t.name,options:t})})}return n},r.startAll=function(e){var t=r.parseList(e),n=[];u.util.each(t,function(e,t){var i=r.load(t.name,t.options);n.push(i)});var i=u.data.when.apply(undefined,n);return i.promise()},{name:"components",require:{paths:{text:"bower_components/requirejs-text/text"}},initialize:function(e){function t(e,t){l[e]=l[e]||[],l[e].push(t)}e.core.Components.Base=r,e.components.before=function(e,n){var r="before:"+e;t(r,n)},e.components.after=function(e,n){var r="after:"+e;t(r,n)},e.components.addType=function(t,n){if(e.core.Components[t])throw new Error("Component type "+t+" already defined");e.core.Components[t]=r.extend(n)},e.sandbox.start=function(t,n){var i=["aura","sandbox","start"].join(e.config.mediator.delimiter);e.core.mediator.emit(i,this);var s=this._children||[];n&&n.reset&&(a.invoke(this._children||[],"stop"),s=[]);var o=this;return r.startAll(t).done(function(){var e=Array.prototype.slice.call(arguments);a.each(e,function(e){e.sandbox._component=e,e.sandbox._parent=o,s.push(e.sandbox)}),o._children=s}),this}},afterAppStart:function(e){if(e.config.components!==!1&&e.startOptions.components!==!1){var t;Array.isArray(e.startOptions.components)?t=u.dom.find("body"):t=u.dom.find(e.startOptions.components),e.core.appSandbox=e.sandboxes.create(e.ref,{el:t}),e.core.appSandbox.start(e.startOptions.components)}}}}}),define("aura/ext/debug",[],function(){return{name:"debug",initialize:function(e){typeof window.attachDebugger=="function"&&(e.logger.log("Attaching debugger ..."),window.attachDebugger(e))}}}),define("bower_components/aura/lib/platform",[],function(){typeof Function.prototype.bind!="function"&&(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,Array.prototype.concat.apply(n,arguments))}}),typeof Array.isArray!="function"&&(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}),Object.create||(Object.create=function(e){function t(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return t.prototype=e,new t}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if(typeof i!="object"&&typeof i!="function"||i===null)throw new TypeError("Object.keys called on non-object");var s=[];for(var o in i)e.call(i,o)&&s.push(o);if(t)for(var u=0;u<r;u++)e.call(i,n[u])&&s.push(n[u]);return s}}())}),function(){window.jQuery?define("jquery",[],function(){return window.jQuery}):require.config({paths:{jquery:"bower_components/jquery/jquery"},shim:{jquery:{exports:"$"}}}),window._?define("underscore",[],function(){return window._}):require.config({paths:{underscore:"bower_components/underscore/underscore"},shim:{underscore:{exports:"_"}}}),define("bower_components/aura/lib/base",["module","underscore","jquery","./platform"],function(e,t,n,r){require.s.contexts._.config.paths.aura||require.config({paths:{aura:e.id.replace(/base$/,"")}});var i={};return i.dom={find:function(e,t){return t=t||document,n(t).find(e)},data:function(e,t){return n(e).data(t)}},i.data={deferred:n.Deferred,when:n.when},i.util={each:n.each,extend:n.extend,uniq:t.uniq,_:t,decamelize:function(e,t){return t=t===undefined?"_":t,e.replace(/([A-Z])/g,t+"$1").toLowerCase()}},i.events={listen:function(e,t,r,i){return n(e).on(t,r,i)},bindAll:function(){return t.bindAll.apply(this,arguments)}},i.template={parse:t.template},i})}(),define("bower_components/aura/lib/logger",[],function(){function e(e){return this.name=e,this._log=t,this._warn=t,this._error=t,this._enabled=!1,this}var t=function(){},n=window.console||{};return e.prototype.isEnabled=function(){return this._enabled},e.prototype.setName=function(e){this.name=e},e.prototype.enable=function(){this._log=n.log||t,this._warn=n.warn||this._log,this._error=n.error||this._log,this._enabled=!0;if(Function.prototype.bind&&typeof n=="object"){var e=["log","warn","error"];for(var r=0;r<e.length;r++)n[e[r]]=Function.prototype.call.bind(n[e[r]],n)}return this},e.prototype.write=function(e,t){var r=Array.prototype.slice.call(t);r.unshift(this.name+":"),e.apply(n,r)},e.prototype.log=function(){this.write(this._log,arguments)},e.prototype.warn=function(){this.write(this._warn,arguments)},e.prototype.error=function(){this.write(this._error,arguments)},e}),define("bower_components/aura/lib/aura.extensions",["./base","./logger"],function(e,t){function n(){return this._extensions=[],this.initStatus=f(),this}function r(){var e=a.call(arguments),t;for(var n=0,r=e.length;n<r;n++){t=e[n];if(typeof t=="function")return t}return function(){}}function i(e){return typeof e=="function"?e.apply(undefined,a.call(arguments,1)):e}function s(e){var t=f(),n=e.ref,i=e.context,s=o(n,i);return s.fail(t.reject),s.done(function(e){if(!e)return t.resolve();var n=l(r(e,e.initialize)(i));n.done(function(){t.resolve(e)}),n.fail(t.reject)}),t.promise()}function o(e,t){var n=f(),r=function(e){e=i(e,t);if(e&&e.require&&e.require.paths){var r=Object.keys(e.require.paths)||[];require.config(e.require),require(r,function(){n.resolve(e)},s)}else n.resolve(e)},s=function(t){c.error("Error loading ext:",e,t),n.reject(t)};return typeof e=="string"?require([e],r,s):r(e),n}var u=e.util._,a=Array.prototype.slice,f=e.data.deferred,l=e.data.when,c=(new t("Extensions")).enable();return n.prototype.add=function(e){if(u.include(this._extensions,e)){var t=e.ref.toString()+" is already registered.";throw t+="Extensions can only be added once.",new Error(t)}if(this.initStarted)throw new Error("Init extensions already called");return this._extensions.push(e),this},n.prototype.onReady=function(e){return this.initStatus.then(e),this},n.prototype.onFailure=function(e){return this.initStatus.fail(e),this},n.prototype.init=function(){if(this.initStarted)throw new Error("Init extensions already called");this.initStarted=!0;var e=u.compact(this._extensions.slice(0)),t=[],n=this.initStatus;return function r(i){if(i){var o=s(i);t.push(o),o.done(function(){r(e.shift())}),o.fail(function(e){e||(e="Unknown error while loading an extension"),e instanceof Error||(e=new Error(e)),n.reject(e)})}else e.length===0&&l.apply(undefined,t).done(function(){n.resolve(Array.prototype.slice.call(arguments))})}(e.shift()),n.promise()},n}),define("bower_components/aura/lib/aura",["./base","./aura.extensions","./logger"],function(e,t,n){function r(s){function o(e){typeof e=="string"&&(e=a.sandboxes.get(e));if(e){var t=["aura","sandbox","stop"].join(a.config.mediator.delimiter);return i.invoke(e._children,"stop"),a.core.mediator.emit(t,e),e._component&&e._component.invokeWithCallbacks("remove"),e.stopped=!0,e.el&&a.core.dom.find(e.el).remove(),f[e.ref]=null,delete f[e.ref],e}}if(this instanceof r){var u=new t,a=this;a.ref=i.uniqueId("aura_"),a.config=s=s||{},a.config.sources=a.config.sources||{"default":"./aura_components"};var f={},l=Object.create(e);a.sandboxes={},a.sandboxes.create=function(e,t){e=e||i.uniqueId("sandbox-");if(f[e])throw new Error("Sandbox with ref "+e+" already exists.");var r=Object.create(l);r.ref=e||i.uniqueId("sandbox-"),r.logger=new n(r.ref),f[r.ref]=r;var o=s.debug;return(o===!0||o.enable&&(o.components.length===0||o.components.indexOf(e)!==-1))&&r.logger.enable(),i.extend(r,t||{}),r},a.sandboxes.get=function(e){return f[e]},a.use=function(e){return u.add({ref:e,context:a}),a},a.components={},a.components.addSource=function(e,t){if(s.sources[e])throw new Error("Components source '"+e+"' is already registered");return s.sources[e]=t,a},a.core=Object.create(e),a.start=function(t){if(a.started)return a.logger.error("Aura already started!"),u.initStatus;a.logger.log("Starting Aura");var n=t||{};return typeof t=="string"?n={components:a.core.dom.find(t)}:Array.isArray(t)?n={components:t}:t&&t.widgets&&!t.components?n.components=t.widgets:n.components===undefined&&(n.components=a.core.dom.find(a.config.components||"body")),u.onReady(function(t){e.util.each(t,function(e,t){t&&typeof t.afterAppStart=="function"&&t.afterAppStart(a)})}),u.onFailure(function(){a.logger.error("Error initializing app:",a.config.name,arguments),a.stop()}),a.startOptions=n,a.started=!0,u.init()},a.stop=function(){a.started=!1},a.sandbox=l,a.logger=new n(a.ref),a.sandbox.stop=function(e){e?a.core.dom.find(e,this.el).each(function(e,t){var n=a.core.dom.find(t).data("__sandbox_ref__");o(n)}):o(this)},s.debug=s.debug||{};var c=s.debug;return c===!0&&(s.debug=c={enable:!0}),c.enable&&(c.components?c.components=c.components.split(" "):c.components=[],a.logger.enable(),a.use("aura/ext/debug")),a.use("aura/ext/mediator"),a.use("aura/ext/components"),a}return new r(s)}var i=e.util._,s=function(){},o=Object.freeze||s;return r}),define("app",["bower_components/aura/lib/aura"],function(e){window.config.debug={},(new e(window.config)).use("extensions/lib/aura-handlebars").use("extensions/lib/aura-backbone").use("extensions/lib/aura-turn").use("extensions/lib/aura-hammer").use("extensions/lib/aura-swfobject").use("extensions/lib/jquery-plugins").use("extensions/utils").use("extensions/gesture").use("extensions/toolbar").use("extensions/loop").use("extensions/binders").use("extensions/reader").use("extensions/search").use("extensions/keys").use("extensions/zoom").use("extensions/fullscreen").use("extensions/lead-sharing").use("extensions/viewport").use("extensions/viewport-scroll").use("extensions/viewport-slideshow").use("extensions/viewport-double").use("extensions/pages").use("extensions/interpages").use("extensions/extract").use("extensions/content").use("extensions/popin").use("extensions/embed").use("extensions/mouse").use("extensions/watcher").use(function(e){window.sandbox=e.sandboxes.create(),window.core=e.core,window.core.mediator.setMaxListeners(1e3)}).start({widgets:"body"}).then(function(){var e=null;try{e=new Event("reader.sandbox.created")}catch(t){try{e=document.createEvent("Event"),e.initEvent("reader.sandbox.created",!0,!0)}catch(n){}}e&&document.dispatchEvent(e)})}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),function(){function e(e,t,n,r,i,s){t[e]&&(n.push(e),(t[e]===!0||t[e]===1)&&r.push(i+e+"/"+s))}function t(e,t,n,r,i){var s=r+t+"/"+i;require._fileExists(e.toUrl(s+".js"))&&n.push(s)}function n(e,t,r){var i;for(i in t)t.hasOwnProperty(i)&&(!e.hasOwnProperty(i)||r)?e[i]=t[i]:typeof t[i]=="object"&&(e[i]||(e[i]={}),n(e[i],t[i],r))}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(i){var s=i.config?i.config():{};return{version:"2.0.3",load:function(i,o,u,a){a=a||{},a.locale&&(s.locale=a.locale);var f,l=r.exec(i),c=l[1],h=l[4],p=l[5],d=h.split("-"),v=[],m={},g,y,b="";l[5]?(c=l[1],f=c+p):(f=i,p=l[4],h=s.locale,h||(h=s.locale=typeof navigator=="undefined"?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),d=h.split("-"));if(a.isBuild){v.push(f),t(o,"root",v,c,p);for(g=0;g<d.length;g++)y=d[g],b+=(b?"-":"")+y,t(o,b,v,c,p);o(v,function(){u()})}else o([f],function(t){var r=[],i;e("root",t,r,v,c,p);for(g=0;g<d.length;g++)i=d[g],b+=(b?"-":"")+i,e(b,t,r,v,c,p);o(v,function(){var e,i,s;for(e=r.length-1;e>-1&&r[e];e--){s=r[e],i=t[s];if(i===!0||i===1)i=o(c+s+"/"+p);n(m,i)}u(m)})})}}})}(),define("nls/fr/text",{na:"NC",download:"Télécharger",buy:"Acheter pour",addToCartUrl:"Ajouter au panier","double":"Double",displayDouble:"Afficher en double page",scroll:"Défilement vertical",displayScroll:"Afficher en ligne",displaySlide:"Afficher en diaporama",integrate:"Intégrer",fullscreen:"Plein Écran",previousPage:"Page précédente",afterPage:"Page suivante",share:"Partager",zoomMore:"Zoom +",zoomLess:"Zoom -",pages:"pages",close:"Fermer",searchIntoTheDocument:"Recherche dans le document",fullscreenMode:"Mode plein écran",addToMyLibrary:"Ajouter à ma bibliothèque",goToYouscribe:"Lire sur YouScribe",toAccessNeedMoreInformation:"Remplissez ce formulaire et ",toAccessNeedMoreInformation2:"accédez au document dans son intégralité",description:"Description",checkEmailBeforeAccessDocument:"La validité de votre adresse email sera vérifiée avant de vous envoyer l'accès au document",validateAndShowDocument:"Accéder au document",waitForValidation:"E-mail d'accès au document envoyé",waitValidationMessage:"Afin d'accéder au document vous devez valider votre adresse e-mail en cliquant sur le lien fourni dans le courrier electronique qui vous a été envoyé",acceptCondition:"En acc&eacute;dant &agrave; ce document, j’accepte les <a href='http://www.youscribe.com/Static?name=cgu' style='text-decoration:underline' target='_blank'>Conditions G&eacute;n&eacute;rales d’Utilisation</a> de YouScribe",loadingSearch:"Chargement des résultats",previous:"Précédent",next:"Suivant",results:"résultat(s)",resultOf:"résultat de",historic:"Historique",twitter:"Tweeter",shareOnFacebook:"Partager sur Facebook","googleLike+":"+1 Google+",sendByEmail:"Envoyer par email",integrateDocumentToWebsite:"Intégrez ce document à votre site",displayMode:"Mode d'affichage",flexWidthAndHeight:"Largeur et hauteur flexibles",width:"Largeur",and:"et",height:"hauteur",startPage:"Débuter la lecture à la page",copyAndPaste:"Copiez puis collez ce code sur votre site",preview:"prévisualiser",errorLogin:"Erreur d'authentification",errorCapacities:"Le document est en cours de traitement",extractQuestion:"Cet extrait vous a plu ?",extractMessage:" Accédez à l'intégralité de ce livre et à des milliers d'autres ouvrages en vous abonnant à YouScribe !",moreInfo:"Plus d'infos",startTry:"Démarrez votre essai gratuit"}),define("nls/en/text",{na:"NA",buy:"Buy for",download:"Download",addToCartUrl:"Add to cart","double":"Double",displayDouble:"Double display",scroll:"Scroll",displayScroll:"Scroll display",displaySlide:"Slide display",integrate:"Embed",fullscreen:"Full Screen",previousPage:"previous page",afterPage:"next page",share:"Share",pages:"pages",zoomMore:"Zoom +",zoomLess:"Zoom -",close:"Close",searchIntoTheDocument:"Search into the document",fullscreenMode:"Full Screen Mode",addToMyLibrary:"Add to my library",goToYouscribe:"Read it on YouScribe",toAccessNeedMoreInformation:"You need to fill some information below ",toAccessNeedMoreInformation2:"to fully access this document.",description:"Description",checkEmailBeforeAccessDocument:"Your email address will be checked before we send you the document access",validateAndShowDocument:"Access the document",waitForValidation:"Email validation in progress",waitValidationMessage:"To access the document you need to validate your e-mail adress by clicking on the link available in the e-mail that we sent",acceptCondition:"When accessing this document, I accept YouScribe's <a href='http://en.youscribe.com/Static?name=cgu' style='text-decoration:underline' target='_blank'>Terms of Service</a>",loadingSearch:"Loading results",previous:"Previous",next:"Next",results:"result(s)",resultOf:"result of",historic:"Historic",twitter:"Tweeter",shareOnFacebook:"Share on Facebook","googleLike+":"+1 Google+",sendByEmail:"Send by email",integrateDocumentToWebsite:"Embed this document to your site",displayMode:"Display mode",flexWidthAndHeight:"Flexible width and height",width:"Width",and:"and",height:"height",startPage:"Start reading at page",copyAndPaste:"Copy and paste this code on your site",preview:"preview",errorLogin:"Authentication error",errorCapacities:"The document is being processed",extractQuestion:"Do you enjoyed this extract ?",extractMessage:"Access all of this book and thousands of other works by subscribing to YouScribe !",moreInfo:"More information",startTry:"Start your free trial"}),define("nls/es/text",{na:"NA",buy:"Buy for",download:"Download",addToCartUrl:"Add to cart","double":"Double",displayDouble:"Double display",scroll:"Scroll",displayScroll:"Scroll display",displaySlide:"Slide display",integrate:"Embed",fullscreen:"Full Screen",previousPage:"previous page",afterPage:"next page",share:"Share",pages:"pages",zoomMore:"Zoom +",zoomLess:"Zoom -",close:"Close",searchIntoTheDocument:"Search into the document",fullscreenMode:"Full Screen Mode",addToMyLibrary:"Add to my library",goToYouscribe:"Read it on YouScribe",toAccessNeedMoreInformation:"You need to fill some information below ",toAccessNeedMoreInformation2:"to fully access this document.",description:"Description",checkEmailBeforeAccessDocument:"Your email address will be checked before we send you the document access",validateAndShowDocument:"Access the document",waitForValidation:"Email validation in progress",waitValidationMessage:"To access the document you need to validate your e-mail adress by clicking on the link available in the e-mail that we sent",acceptCondition:"When accessing this document, I accept YouScribe's <a href='http://en.youscribe.com/Static?name=cgu' style='text-decoration:underline' target='_blank'>Terms of Service</a>",loadingSearch:"Loading results",previous:"Previous",next:"Next",results:"result(s)",resultOf:"result of",historic:"Historic",twitter:"Tweeter",shareOnFacebook:"Share on Facebook","googleLike+":"+1 Google+",sendByEmail:"Send by email",integrateDocumentToWebsite:"Embed this document to your site",displayMode:"Display mode",flexWidthAndHeight:"Flexible width and height",width:"Width",and:"and",height:"height",startPage:"Start reading at page",copyAndPaste:"Copy and paste this code on your site",preview:"preview",errorLogin:"Authentication error",errorCapacities:"The document is being processed",extractQuestion:"Do you enjoyed this extract ?",extractMessage:"Access all of this book and thousands of other works by subscribing to YouScribe !",moreInfo:"More information",startTry:"Start your free trial"}),define("extensions/lib/aura-handlebars",{require:{paths:{hbs:"bower_components/require-handlebars-plugin/hbs"},hbs:{disableI18n:!0,disableHelpers:!0,templateExtension:"hbs"}},initialize:function(e){e.core.template.hbs=require("hbs")}}),function(e,t){if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!c(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,f,l,h;if(!this._events||!c(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++){e=u[a];if(o=this._events[e]){this._events[e]=i=[];if(t||r)for(l=0,h=o.length;l<h;l++)s=o[l],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){f[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),f.bind=f.on,f.unbind=f.off,n.extend(t,f);var d=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;h<p;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},I(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},I(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];n.each(v,function(e){d.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};n.extend(m.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;i<s;i++){u=e[i]=this.get(e[i]);if(!u)continue;delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,h=this.model,p=this.comparator&&c==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!p&&w&&S?[]:!1;for(i=0,s=e.length;i<s;i++){a=e[i]||{},a instanceof d?o=u=a:o=a[h.prototype.idAttribute||"id"];if(f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),p&&!l&&f.hasChanged(v)&&(l=!0)),e[i]=f;else if(w){u=e[i]=this._prepareModel(a,t);if(!u)continue;m.push(u),this._addReference(u,t)}u=f||u,x&&(u.isNew()||!b[u.id])&&x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;i<s;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(m.length||x&&x.length){p&&(l=!0),this.length+=m.length;if(c!=null)for(i=0,s=m.length;i<s;i++)this.models.splice(c+i,0,m[i]);else{x&&(this.models.length=0);var T=x||m;for(i=0,s=T.length;i<s;i++)this.models.push(T[i])}}l&&this.sort({silent:!0});if(!t.silent){for(i=0,s=m.length;i<s;i++)(u=m[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return u.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(b,function(e){m.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){m.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var E=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(S),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,o===""?this.$el.on(s,r):this.$el.on(s,o,r)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}else this.setElement(n.result(this,"el"),!1)}}),t.sync=function(e,r,i){var s=N[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||F()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var T=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,f,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/,B=/#.*$/;M.started=!1,n.extend(M.prototype,f,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(H,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(D,"/");if(s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(B,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M;var j=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=m.extend=C.extend=E.extend=M.extend=j;var F=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),define("extensions/lib/aura-backbone",{require:{paths:{backbone:"bower_components/backbone/backbone",underscore:"bower_components/underscore/underscore"},shim:{backbone:{exports:"Backbone",deps:["underscore","jquery"]}}},initialize:function(e){var t=require("backbone");e.core.mvc=t;var n={};typeof Object.getPrototypeOf!="function"&&(typeof "test".__proto__=="object"?Object.getPrototypeOf=function(e){return e.__proto__}:Object.getPrototypeOf=function(e){return e.constructor.prototype});var r={setAttribute:function(e,n,r){return r&&r.force?(r.silent=!0,t.Model.prototype.set.apply(this,arguments),this.trigger("change:"+e,this,this.get(e))):t.Model.prototype.set.apply(this,arguments),this},set:function(e,t,n){var r=this;if(typeof e=="object")n=t,_.each(e,function(e,t){r.setAttribute.call(r,t,e,n)});else{var i=e;r.setAttribute.call(r,i,t,n)}},get:function(e){var n=null;return arguments.length===0?n=this.toJSON():arguments.length===1?n=t.Model.prototype.get.call(this,arguments[0]):n=_.pick(this.toJSON(),_.toArray(arguments)),n}};t.Model.prototype.initialize=function(){this._setOriginalAttributes();var e={},t=_.keys(Object.getPrototypeOf(this));return t.set||(e.set=r.set),t.get||(e.get=r.get),_.extend(this,e),this},t.Model.prototype._setOriginalAttributes=function(){return this._originalAttributes=$.extend(!0,{},this.attributes),this},t.Model.prototype.reset=function(){return this.set(this._originalAttributes),this},t.Model.prototype.setAttribute=r.setAttribute,e.components.before("initialize",function(e){var r=n[e.ref];r||(n[e.ref]=r=t.View.extend(this.View)),this.view=new r({el:this.$el}),this.view.sandbox=this.sandbox,this.view.component=this}),e.components.before("remove",function(){this.view&&this.view.stopListening()})}}),function(e){function t(e,t,n){if(!n[0]||typeof n[0]=="object")return t.init.apply(e,n);if(t[n[0]])return t[n[0]].apply(e,Array.prototype.slice.call(n,1));throw v(n[0]+" is not a method or property")}function n(e,t,n,r){return{css:{position:"absolute",top:e,left:t,overflow:r||"hidden",zIndex:n||"auto"}}}function r(e,t,n,r,i){var s=1-i,u=s*s*s,a=i*i*i;return o(Math.round(u*e.x+3*i*s*s*t.x+3*i*i*s*n.x+a*r.x),Math.round(u*e.y+3*i*s*s*t.y+3*i*i*s*n.y+a*r.y))}function i(e){return e/180*S}function s(e){return e/S*180}function o(e,t){return{x:e,y:t}}function u(){var e;if(e=/AppleWebkit\/([0-9\.]+)/i.exec(navigator.userAgent)){var t=parseFloat(e[1]);return t>534.3}return!0}function a(e,t,n){return y&&n?" translate3d("+e+"px,"+t+"px, 0px) ":" translate("+e+"px, "+t+"px) "}function f(e){return" rotate("+e+"deg) "}function l(e,t){return Object.prototype.hasOwnProperty.call(t,e)}function c(){var e=["Moz","Webkit","Khtml","O","ms"],t=e.length,n="";while(t--)e[t]+"Transform"in document.body.style&&(n="-"+e[t].toLowerCase()+"-");return n}function h(){var e,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MSTransition:"transitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(t.style[e]!==undefined)return n[e]}function p(e,t,n,r,i){var s,u=[];if(w=="-webkit-"){for(s=0;s<i;s++)u.push("color-stop("+r[s][0]+", "+r[s][1]+")");e.css({"background-image":"-webkit-gradient(linear, "+t.x+"% "+t.y+"%,"+n.x+"% "+n.y+"%, "+u.join(",")+" )"})}else{t={x:t.x/100*e.width(),y:t.y/100*e.height()},n={x:n.x/100*e.width(),y:n.y/100*e.height()};var a=n.x-t.x,f=n.y-t.y,l=Math.atan2(f,a),c=l-Math.PI/2,h=Math.abs(e.width()*Math.sin(c))+Math.abs(e.height()*Math.cos(c)),p=Math.sqrt(f*f+a*a),d=o(n.x<t.x?e.width():0,n.y<t.y?e.height():0),v=Math.tan(l),m=-1/v,g=(m*d.x-d.y-v*t.x+t.y)/(m-v),y={x:g,y:m*g-m*d.x+d.y},b=Math.sqrt(Math.pow(y.x-t.x,2)+Math.pow(y.y-t.y,2));for(s=0;s<i;s++)u.push(" "+r[s][1]+" "+(b+p*r[s][0])*100/h+"%");e.css({"background-image":w+"linear-gradient("+ -l+"rad,"+u.join(",")+")"})}}function d(t,n,r){var i=e.Event(t);return n.trigger(i,r),i.isDefaultPrevented()?"prevented":i.isPropagationStopped()?"stopped":""}function v(e){function t(e){this.name="TurnJsError",this.message=e}return t.prototype=new Error,t.prototype.constructor=t,new t(e)}function m(e){var t={top:0,left:0};do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent);return t}function g(){return navigator.userAgent.indexOf("MSIE 9.0")==-1}var y,b,w="",E="4.1.0",S=Math.PI,x=S/2,T="ontouchstart"in window,N=T?{down:"touchstart",move:"touchmove",up:"touchend",over:"touchstart",out:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},C={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br","l","r"]},k=["single","double"],L=["ltr","rtl"],A={acceleration:!0,display:"double",duration:600,page:1,gradients:!0,turnCorners:"bl,br",when:null},O={cornerSize:100},M=6,_={init:function(t){y="WebKitCSSMatrix"in window||"MozPerspective"in document.body.style,b=u(),w=c();var n,r=this,i=0,s=this.data(),o=this.children();t=e.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},A,t),s.opts=t,s.pageObjs={},s.pages={},s.pageWrap={},s.pageZoom={},s.pagePlace={},s.pageMv=[],s.zoom=1,s.totalPages=t.pages||0,s.eventHandlers={touchStart:e.proxy(_._touchStart,this),touchMove:e.proxy(_._touchMove,this),touchEnd:e.proxy(_._touchEnd,this),start:e.proxy(_._eventStart,this)};if(t.when)for(n in t.when)l(n,t.when)&&this.bind(n,t.when[n]);this.css({position:"relative",width:t.width,height:t.height}),this.turn("display",t.display),t.direction!==""&&this.turn("direction",t.direction),y&&!T&&t.acceleration&&this.transform(a(0,0,!0));for(n=0;n<o.length;n++)e(o[n]).attr("ignore")!="1"&&this.turn("addPage",o[n],++i);return e(this).bind(N.down,s.eventHandlers.touchStart).bind("end",_._eventEnd).bind("pressed",_._eventPressed).bind("released",_._eventReleased).bind("flip",_._flip),e(this).parent().bind("start",s.eventHandlers.start),e(document).bind(N.move,s.eventHandlers.touchMove).bind(N.up,s.eventHandlers.touchEnd),this.turn("page",t.page),s.done=!0,this},addPage:function(t,n){var r,i,s=!1,o=this.data(),u=o.totalPages+1;if(o.destroying)return!1;if(r=/\bp([0-9]+)\b/.exec(e(t).attr("class")))n=parseInt(r[1],10);if(n){if(n==u)s=!0;else if(n>u)throw v('Page "'+n+'" cannot be inserted')}else n=u,s=!0;return n>=1&&n<=u&&(o.display=="double"?i=n%2?" odd":" even":i="",o.done&&this.turn("stop"),n in o.pageObjs&&_._movePages.call(this,n,1),s&&(o.totalPages=u),o.pageObjs[n]=e(t).css({"float":"left"}).addClass("page p"+n+i),!g()&&o.pageObjs[n].hasClass("hard")&&o.pageObjs[n].removeClass("hard"),_._addPage.call(this,n),_._removeFromDOM.call(this)),this},_addPage:function(t){var n=this.data(),r=n.pageObjs[t];if(r)if(_._necessPage.call(this,t)){if(!n.pageWrap[t]){n.pageWrap[t]=e("<div/>",{"class":"page-wrapper",page:t,css:{position:"absolute",overflow:"hidden"}}),this.append(n.pageWrap[t]),n.pagePlace[t]||(n.pagePlace[t]=t,n.pageObjs[t].appendTo(n.pageWrap[t]));var i=_._pageSize.call(this,t,!0);r.css({width:i.width,height:i.height}),n.pageWrap[t].css(i)}n.pagePlace[t]==t&&_._makeFlip.call(this,t)}else n.pagePlace[t]=0,n.pageObjs[t]&&n.pageObjs[t].remove()},hasPage:function(e){return l(e,this.data().pageObjs)},center:function(t){var n=this.data(),r=e(this).turn("size"),i=0;if(!n.noCenter){if(n.display=="double"){var s=this.turn("view",t||n.tpage||n.page);n.direction=="ltr"?s[0]?s[1]||(i+=r.width/4):i-=r.width/4:s[0]?s[1]||(i-=r.width/4):i+=r.width/4}e(this).css({marginLeft:i})}return this},destroy:function(){var t,n=this,r=this.data(),i=["end","first","flip","last","pressed","released","start","turning","turned","zooming","missing"];if(d("destroying",this)=="prevented")return;r.destroying=!0,e.each(i,function(e,t){n.unbind(t)}),this.parent().unbind("start",r.eventHandlers.start),e(document).unbind(N.move,r.eventHandlers.touchMove).unbind(N.up,r.eventHandlers.touchEnd);while(r.totalPages!==0)this.turn("removePage",r.totalPages);return r.fparent&&r.fparent.remove(),r.shadow&&r.shadow.remove(),this.removeData(),r=null,this},is:function(){return typeof this.data().pages=="object"},zoom:function(t){var n=this.data();if(typeof t=="number"){if(t<.001||t>100)throw v(t+" is not a value for zoom");if(d("zooming",this,[t,n.zoom])=="prevented")return this;var r=this.turn("size"),i=this.turn("view"),s=1/n.zoom,o=Math.round(r.width*s*t),u=Math.round(r.height*s*t);n.zoom=t,e(this).turn("stop").turn("size",o,u),n.opts.autoCenter&&this.turn("center"),_._updateShadow.call(this);for(var a=0;a<i.length;a++)i[a]&&n.pageZoom[i[a]]!=n.zoom&&(this.trigger("zoomed",[i[a],i,n.pageZoom[i[a]],n.zoom]),n.pageZoom[i[a]]=n.zoom);return this}return n.zoom},_pageSize:function(e,t){var n=this.data(),r={};if(n.display=="single")r.width=this.width(),r.height=this.height(),t&&(r.top=0,r.left=0,r.right="auto");else{var i=this.width()/2,s=this.height();n.pageObjs[e].hasClass("own-size")?(r.width=n.pageObjs[e].width(),r.height=n.pageObjs[e].height()):(r.width=i,r.height=s);if(t){var o=e%2;r.top=(s-r.height)/2,n.direction=="ltr"?(r[o?"right":"left"]=i-r.width,r[o?"left":"right"]="auto"):(r[o?"left":"right"]=i-r.width,r[o?"right":"left"]="auto")}}return r},_makeFlip:function(e){var t=this.data();if(!t.pages[e]&&t.pagePlace[e]==e){var n=t.display=="single",r=e%2;t.pages[e]=t.pageObjs[e].css(_._pageSize.call(this,e)).flip({page:e,next:r||n?e+1:e-1,turn:this}).flip("disable",t.disabled),_._setPageLoc.call(this,e),t.pageZoom[e]=t.zoom}return t.pages[e]},_makeRange:function(){var e,t,n=this.data();if(n.totalPages<1)return;t=this.turn("range");for(e=t[0];e<=t[1];e++)_._addPage.call(this,e)},range:function(e){var t,n,r,i,s=this.data();e=e||s.tpage||s.page||1,i=_._view.call(this,e);if(e<1||e>s.totalPages)throw v('"'+e+'" is not a valid page');return i[1]=i[1]||i[0],i[0]>=1&&i[1]<=s.totalPages?(t=Math.floor((M-2)/2),s.totalPages-i[1]>i[0]?(n=Math.min(i[0]-1,t),r=2*t-n):(r=Math.min(s.totalPages-i[1],t),n=2*t-r)):(n=M-1,r=M-1),[Math.max(1,i[0]-n),Math.min(s.totalPages,i[1]+r)]},_necessPage:function(e){if(e===0)return!0;var t=this.turn("range");return this.data().pageObjs[e].hasClass("fixed")||e>=t[0]&&e<=t[1]},_removeFromDOM:function(){var e,t=this.data();for(e in t.pageWrap)l(e,t.pageWrap)&&!_._necessPage.call(this,e)&&_._removePageFromDOM.call(this,e)},_removePageFromDOM:function(e){var t=this.data();if(t.pages[e]){var n=t.pages[e].data();D._moveFoldingPage.call(t.pages[e],!1),n.f&&n.f.fwrapper&&n.f.fwrapper.remove(),t.pages[e].removeData(),t.pages[e].remove(),delete t.pages[e]}t.pageObjs[e]&&t.pageObjs[e].remove(),t.pageWrap[e]&&(t.pageWrap[e].remove(),delete t.pageWrap[e]),_._removeMv.call(this,e),delete t.pagePlace[e],delete t.pageZoom[e]},removePage:function(e){var t=this.data();if(e=="*")while(t.totalPages!==0)this.turn("removePage",t.totalPages);else{if(e<1||e>t.totalPages)throw v("The page "+e+" doesn't exist");t.pageObjs[e]&&(this.turn("stop"),_._removePageFromDOM.call(this,e),delete t.pageObjs[e]),_._movePages.call(this,e,-1),t.totalPages=t.totalPages-1,t.page>t.totalPages?(t.page=null,_._fitPage.call(this,t.totalPages)):(_._makeRange.call(this),this.turn("update"))}return this},_movePages:function(e,t){var n,r=this,i=this.data(),s=i.display=="single",o=function(e){var n=e+t,o=n%2,u=o?" odd ":" even ";i.pageObjs[e]&&(i.pageObjs[n]=i.pageObjs[e].removeClass("p"+e+" odd even").addClass("p"+n+u)),i.pagePlace[e]&&i.pageWrap[e]&&(i.pagePlace[n]=n,i.pageObjs[n].hasClass("fixed")?i.pageWrap[n]=i.pageWrap[e].attr("page",n):i.pageWrap[n]=i.pageWrap[e].css(_._pageSize.call(r,n,!0)).attr("page",n),i.pages[e]&&(i.pages[n]=i.pages[e].flip("options",{page:n,next:s||o?n+1:n-1})),t&&(delete i.pages[e],delete i.pagePlace[e],delete i.pageZoom[e],delete i.pageObjs[e],delete i.pageWrap[e]))};if(t>0)for(n=i.totalPages;n>=e;n--)o(n);else for(n=e;n<=i.totalPages;n++)o(n)},display:function(t){var n=this.data(),r=n.display;if(t===undefined)return r;if(e.inArray(t,k)==-1)throw v('"'+t+'" is not a value for display');switch(t){case"single":n.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),n.pageObjs[0]=e("<div />",{"class":"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)),this.addClass("shadow");break;case"double":n.pageObjs[0]&&(this.turn("stop").css({overflow:""}),n.pageObjs[0].remove(),delete n.pageObjs[0]),this.removeClass("shadow")}n.display=t;if(r){var i=this.turn("size");_._movePages.call(this,1,0),this.turn("size",i.width,i.height).turn("update")}return this},direction:function(t){var n=this.data();if(t===undefined)return n.direction;t=t.toLowerCase();if(e.inArray(t,L)==-1)throw v('"'+t+'" is not a value for direction');return t=="rtl"&&e(this).attr("dir","ltr").css({direction:"ltr"}),n.direction=t,n.done&&this.turn("size",e(this).width(),e(this).height()),this},animating:function(){return this.data().pageMv.length>0},corner:function(){var e,t,n=this.data();for(t in n.pages)if(l(t,n.pages))if(e=n.pages[t].flip("corner"))return e;return!1},data:function(){return this.data()},disable:function(t){var n,r=this.data(),i=this.turn("view");r.disabled=t===undefined||t===!0;for(n in r.pages)l(n,r.pages)&&r.pages[n].flip("disable",r.disabled?!0:e.inArray(parseInt(n,10),i)==-1);return this},disabled:function(e){return e===undefined?this.data().disabled===!0:this.turn("disable",e)},size:function(e,t){if(e===undefined||t===undefined)return{width:this.width(),height:this.height()};this.turn("stop");var n,r,i=this.data(),s=i.display=="double"?e/2:e;this.css({width:e,height:t}),i.pageObjs[0]&&i.pageObjs[0].css({width:s,height:t});for(n in i.pageWrap){if(!l(n,i.pageWrap))continue;r=_._pageSize.call(this,n,!0),i.pageObjs[n].css({width:r.width,height:r.height}),i.pageWrap[n].css(r),i.pages[n]&&i.pages[n].css({width:r.width,height:r.height})}return this.turn("resize"),this},resize:function(){var e,t=this.data();t.pages[0]&&(t.pageWrap[0].css({left:-this.width()}),t.pages[0].flip("resize",!0));for(e=1;e<=t.totalPages;e++)t.pages[e]&&t.pages[e].flip("resize",!0);_._updateShadow.call(this),t.opts.autoCenter&&this.turn("center")},_removeMv:function(e){var t,n=this.data();for(t=0;t<n.pageMv.length;t++)if(n.pageMv[t]==e)return n.pageMv.splice(t,1),!0;return!1},_addMv:function(e){var t=this.data();_._removeMv.call(this,e),t.pageMv.push(e)},_view:function(e){var t=this.data();return e=e||t.page,t.display=="double"?e%2?[e-1,e]:[e,e+1]:[e]},view:function(e){var t=this.data(),n=_._view.call(this,e);return t.display=="double"?[n[0]>0?n[0]:0,n[1]<=t.totalPages?n[1]:0]:[n[0]>0&&n[0]<=t.totalPages?n[0]:0]},stop:function(e,t){if(this.turn("animating")){var n,r,i,s=this.data();s.tpage&&(s.page=s.tpage,delete s.tpage);for(n=0;n<s.pageMv.length;n++){if(!s.pageMv[n]||s.pageMv[n]===e)continue;i=s.pages[s.pageMv[n]],r=i.data().f.opts,i.flip("hideFoldedPage",t),t||D._moveFoldingPage.call(i,!1),r.force&&(r.next=r.page%2===0?r.page-1:r.page+1,delete r.force)}}return this.turn("update"),this},pages:function(e){var t=this.data();if(e){if(e<t.totalPages)for(var n=t.totalPages;n>e;n--)this.turn("removePage",n);return t.totalPages=e,_._fitPage.call(this,t.page),this}return t.totalPages},_missing:function(e){var t=this.data();if(t.totalPages<1)return;var n,r=this.turn("range",e),i=[];for(n=r[0];n<=r[1];n++)t.pageObjs[n]||i.push(n);i.length>0&&this.trigger("missing",[i])},_fitPage:function(e){var t=this.data(),n=this.turn("view",e);_._missing.call(this,e);if(!t.pageObjs[e])return;t.page=e,this.turn("stop");for(var r=0;r<n.length;r++)n[r]&&t.pageZoom[n[r]]!=t.zoom&&(this.trigger("zoomed",[n[r],n,t.pageZoom[n[r]],t.zoom]),t.pageZoom[n[r]]=t.zoom);_._removeFromDOM.call(this),_._makeRange.call(this),_._updateShadow.call(this),this.trigger("turned",[e,n]),this.turn("update"),t.opts.autoCenter&&this.turn("center")},_turnPage:function(t){var n,r,i=this.data(),s=i.pagePlace[t],o=this.turn("view"),u=this.turn("view",t);if(i.page!=t){var a=i.page;if(d("turning",this,[t,u])=="prevented"){a==i.page&&e.inArray(s,i.pageMv)!=-1&&i.pages[s].flip("hideFoldedPage",!0);return}e.inArray(1,u)!=-1&&this.trigger("first"),e.inArray(i.totalPages,u)!=-1&&this.trigger("last")}i.display=="single"?(n=o[0],r=u[0]):o[1]&&t>o[1]?(n=o[1],r=u[0]):o[0]&&t<o[0]&&(n=o[0],r=u[1]);var f=i.opts.turnCorners.split(","),l=i.pages[n].data().f,c=l.opts,h=l.point;_._missing.call(this,t);if(!i.pageObjs[t])return;this.turn("stop"),i.page=t,_._makeRange.call(this),i.tpage=r,c.next!=r&&(c.next=r,c.force=!0),this.turn("update"),l.point=h,l.effect=="hard"?i.direction=="ltr"?i.pages[n].flip("turnPage",t>n?"r":"l"):i.pages[n].flip("turnPage",t>n?"l":"r"):i.direction=="ltr"?i.pages[n].flip("turnPage",f[t>n?1:0]):i.pages[n].flip("turnPage",f[t>n?0:1])},page:function(t){var n=this.data();if(t===undefined)return n.page;if(!n.disabled&&!n.destroying){t=parseInt(t,10);if(t>0&&t<=n.totalPages)return t!=n.page&&(!n.done||e.inArray(t,this.turn("view"))!=-1?_._fitPage.call(this,t):_._turnPage.call(this,t)),this;throw v("The page "+t+" does not exist")}},next:function(){return this.turn("page",Math.min(this.data().totalPages,_._view.call(this,this.data().page).pop()+1))},previous:function(){return this.turn("page",Math.max(1,_._view.call(this,this.data().page).shift()-1))},peel:function(e,t){var n=this.data(),r=this.turn("view");t=t===undefined?!0:t===!0;if(e===!1)this.turn("stop",null,t);else if(n.display=="single")n.pages[n.page].flip("peel",e,t);else{var i;n.direction=="ltr"?i=e.indexOf("l")!=-1?r[0]:r[1]:i=e.indexOf("l")!=-1?r[1]:r[0],n.pages[i]&&n.pages[i].flip("peel",e,t)}return this},_addMotionPage:function(){var t=e(this).data().f.opts,n=t.turn,r=n.data();_._addMv.call(n,t.page)},_eventStart:function(e,t,n){var r=t.turn.data(),i=r.pageZoom[t.page];if(e.isDefaultPrevented()){_._updateShadow.call(t.turn);return}i&&i!=r.zoom&&(t.turn.trigger("zoomed",[t.page,t.turn.turn("view",t.page),i,r.zoom]),r.pageZoom[t.page]=r.zoom),r.display=="single"&&n&&(n.charAt(1)=="l"&&r.direction=="ltr"||n.charAt(1)=="r"&&r.direction=="rtl"?(t.next=t.next<t.page?t.next:t.page-1,t.force=!0):t.next=t.next>t.page?t.next:t.page+1),_._addMotionPage.call(e.target),_._updateShadow.call(t.turn)},_eventEnd:function(t,n,r){var i=e(t.target),s=i.data().f,o=n.turn,u=o.data();if(r){var a=u.tpage||u.page;if(a==n.next||a==n.page)delete u.tpage,_._fitPage.call(o,a||n.next,!0)}else _._removeMv.call(o,n.page),_._updateShadow.call(o),o.turn("update")},_eventPressed:function(t){var n,r=e(t.target).data().f,i=r.opts.turn,s=i.data(),o=s.pages;return s.mouseAction=!0,i.turn("update"),r.time=(new Date).getTime()},_eventReleased:function(t,n){var r,i=e(t.target),s=i.data().f,o=s.opts.turn,u=o.data();u.display=="single"?r=n.corner=="br"||n.corner=="tr"?n.x<i.width()/2:n.x>i.width()/2:r=n.x<0||n.x>i.width();if((new Date).getTime()-s.time<200||r)t.preventDefault(),_._turnPage.call(o,s.opts.next);u.mouseAction=!1},_flip:function(t){t.stopPropagation();var n=e(t.target).data().f.opts;n.turn.trigger("turn",[n.next]),n.turn.data().opts.autoCenter&&n.turn.turn("center",n.next)},_touchStart:function(){var e=this.data();for(var t in e.pages)if(l(t,e.pages)&&D._eventStart.apply(e.pages[t],arguments)===!1)return!1},_touchMove:function(){var e=this.data();for(var t in e.pages)l(t,e.pages)&&D._eventMove.apply(e.pages[t],arguments)},_touchEnd:function(){var e=this.data();for(var t in e.pages)l(t,e.pages)&&D._eventEnd.apply(e.pages[t],arguments)},calculateZ:function(e){var t,n,r,i,s,o=this,u=this.data(),a=this.turn("view"),f=a[0]||a[1],l=e.length-1,c={pageZ:{},partZ:{},pageV:{}},h=function(e){var t=o.turn("view",e);t[0]&&(c.pageV[t[0]]=!0),t[1]&&(c.pageV[t[1]]=!0)};for(t=0;t<=l;t++)n=e[t],r=u.pages[n].data().f.opts.next,i=u.pagePlace[n],h(n),h(r),s=u.pagePlace[r]==r?r:n,c.pageZ[s]=u.totalPages-Math.abs(f-s),c.partZ[i]=u.totalPages*2-l+t;return c},update:function(){var t,n=this.data();if(this.turn("animating")&&n.pageMv[0]!==0){var r,i,s,o=this.turn("calculateZ",n.pageMv),u=this.turn("corner"),a=this.turn("view"),f=this.turn("view",n.tpage);for(t in n.pageWrap){if(!l(t,n.pageWrap))continue;s=n.pageObjs[t].hasClass("fixed"),n.pageWrap[t].css({display:o.pageV[t]||s?"":"none",zIndex:(n.pageObjs[t].hasClass("hard")?o.partZ[t]:o.pageZ[t])||(s?-1:0)});if(r=n.pages[t])r.flip("z",o.partZ[t]||null),o.pageV[t]&&r.flip("resize"),n.tpage?r.flip("hover",!1).flip("disable",e.inArray(parseInt(t,10),n.pageMv)==-1&&t!=f[0]&&t!=f[1]):r.flip("hover",u===!1).flip("disable",t!=a[0]&&t!=a[1])}}else for(t in n.pageWrap){if(!l(t,n.pageWrap))continue;var c=_._setPageLoc.call(this,t);n.pages[t]&&n.pages[t].flip("disable",n.disabled||c!=1).flip("hover",!0).flip("z",null)}return this},_updateShadow:function(){var t,r,i,s=this.data(),o=this.width(),u=this.height(),a=s.display=="single"?o:o/2;t=this.turn("view"),s.shadow||(s.shadow=e("<div />",{"class":"shadow",css:n(0,0,0).css}).appendTo(this));for(var f=0;f<s.pageMv.length;f++){if(!t[0]||!t[1])break;t=this.turn("view",s.pages[s.pageMv[f]].data().f.opts.next),r=this.turn("view",s.pageMv[f]),t[0]=t[0]&&r[0],t[1]=t[1]&&r[1]}t[0]?t[1]?i=3:i=s.direction=="ltr"?2:1:i=s.direction=="ltr"?1:2;switch(i){case 1:s.shadow.css({width:a,height:u,top:0,left:a});break;case 2:s.shadow.css({width:a,height:u,top:0,left:0});break;case 3:s.shadow.css({width:o,height:u,top:0,left:0})}},_setPageLoc:function(e){var t=this.data(),n=this.turn("view"),r=0;if(e==n[0]||e==n[1])r=1;else if(t.display=="single"&&e==n[0]+1||t.display=="double"&&e==n[0]-2||e==n[1]+2)r=2;if(!this.turn("animating"))switch(r){case 1:t.pageWrap[e].css({zIndex:t.totalPages,display:""});break;case 2:t.pageWrap[e].css({zIndex:t.totalPages-1,display:""});break;case 0:t.pageWrap[e].css({zIndex:0,display:t.pageObjs[e].hasClass("fixed")?"":"none"})}return r},options:function(t){if(t===undefined)return this.data().opts;var n=this.data();e.extend(n.opts,t),t.pages&&this.turn("pages",t.pages),t.page&&this.turn("page",t.page),t.display&&this.turn("display",t.display),t.direction&&this.turn("direction",t.direction),t.width&&t.height&&this.turn("size",t.width,t.height);if(t.when)for(var r in t.when)l(r,t.when)&&this.unbind(r).bind(r,t.when[r]);return this},version:function(){return E}},D={init:function(e){return this.data({f:{disabled:!1,hover:!1,effect:this.hasClass("hard")?"hard":"sheet"}}),this.flip("options",e),D._addPageWrapper.call(this),this},setData:function(t){var n=this.data();return n.f=e.extend(n.f,t),this},options:function(t){var n=this.data().f;return t?(D.setData.call(this,{opts:e.extend({},n.opts||O,t)}),this):n.opts},z:function(e){var t=this.data().f;return t.opts["z-index"]=e,t.fwrapper&&t.fwrapper.css({zIndex:e||parseInt(t.parent.css("z-index"),10)||0}),this},_cAllowed:function(){var e=this.data().f,t=e.opts.page,n=e.opts.turn.data(),r=t%2;return e.effect=="hard"?n.direction=="ltr"?[r?"r":"l"]:[r?"l":"r"]:n.display=="single"?t==1?n.direction=="ltr"?C.forward:C.backward:t==n.totalPages?n.direction=="ltr"?C.backward:C.forward:C.all:n.direction=="ltr"?C[r?"forward":"backward"]:C[r?"backward":"forward"]},_cornerActivated:function(t){var n=this.data().f,r=this.width(),i=this.height(),s={x:t.x,y:t.y,corner:""},o=n.opts.cornerSize;if(s.x<=0||s.y<=0||s.x>=r||s.y>=i)return!1;var u=D._cAllowed.call(this);switch(n.effect){case"hard":if(s.x>r-o)s.corner="r";else{if(!(s.x<o))return!1;s.corner="l"}break;case"sheet":if(s.y<o)s.corner+="t";else{if(!(s.y>=i-o))return!1;s.corner+="b"}if(s.x<=o)s.corner+="l";else{if(!(s.x>=r-o))return!1;s.corner+="r"}}return!s.corner||e.inArray(s.corner,u)==-1?!1:s},_isIArea:function(e){var t=this.data().f.parent.offset();return e=T&&e.originalEvent?e.originalEvent.touches[0]:e,D._cornerActivated.call(this,{x:e.pageX-t.left,y:e.pageY-t.top})},_c:function(e,t){t=t||0;switch(e){case"tl":return o(t,t);case"tr":return o(this.width()-t,t);case"bl":return o(t,this.height()-t);case"br":return o(this.width()-t,this.height()-t);case"l":return o(t,0);case"r":return o(this.width()-t,0)}},_c2:function(e){switch(e){case"tl":return o(this.width()*2,0);case"tr":return o(-this.width(),0);case"bl":return o(this.width()*2,this.height());case"br":return o(-this.width(),this.height());case"l":return o(this.width()*2,0);case"r":return o(-this.width(),0)}},_foldingPage:function(){var e=this.data().f;if(!e)return;var t=e.opts;if(t.turn)return e=t.turn.data(),e.display=="single"?t.next>1||t.page>1?e.pageObjs[0]:null:e.pageObjs[t.next]},_backGradient:function(){var t=this.data().f,r=t.opts.turn.data(),i=r.opts.gradients&&(r.display=="single"||t.opts.page!=2&&t.opts.page!=r.totalPages-1);return i&&!t.bshadow&&(t.bshadow=e("<div/>",n(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(t.parent)),i},type:function(){return this.data().f.effect},resize:function(e){var t=this.data().f,n=t.opts.turn.data(),r=this.width(),i=this.height();switch(t.effect){case"hard":e&&(t.wrapper.css({width:r,height:i}),t.fpage.css({width:r,height:i}),n.opts.gradients&&(t.ashadow.css({width:r,height:i}),t.bshadow.css({width:r,height:i})));break;case"sheet":if(e){var s=Math.round(Math.sqrt(Math.pow(r,2)+Math.pow(i,2)));t.wrapper.css({width:s,height:s}),t.fwrapper.css({width:s,height:s}).children(":first-child").css({width:r,height:i}),t.fpage.css({width:r,height:i}),n.opts.gradients&&t.ashadow.css({width:r,height:i}),D._backGradient.call(this)&&t.bshadow.css({width:r,height:i})}if(t.parent.is(":visible")){var o=m(t.parent[0]);t.fwrapper.css({top:o.top,left:o.left}),o=m(t.opts.turn[0]),t.fparent.css({top:-o.top,left:-o.left})}this.flip("z",t.opts["z-index"])}},_addPageWrapper:function(){var t,r=this.data().f,i=r.opts.turn.data(),s=this.parent();r.parent=s;if(!r.wrapper)switch(r.effect){case"hard":var o={};o[w+"transform-style"]="preserve-3d",o[w+"backface-visibility"]="hidden",r.wrapper=e("<div/>",n(0,0,2)).css(o).appendTo(s).prepend(this),r.fpage=e("<div/>",n(0,0,1)).css(o).appendTo(s),i.opts.gradients&&(r.ashadow=e("<div/>",n(0,0,0)).hide().appendTo(s),r.bshadow=e("<div/>",n(0,0,0)));break;case"sheet":var u=this.width(),a=this.height(),f=Math.round(Math.sqrt(Math.pow(u,2)+Math.pow(a,2)));r.fparent=r.opts.turn.data().fparent;if(!r.fparent){var l=e("<div/>",{css:{"pointer-events":"none"}}).hide();l.data().flips=0,l.css(n(0,0,"auto","visible").css).appendTo(r.opts.turn),r.opts.turn.data().fparent=l,r.fparent=l}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),r.wrapper=e("<div/>",n(0,0,this.css("z-index"))).appendTo(s).prepend(this),r.fwrapper=e("<div/>",n(s.offset().top,s.offset().left)).hide().appendTo(r.fparent),r.fpage=e("<div/>",n(0,0,0,"visible")).css({cursor:"default"}).appendTo(r.fwrapper),i.opts.gradients&&(r.ashadow=e("<div/>",n(0,0,1)).appendTo(r.fpage)),D.setData.call(this,r)}D.resize.call(this,!0)},_fold:function(e){var t=this.data().f,n=t.opts.turn.data(),r=D._c.call(this,e.corner),i=this.width(),u=this.height();switch(t.effect){case"hard":e.corner=="l"?e.x=Math.min(Math.max(e.x,0),i*2):e.x=Math.max(Math.min(e.x,i),-i);var l,c,h,d,v,m=n.totalPages,g=t.opts["z-index"]||m,y={overflow:"visible"},E=r.x?(r.x-e.x)/i:e.x/i,T=E*90,N=T<90;switch(e.corner){case"l":d="0% 50%",v="100% 50%",N?(l=0,c=t.opts.next-1>0,h=1):(l="100%",c=t.opts.page+1<m,h=0);break;case"r":d="100% 50%",v="0% 50%",T=-T,i=-i,N?(l=0,c=t.opts.next+1<m,h=0):(l="-100%",c=t.opts.page!=1,h=1)}y[w+"perspective-origin"]=v,t.wrapper.transform("rotateY("+T+"deg)"+"translate3d(0px, 0px, "+(this.attr("depth")||0)+"px)",v),t.fpage.transform("translateX("+i+"px) rotateY("+(180+T)+"deg)",d),t.parent.css(y),N?(E=-E+1,t.wrapper.css({zIndex:g+1}),t.fpage.css({zIndex:g})):(E-=1,t.wrapper.css({zIndex:g}),t.fpage.css({zIndex:g+1})),n.opts.gradients&&(c?t.ashadow.css({display:"",left:l,backgroundColor:"rgba(0,0,0,"+.5*E+")"}).transform("rotateY(0deg)"):t.ashadow.hide(),t.bshadow.css({opacity:-E+1}),N?t.bshadow.parent()[0]!=t.wrapper[0]&&t.bshadow.appendTo(t.wrapper):t.bshadow.parent()[0]!=t.fpage[0]&&t.bshadow.appendTo(t.fpage),p(t.bshadow,o(h*100,0),o((-h+1)*100,0),[[0,"rgba(0,0,0,0.3)"],[1,"rgba(0,0,0,0)"]],2));break;case"sheet":var C=this,k=0,L=0,A,O,M,_,P,H,B,j,F=o(0,0),I=o(0,0),q=o(0,0),R=D._foldingPage.call(this),U=Math.tan(L),z=n.opts.acceleration,W=t.wrapper.height(),X=e.corner.substr(0,1)=="t",V=e.corner.substr(1,1)=="l",$=function(){var t=o(0,0),a=o(0,0);t.x=r.x?r.x-e.x:e.x,b?t.y=r.y?r.y-e.y:e.y:t.y=0,a.x=V?i-t.x/2:e.x+t.x/2,a.y=t.y/2;var f=x-Math.atan2(t.y,t.x),l=f-Math.atan2(a.y,a.x),c=Math.max(0,Math.sin(l)*Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2)));k=s(f),q=o(c*Math.sin(f),c*Math.cos(f));if(f>x){q.x=q.x+Math.abs(q.y*t.y/t.x),q.y=0;if(Math.round(q.x*Math.tan(S-f))<u)return e.y=Math.sqrt(Math.pow(u,2)+2*a.x*t.x),X&&(e.y=u-e.y),$()}if(f>x){var h=S-f,p=W-u/Math.sin(h);F=o(Math.round(p*Math.cos(h)),Math.round(p*Math.sin(h))),V&&(F.x=-F.x),X&&(F.y=-F.y)}O=Math.round(q.y/Math.tan(f)+q.x);var d=i-O,v=d*Math.cos(f*2),m=d*Math.sin(f*2);I=o(Math.round(V?d-v:O+v),Math.round(X?m:u-m));if(n.opts.gradients){H=d*Math.sin(f);var g=D._c2.call(C,e.corner),y=Math.sqrt(Math.pow(g.x-e.x,2)+Math.pow(g.y-e.y,2))/i;j=Math.sin(x*(y>1?2-y:y)),B=Math.min(y,1),P=H>100?(H-100)/H:0,M=o(H*Math.sin(f)/i*100,H*Math.cos(f)/u*100),D._backGradient.call(C)&&(_=o(H*1.2*Math.sin(f)/i*100,H*1.2*Math.cos(f)/u*100),V||(_.x=100-_.x),X||(_.y=100-_.y))}return q.x=Math.round(q.x),q.y=Math.round(q.y),!0},J=function(e,r,s,l){var c=["0","auto"],h=(i-W)*s[0]/100,d=(u-W)*s[1]/100,v={left:c[r[0]],top:c[r[1]],right:c[r[2]],bottom:c[r[3]]},m={},g=l!=90&&l!=-90?V?-1:1:0,y=s[0]+"% "+s[1]+"%";C.css(v).transform(f(l)+a(e.x+g,e.y,z),y),t.fpage.css(v).transform(f(l)+a(e.x+I.x-F.x-i*s[0]/100,e.y+I.y-F.y-u*s[1]/100,z)+f((180/l-2)*l),y),t.wrapper.transform(a(-e.x+h-g,-e.y+d,z)+f(-l),y),t.fwrapper.transform(a(-e.x+F.x+h,-e.y+F.y+d,z)+f(-l),y),n.opts.gradients&&(s[0]&&(M.x=100-M.x),s[1]&&(M.y=100-M.y),m["box-shadow"]="0 0 20px rgba(0,0,0,"+.5*j+")",R.css(m),p(t.ashadow,o(V?100:0,X?0:100),o(M.x,M.y),[[P,"rgba(0,0,0,0)"],[(1-P)*.8+P,"rgba(0,0,0,"+.2*B+")"],[1,"rgba(255,255,255,"+.2*B+")"]],3,L),D._backGradient.call(C)&&p(t.bshadow,o(V?0:100,X?0:100),o(_.x,_.y),[[.6,"rgba(0,0,0,0)"],[.8,"rgba(0,0,0,"+.3*B+")"],[1,"rgba(0,0,0,0)"]],3))};switch(e.corner){case"l":break;case"r":break;case"tl":e.x=Math.max(e.x,1),$(),J(q,[1,0,0,1],[100,0],k);break;case"tr":e.x=Math.min(e.x,i-1),$(),J(o(-q.x,q.y),[0,0,0,1],[0,0],-k);break;case"bl":e.x=Math.max(e.x,1),$(),J(o(q.x,-q.y),[1,1,0,0],[100,100],-k);break;case"br":e.x=Math.min(e.x,i-1),$(),J(o(-q.x,-q.y),[0,1,1,0],[0,100],k)}}t.point=e},_moveFoldingPage:function(e){var t=this.data().f;if(!t)return;var n=t.opts.turn,r=n.data(),i=r.pagePlace;if(e){var s=t.opts.next;if(i[s]!=t.opts.page){t.folding&&D._moveFoldingPage.call(this,!1);var o=D._foldingPage.call(this);o.appendTo(t.fpage),i[s]=t.opts.page,t.folding=s}n.turn("update")}else if(t.folding){if(r.pages[t.folding]){var u=r.pages[t.folding].data().f;r.pageObjs[t.folding].appendTo(u.wrapper)}else r.pageWrap[t.folding]&&r.pageObjs[t.folding].appendTo(r.pageWrap[t.folding]);t.folding in i&&(i[t.folding]=t.folding),delete t.folding}},_showFoldedPage:function(e,t){var n=D._foldingPage.call(this),r=this.data(),i=r.f,s=i.visible;if(n){if(!s||!i.point||i.point.corner!=e.corner){var o=i.status=="hover"||i.status=="peel"||i.opts.turn.data().mouseAction?e.corner:null;s=!1;if(d("start",this,[i.opts,o])=="prevented")return!1}if(t){var u=this,a=i.point&&i.point.corner==e.corner?i.point:D._c.call(this,e.corner,1);this.animatef({from:[a.x,a.y],to:[e.x,e.y],duration:500,frame:function(t){e.x=Math.round(t[0]),e.y=Math.round(t[1]),D._fold.call(u,e)}})}else D._fold.call(this,e),r.effect&&!r.effect.turning&&this.animatef(!1);if(!s)switch(i.effect){case"hard":i.visible=!0,D._moveFoldingPage.call(this,!0),i.fpage.show(),i.opts.shadows&&i.bshadow.show();break;case"sheet":i.visible=!0,i.fparent.show().data().flips++,D._moveFoldingPage.call(this,!0),i.fwrapper.show(),i.bshadow&&i.bshadow.show()}return!0}return!1},hide:function(){var e=this.data().f,t=e.opts.turn.data(),n=D._foldingPage.call(this);switch(e.effect){case"hard":t.opts.gradients&&(e.bshadowLoc=0,e.bshadow.remove(),e.ashadow.hide()),e.wrapper.transform(""),e.fpage.hide();break;case"sheet":--e.fparent.data().flips===0&&e.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform(""),e.wrapper.transform(""),e.fwrapper.hide(),e.bshadow&&e.bshadow.hide(),n.transform("")}return e.visible=!1,this},hideFoldedPage:function(e){var t=this.data().f;if(!t.point)return;var n=this,i=t.point,s=function(){t.point=null,t.status="",n.flip("hide"),n.trigger("end",[t.opts,!1])};if(e){var u=D._c.call(this,i.corner),a=i.corner.substr(0,1)=="t",f=a?Math.min(0,i.y-u.y)/2:Math.max(0,i.y-u.y)/2,l=o(i.x,i.y+f),c=o(u.x,u.y-f);this.animatef({from:0,to:1,frame:function(e){var t=r(i,l,c,u,e);i.x=t.x,i.y=t.y,D._fold.call(n,i)},complete:s,duration:800,hiding:!0})}else this.animatef(!1),s()},turnPage:function(e){var t=this,n=this.data().f,i=n.opts.turn.data();e={corner:n.corner?n.corner.corner:e||D._cAllowed.call(this)[0]};var s=n.point||D._c.call(this,e.corner,n.opts.turn?i.opts.elevation:0),o=D._c2.call(this,e.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(n){var i=r(s,s,o,o,n);e.x=i.x,e.y=i.y,D._showFoldedPage.call(t,e)},complete:function(){t.trigger("end",[n.opts,!0])},duration:i.opts.duration,turning:!0}),n.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},corner:function(){return this.data().f.corner},_eventStart:function(e){var t=this.data().f,n=t.opts.turn;if(!t.corner&&!t.disabled&&!this.flip("isTurning")&&t.opts.page==n.data().pagePlace[t.opts.page]){t.corner=D._isIArea.call(this,e);if(t.corner&&D._foldingPage.call(this))return this.trigger("pressed",[t.point]),D._showFoldedPage.call(this,t.corner),!1;t.corner=null}},_eventMove:function(e){var t=this.data().f;if(!t.disabled){e=T?e.originalEvent.touches:[e];if(t.corner){var n=t.parent.offset();t.corner.x=e[0].pageX-n.left,t.corner.y=e[0].pageY-n.top,D._showFoldedPage.call(this,t.corner)}else if(t.hover&&!this.data().effect&&this.is(":visible")){var r=D._isIArea.call(this,e[0]);if(r){if(t.effect=="sheet"&&r.corner.length==2||t.effect=="hard"){t.status="hover";var i=D._c.call(this,r.corner,t.opts.cornerSize/2);r.x=i.x,r.y=i.y,D._showFoldedPage.call(this,r,!0)}}else t.status=="hover"&&(t.status="",D.hideFoldedPage.call(this,!0))}}},_eventEnd:function(){var e=this.data().f,t=e.corner;!e.disabled&&t&&d("released",this,[e.point||t])!="prevented"&&D.hideFoldedPage.call(this,!0),e.corner=null},disable:function(e){return D.setData.call(this,{disabled:e}),this},hover:function(e){return D.setData.call(this,{hover:e}),this},peel:function(t,n){var r=this.data().f;if(t){if(e.inArray(t,C.all)==-1)throw v("Corner "+t+" is not permitted");if(e.inArray(t,D._cAllowed.call(this))!=-1){var i=D._c.call(this,t,r.opts.cornerSize/2);r.status="peel",D._showFoldedPage.call(this,{corner:t,x:i.x,y:i.y},n)}}else r.status="",D.hideFoldedPage.call(this,n);return this}};window.requestAnim=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),e.extend(e.fn,{flip:function(){return t(e(this[0]),D,arguments)},turn:function(){return t(e(this[0]),_,arguments)},transform:function(e,t){var n={};return t&&(n[w+"transform-origin"]=t),n[w+"transform"]=e,this.css(n)},animatef:function(t){var n=this.data();n.effect&&n.effect.stop();if(t){t.to.length||(t.to=[t.to]),t.from.length||(t.from=[t.from]);var r=[],i=t.to.length,s=!0,o=this,u=(new Date).getTime(),a=function(){if(!n.effect||!s)return;var e=[],f=Math.min(t.duration,(new Date).getTime()-u);for(var l=0;l<i;l++)e.push(n.effect.easing(1,f,t.from[l],r[l],t.duration));t.frame(i==1?e[0]:e),f==t.duration?(delete n.effect,o.data(n),t.complete&&t.complete()):window.requestAnim(a)};for(var f=0;f<i;f++)r.push(t.to[f]-t.from[f]);n.effect=e.extend({stop:function(){s=!1},easing:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n}},t),this.data(n),a()}else delete n.effect}}),e.isTouch=T,e.mouseEvents=N,e.cssPrefix=c,e.cssTransitionEnd=h,e.findPos=m}(jQuery),define("turn",["jquery"],function(){}),define("extensions/lib/aura-turn",{require:{paths:{jquery:"bower_components/jquery/jquery",turn:"bower_components/turnjs/lib/turn"},shim:{turn:{deps:["jquery"]}}},initialize:function(e){}}),function(e,t){function n(){if(r.READY)return;y.determineEventTypes(),d.each(r.gestures,function(e){w.register(e)}),y.onTouch(r.DOCUMENT,h,w.detect),y.onTouch(r.DOCUMENT,p,w.detect),r.READY=!0}var r=function(e,t){return new r.Instance(e,t||{})};r.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},r.HAS_POINTEREVENTS=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,r.HAS_TOUCHEVENTS="ontouchstart"in e,r.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,r.NO_MOUSEEVENTS=r.HAS_TOUCHEVENTS&&e.navigator.userAgent.match(r.MOBILE_REGEX),r.EVENT_TYPES={},r.UPDATE_VELOCITY_INTERVAL=16,r.DOCUMENT=e.document;var i=r.DIRECTION_DOWN="down",s=r.DIRECTION_LEFT="left",o=r.DIRECTION_UP="up",u=r.DIRECTION_RIGHT="right",a=r.POINTER_MOUSE="mouse",f=r.POINTER_TOUCH="touch",l=r.POINTER_PEN="pen",c=r.EVENT_START="start",h=r.EVENT_MOVE="move",p=r.EVENT_END="end";r.plugins=r.plugins||{},r.gestures=r.gestures||{},r.READY=!1;var d=r.utils={extend:function(e,n,r){for(var i in n){if(e[i]!==t&&r)continue;e[i]=n[i]}return e},each:function(e,n,r){var i,s;if("forEach"in e)e.forEach(n,r);else if(e.length!==t){for(i=-1;s=e[++i];)if(n.call(r,s,i,e)===!1)return}else for(i in e)if(e.hasOwnProperty(i)&&n.call(r,e[i],i,e)===!1)return},hasParent:function(e,t){while(e){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){var t=[],n=[];return d.each(e,function(e){t.push(typeof e.clientX!="undefined"?e.clientX:e.pageX),n.push(typeof e.clientY!="undefined"?e.clientY:e.pageY)}),{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2}},getVelocity:function(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}},getAngle:function(e,t){var n=t.pageY-e.pageY,r=t.pageX-e.pageX;return Math.atan2(n,r)*180/Math.PI},getDirection:function(e,t){var n=Math.abs(e.pageX-t.pageX),r=Math.abs(e.pageY-t.pageY);return n>=r?e.pageX-t.pageX>0?s:u:e.pageY-t.pageY>0?o:i},getDistance:function(e,t){var n=t.pageX-e.pageX,r=t.pageY-e.pageY;return Math.sqrt(n*n+r*r)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==o||e==i},toggleDefaultBehavior:function(e,t,n){if(!t||!e||!e.style)return;d.each(["webkit","moz","Moz","ms","o",""],function(r){d.each(t,function(t,i){r&&(i=r+i.substring(0,1).toUpperCase()+i.substring(1)),i in e.style&&(e.style[i]=!n&&t)})});var r=function(){return!1};t.userSelect=="none"&&(e.onselectstart=!n&&r),t.userDrag=="none"&&(e.ondragstart=!n&&r)}};r.Instance=function(e,t){var i=this;return n(),this.element=e,this.enabled=!0,this.options=d.extend(d.extend({},r.defaults),t||{}),this.options.stop_browser_behavior&&d.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=y.onTouch(e,c,function(e){i.enabled&&w.startDetect(i,e)}),this.eventHandlers=[],this},r.Instance.prototype={on:function(e,t){var n=e.split(" ");return d.each(n,function(e){this.element.addEventListener(e,t,!1),this.eventHandlers.push({gesture:e,handler:t})},this),this},off:function(e,t){var n=e.split(" "),r,i;return d.each(n,function(e){this.element.removeEventListener(e,t,!1);for(r=-1;i=this.eventHandlers[++r];)i.gesture===e&&i.handler===t&&this.eventHandlers.splice(r,1)},this),this},trigger:function(e,t){t||(t={});var n=r.DOCUMENT.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t;var i=this.element;return d.hasParent(t.target,i)&&(i=t.target),i.dispatchEvent(n),this},enable:function(e){return this.enabled=e,this},dispose:function(){var e,t;this.options.stop_browser_behavior&&d.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0);for(e=-1;t=this.eventHandlers[++e];)this.element.removeEventListener(t.gesture,t.handler,!1);return this.eventHandlers=[],y.unbindDom(this.element,r.EVENT_TYPES[c],this.eventStartHandler),null}};var v=null,m=!1,g=!1,y=r.event={bindDom:function(e,t,n){var r=t.split(" ");d.each(r,function(t){e.addEventListener(t,n,!1)})},unbindDom:function(e,t,n){var r=t.split(" ");d.each(r,function(t){e.removeEventListener(t,n,!1)})},onTouch:function(e,t,n){var i=this,s=function(s){var o=s.type.toLowerCase();if(o.match(/mouse/)&&g)return;o.match(/touch/)||o.match(/pointerdown/)||o.match(/mouse/)&&s.which===1?m=!0:o.match(/mouse/)&&!s.which&&(m=!1),o.match(/touch|pointer/)&&(g=!0);var u=0;if(m){r.HAS_POINTEREVENTS&&t!=p?u=b.updatePointer(t,s):o.match(/touch/)?u=s.touches.length:g||(u=o.match(/up/)?0:1),u>0&&t==p?t=h:u||(t=p);if(u||v===null)v=s;n.call(w,i.collectEventData(e,t,i.getTouchList(v,t),s)),r.HAS_POINTEREVENTS&&t==p&&(u=b.updatePointer(t,s))}u||(v=null,m=!1,g=!1,b.reset())};return this.bindDom(e,r.EVENT_TYPES[t],s),s},determineEventTypes:function(){var e;r.HAS_POINTEREVENTS?e=b.getEvents():r.NO_MOUSEEVENTS?e=["touchstart","touchmove","touchend touchcancel"]:e=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],r.EVENT_TYPES[c]=e[0],r.EVENT_TYPES[h]=e[1],r.EVENT_TYPES[p]=e[2]},getTouchList:function(e){return r.HAS_POINTEREVENTS?b.getTouchList():e.touches?e.touches:(e.identifier=1,[e])},collectEventData:function(e,t,n,r){var i=f;if(r.type.match(/mouse/)||b.matchType(a,r))i=a;return{center:d.getCenter(n),timeStamp:(new Date).getTime(),target:r.target,touches:n,eventType:t,pointerType:i,srcEvent:r,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return w.stopDetect()}}}},b=r.PointerEvent={pointers:{},getTouchList:function(){var e=[];return d.each(this.pointers,function(t){e.push(t)}),e},updatePointer:function(e,t){return e==p?delete this.pointers[t.pointerId]:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var n=t.pointerType,r={};return r[a]=n===a,r[f]=n===f,r[l]=n===l,r[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},w=r.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){if(this.current)return;this.stopped=!1,this.current={inst:e,startEvent:d.extend({},t),lastEvent:!1,lastVelocityEvent:!1,velocity:!1,name:""},this.detect(t)},detect:function(e){if(!this.current||this.stopped)return;e=this.extendEventData(e);var t=this.current.inst.options;return d.each(this.gestures,function(n){if(!this.stopped&&t[n.name]!==!1&&n.handler.call(n,e,this.current.inst)===!1)return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=e),e.eventType==p&&!e.touches.length-1&&this.stopDetect(),e},stopDetect:function(){this.previous=d.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(e){var t=this.current,n=t.startEvent;if(e.touches.length!=n.touches.length||e.touches===n.touches)n.touches=[],d.each(e.touches,function(e){n.touches.push(d.extend({},e))});var i=e.timeStamp-n.timeStamp,s=e.center.pageX-n.center.pageX,o=e.center.pageY-n.center.pageY,u,a,f=t.lastVelocityEvent,l=t.velocity;return f&&e.timeStamp-f.timeStamp>r.UPDATE_VELOCITY_INTERVAL?(l=d.getVelocity(e.timeStamp-f.timeStamp,e.center.pageX-f.center.pageX,e.center.pageY-f.center.pageY),t.lastVelocityEvent=e,t.velocity=l):t.velocity||(l=d.getVelocity(i,s,o),t.lastVelocityEvent=e,t.velocity=l),e.eventType==p?(u=t.lastEvent&&t.lastEvent.interimAngle,a=t.lastEvent&&t.lastEvent.interimDirection):(u=t.lastEvent&&d.getAngle(t.lastEvent.center,e.center),a=t.lastEvent&&d.getDirection(t.lastEvent.center,e.center)),d.extend(e,{deltaTime:i,deltaX:s,deltaY:o,velocityX:l.x,velocityY:l.y,distance:d.getDistance(n.center,e.center),angle:d.getAngle(n.center,e.center),interimAngle:u,direction:d.getDirection(n.center,e.center),interimDirection:a,scale:d.getScale(n.touches,e.touches),rotation:d.getRotation(n.touches,e.touches),startEvent:n}),e},register:function(e){var n=e.defaults||{};return n[e.name]===t&&(n[e.name]=!0),d.extend(r.defaults,n,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}};r.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,t){if(w.current.name!=this.name&&this.triggered){t.trigger(this.name+"end",e),this.triggered=!1;return}if(t.options.drag_max_touches>0&&e.touches.length>t.options.drag_max_touches)return;switch(e.eventType){case c:this.triggered=!1;break;case h:if(e.distance<t.options.drag_min_distance&&w.current.name!=this.name)return;if(w.current.name!=this.name){w.current.name=this.name;if(t.options.correct_for_drag_min_distance&&e.distance>0){var n=Math.abs(t.options.drag_min_distance/e.distance);w.current.startEvent.center.pageX+=e.deltaX*n,w.current.startEvent.center.pageY+=e.deltaY*n,e=w.extendEventData(e)}}if(w.current.lastEvent.drag_locked_to_axis||t.options.drag_lock_to_axis&&t.options.drag_lock_min_distance<=e.distance)e.drag_locked_to_axis=!0;var r=w.current.lastEvent.direction;e.drag_locked_to_axis&&r!==e.direction&&(d.isVertical(r)?e.direction=e.deltaY<0?o:i:e.direction=e.deltaX<0?s:u),this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),t.trigger(this.name+e.direction,e);var a=d.isVertical(e.direction);(t.options.drag_block_vertical&&a||t.options.drag_block_horizontal&&!a)&&e.preventDefault();break;case p:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},r.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(e,t){switch(e.eventType){case c:clearTimeout(this.timer),w.current.name=this.name,this.timer=setTimeout(function(){w.current.name=="hold"&&t.trigger("hold",e)},t.options.hold_timeout);break;case h:e.distance>t.options.hold_threshold&&clearTimeout(this.timer);break;case p:clearTimeout(this.timer)}}},r.gestures.Release={name:"release",index:Infinity,handler:function(e,t){e.eventType==p&&t.trigger(this.name,e)}},r.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(e,t){if(e.eventType==p){if(e.touches.length<t.options.swipe_min_touches||e.touches.length>t.options.swipe_max_touches)return;if(e.velocityX>t.options.swipe_velocity||e.velocityY>t.options.swipe_velocity)t.trigger(this.name,e),t.trigger(this.name+e.direction,e)}}},r.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(e,t){var n,r,i;if(e.eventType==c)this.has_moved=!1;else if(e.eventType==h&&!this.moved)this.has_moved=e.distance>t.options.tap_max_distance;else if(e.eventType==p&&e.srcEvent.type!="touchcancel"&&e.deltaTime<t.options.tap_max_touchtime&&!this.has_moved){n=w.previous,r=n&&n.lastEvent&&e.timeStamp-n.lastEvent.timeStamp,i=!1,n&&n.name=="tap"&&r&&r<t.options.doubletap_interval&&e.distance<t.options.doubletap_distance&&(t.trigger("doubletap",e),i=!0);if(!i||t.options.tap_always)w.current.name="tap",t.trigger(w.current.name,e)}}},r.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,t){if(t.options.prevent_mouseevents&&e.pointerType==a){e.stopDetect();return}t.options.prevent_default&&e.preventDefault(),e.eventType==c&&t.trigger(this.name,e)}},r.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(e,t){if(w.current.name!=this.name&&this.triggered){t.trigger(this.name+"end",e),this.triggered=!1;return}if(e.touches.length<2)return;t.options.transform_always_block&&e.preventDefault();if(t.options.transform_within_instance)for(var n=-1;e.touches[++n];)if(!d.hasParent(e.touches[n].target,t.element))return;switch(e.eventType){case c:this.triggered=!1;break;case h:var r=Math.abs(1-e.scale),i=Math.abs(e.rotation);if(r<t.options.transform_min_scale&&i<t.options.transform_min_rotation)return;w.current.name=this.name,this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),i>t.options.transform_min_rotation&&t.trigger("rotate",e),r>t.options.transform_min_scale&&(t.trigger("pinch",e),t.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case p:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},typeof define=="function"&&define.amd?define("hammer",[],function(){return r}):typeof module=="object"&&module.exports?module.exports=r:e.Hammer=r}(window),define("extensions/lib/aura-hammer",{require:{paths:{hammer:"bower_components/hammerjs/hammer"}},initialize:function(e){}});var swfobject=function(){function e(){if(z||!document.getElementsByTagName("body")[0])return;try{var e,t=g("span");t.style.display="none",e=_.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(n){return}z=!0;var r=H.length;for(var i=0;i<r;i++)H[i]()}function t(e){z?e():H[H.length]=e}function n(e){if(typeof M.addEventListener!=T)M.addEventListener("load",e,!1);else if(typeof _.addEventListener!=T)_.addEventListener("load",e,!1);else if(typeof M.attachEvent!=T)b(M,"onload",e);else if(typeof M.onload=="function"){var t=M.onload;M.onload=function(){t(),e()}}else M.onload=e}function r(){var e=_.getElementsByTagName("body")[0],t=g(N);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",L);var n=e.appendChild(t);if(n){var r=0;(function s(){if(typeof n.GetVariable!=T)try{var o=n.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),K.pv=[y(o[0]),y(o[1]),y(o[2])])}catch(u){K.pv=[8,0,0]}else if(r<10){r++,setTimeout(s,10);return}e.removeChild(t),n=null,i()})()}else i()}function i(){var e=B.length;if(e>0)for(var t=0;t<e;t++){var n=B[t].id,r=B[t].callbackFn,i={success:!1,id:n};if(K.pv[0]>0){var f=m(n);if(f)if(w(B[t].swfVersion)&&!(K.wk&&K.wk<312))S(n,!0),r&&(i.success=!0,i.ref=s(n),i.id=n,r(i));else if(B[t].expressInstall&&o()){var l={};l.data=B[t].expressInstall,l.width=f.getAttribute("width")||"0",l.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(l.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(l.align=f.getAttribute("align"));var c={},h=f.getElementsByTagName("param"),p=h.length;for(var d=0;d<p;d++)h[d].getAttribute("name").toLowerCase()!="movie"&&(c[h[d].getAttribute("name")]=h[d].getAttribute("value"));u(l,c,n,r)}else a(f),r&&r(i)}else{S(n,!0);if(r){var v=s(n);v&&typeof v.SetVariable!=T&&(i.success=!0,i.ref=v,i.id=v.id),r(i)}}}}function s(e){var t=null,n=m(e);return n&&n.nodeName.toUpperCase()==="OBJECT"&&(typeof n.SetVariable!==T?t=n:t=n.getElementsByTagName(N)[0]||n),t}function o(){return!W&&w("6.0.65")&&(K.win||K.mac)&&!(K.wk&&K.wk<312)}function u(e,t,n,r){var i=m(n);n=v(n),W=!0,R=r||null,U={success:!1,id:n};if(i){i.nodeName.toUpperCase()=="OBJECT"?(I=f(i),q=null):(I=i,q=n),e.id=A;if(typeof e.width==T||!/%$/.test(e.width)&&y(e.width)<310)e.width="310";if(typeof e.height==T||!/%$/.test(e.height)&&y(e.height)<137)e.height="137";var s=K.ie?"ActiveX":"PlugIn",o="MMredirectURL="+encodeURIComponent(M.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+s+"&MMdoctitle="+encodeURIComponent(_.title.slice(0,47)+" - Flash Player Installation");typeof t.flashvars!=T?t.flashvars+="&"+o:t.flashvars=o;if(K.ie&&i.readyState!=4){var u=g("div");n+="SWFObjectNew",u.setAttribute("id",n),i.parentNode.insertBefore(u,i),i.style.display="none",p(i)}c(e,t,n)}}function a(e){if(K.ie&&e.readyState!=4){e.style.display="none";var t=g("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(f(e),t),p(e)}else e.parentNode.replaceChild(f(e),e)}function f(e){var t=g("div");if(K.win&&K.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(N)[0];if(n){var r=n.childNodes;if(r){var i=r.length;for(var s=0;s<i;s++)(r[s].nodeType!=1||r[s].nodeName!="PARAM")&&r[s].nodeType!=8&&t.appendChild(r[s].cloneNode(!0))}}}return t}function l(e,t){var n=g("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",n.firstChild}function c(e,t,n){var r,i=m(n);n=v(n);if(K.wk&&K.wk<312)return r;if(i){var s=K.ie?g("div"):g(N),o,u,a;typeof e.id==T&&(e.id=n);for(a in t)t.hasOwnProperty(a)&&a.toLowerCase()!=="movie"&&h(s,a,t[a]);K.ie&&(s=l(e.data,s.innerHTML));for(o in e)e.hasOwnProperty(o)&&(u=o.toLowerCase(),u==="styleclass"?s.setAttribute("class",e[o]):u!=="classid"&&u!=="data"&&s.setAttribute(o,e[o]));K.ie?j[j.length]=e.id:(s.setAttribute("type",L),s.setAttribute("data",e.data)),i.parentNode.replaceChild(s,i),r=s}return r}function h(e,t,n){var r=g("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function p(e){var t=m(e);t&&t.nodeName.toUpperCase()=="OBJECT"&&(K.ie?(t.style.display="none",function n(){if(t.readyState==4){for(var e in t)typeof t[e]=="function"&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(n,10)}()):t.parentNode.removeChild(t))}function d(e){return e&&e.nodeType&&e.nodeType===1}function v(e){return d(e)?e.id:e}function m(e){if(d(e))return e;var t=null;try{t=_.getElementById(e)}catch(n){}return t}function g(e){return _.createElement(e)}function y(e){return parseInt(e,10)}function b(e,t,n){e.attachEvent(t,n),F[F.length]=[e,t,n]}function w(e){e+="";var t=K.pv,n=e.split(".");return n[0]=y(n[0]),n[1]=y(n[1])||0,n[2]=y(n[2])||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function E(e,t,n,r){var i=_.getElementsByTagName("head")[0];if(!i)return;var s=typeof n=="string"?n:"screen";r&&(X=null,V=null);if(!X||V!=s){var o=g("style");o.setAttribute("type","text/css"),o.setAttribute("media",s),X=i.appendChild(o),K.ie&&typeof _.styleSheets!=T&&_.styleSheets.length>0&&(X=_.styleSheets[_.styleSheets.length-1]),V=s}X&&(typeof X.addRule!=T?X.addRule(e,t):typeof _.createTextNode!=T&&X.appendChild(_.createTextNode(e+" {"+t+"}")))}function S(e,t){if(!$)return;var n=t?"visible":"hidden",r=m(e);z&&r?r.style.visibility=n:typeof e=="string"&&E("#"+e,"visibility:"+n)}function x(e){var t=/[\\\"<>\.;]/,n=t.exec(e)!=null;return n&&typeof encodeURIComponent!=T?encodeURIComponent(e):e}var T="undefined",N="object",C="Shockwave Flash",k="ShockwaveFlash.ShockwaveFlash",L="application/x-shockwave-flash",A="SWFObjectExprInst",O="onreadystatechange",M=window,_=document,D=navigator,P=!1,H=[],B=[],j=[],F=[],I,q,R,U,z=!1,W=!1,X,V,$=!0,J=!1,K=function(){var e=typeof _.getElementById!=T&&typeof _.getElementsByTagName!=T&&typeof _.createElement!=T,t=D.userAgent.toLowerCase(),n=D.platform.toLowerCase(),r=n?/win/.test(n):/win/.test(t),i=n?/mac/.test(n):/mac/.test(t),s=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o=D.appName==="Microsoft Internet Explorer",u=[0,0,0],a=null;if(typeof D.plugins!=T&&typeof D.plugins[C]==N)a=D.plugins[C].description,a&&typeof D.mimeTypes!=T&&D.mimeTypes[L]&&D.mimeTypes[L].enabledPlugin&&(P=!0,o=!1,a=a.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),u[0]=y(a.replace(/^(.*)\..*$/,"$1")),u[1]=y(a.replace(/^.*\.(.*)\s.*$/,"$1")),u[2]=/[a-zA-Z]/.test(a)?y(a.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof M.ActiveXObject!=T)try{var f=new ActiveXObject(k);f&&(a=f.GetVariable("$version"),a&&(o=!0,a=a.split(" ")[1].split(","),u=[y(a[0]),y(a[1]),y(a[2])]))}catch(l){}return{w3:e,pv:u,wk:s,ie:o,win:r,mac:i}}(),Q=function(){if(!K.w3)return;(typeof _.readyState!=T&&(_.readyState==="complete"||_.readyState==="interactive")||typeof _.readyState==T&&(_.getElementsByTagName("body")[0]||_.body))&&e(),z||(typeof _.addEventListener!=T&&_.addEventListener("DOMContentLoaded",e,!1),K.ie&&(_.attachEvent(O,function t(){_.readyState=="complete"&&(_.detachEvent(O,t),e())}),M==top&&function n(){if(z)return;try{_.documentElement.doScroll("left")}catch(t){setTimeout(n,0);return}e()}()),K.wk&&function r(){if(z)return;if(!/loaded|complete/.test(_.readyState)){setTimeout(r,0);return}e()}())}();H[0]=function(){P?r():i()};var G=function(){K.ie&&window.attachEvent("onunload",function(){var e=F.length;for(var t=0;t<e;t++)F[t][0].detachEvent(F[t][1],F[t][2]);var n=j.length;for(var r=0;r<n;r++)p(j[r]);for(var i in K)K[i]=null;K=null;for(var s in swfobject)swfobject[s]=null;swfobject=null})}();return{registerObject:function(e,t,n,r){if(K.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=r,B[B.length]=i,S(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){if(K.w3)return s(e)},embedSWF:function(e,n,r,i,s,a,f,l,h,p){var d=v(n),m={success:!1,id:d};K.w3&&!(K.wk&&K.wk<312)&&e&&n&&r&&i&&s?(S(d,!1),t(function(){r+="",i+="";var t={};if(h&&typeof h===N)for(var v in h)t[v]=h[v];t.data=e,t.width=r,t.height=i;var g={};if(l&&typeof l===N)for(var y in l)g[y]=l[y];if(f&&typeof f===N)for(var b in f)if(f.hasOwnProperty(b)){var E=J?encodeURIComponent(b):b,x=J?encodeURIComponent(f[b]):f[b];typeof g.flashvars!=T?g.flashvars+="&"+E+"="+x:g.flashvars=E+"="+x}if(w(s)){var C=c(t,g,n);t.id==d&&S(d,!0),m.success=!0,m.ref=C,m.id=C.id}else{if(a&&o()){t.data=a,u(t,g,n,p);return}S(d,!0)}p&&p(m)})):p&&p(m)},switchOffAutoHideShow:function(){$=!1},enableUriEncoding:function(e){J=typeof e===T?!0:e},ua:K,getFlashPlayerVersion:function(){return{major:K.pv[0],minor:K.pv[1],release:K.pv[2]}},hasFlashPlayerVersion:w,createSWF:function(e,t,n){return K.w3?c(e,t,n):undefined},showExpressInstall:function(e,t,n,r){K.w3&&o()&&u(e,t,n,r)},removeSWF:function(e){K.w3&&p(e)},createCSS:function(e,t,n,r){K.w3&&E(e,t,n,r)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=_.location.search||_.location.hash;if(t){/\?/.test(t)&&(t=t.split("?")[1]);if(e==null)return x(t);var n=t.split("&");for(var r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return x(n[r].substring(n[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(W){var e=m(A);e&&I&&(e.parentNode.replaceChild(I,e),q&&(S(q,!0),K.ie&&(I.style.display="block")),R&&R(U)),W=!1}},version:"2.3"}}();define("swfobject",function(){}),define("extensions/lib/aura-swfobject",{require:{paths:{swfobject:"bower_components/swfobject/swfobject/swfobject"}},initialize:function(e){window.setPreviewImage=function(e){var t=$(".rd-viewport-page.p"+(e.index+1)+""),n=e.encode.replace(/[\r\n]/g,"");t.css({background:'url("data:image/jpeg;base64,'+n+'")',"background-size":"100%"}),window.sandbox.pages.set(e.index,{previewImage:!0})}}}),function(e){function t(){n&&(s(t),jQuery.fx.tick())}var n,r=0,i=["webkit","moz"],s=window.requestAnimationFrame,o=window.cancelAnimationFrame;for(;r<i.length&&!s;r++)s=window[i[r]+"RequestAnimationFrame"],o=o||window[i[r]+"CancelAnimationFrame"]||window[i[r]+"CancelRequestAnimationFrame"];s?(window.requestAnimationFrame=s,window.cancelAnimationFrame=o,jQuery.fx.timer=function(e){e()&&jQuery.timers.push(e)&&!n&&(n=!0,t())},jQuery.fx.stop=function(){n=!1}):(window.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-r)),s=window.setTimeout(function(){e(n+i)},i);return r=n+i,s},window.cancelAnimationFrame=function(e){clearTimeout(e)})}(jQuery),define("requestAnimationFrame",function(){}),define("extensions/lib/jquery-plugins",{require:{paths:{jquery:"bower_components/jquery/jquery",requestAnimationFrame:"bower_components/jquery-requestAnimationFrame/dist/jquery.requestAnimationFrame"},shim:{turn:{deps:["jquery"]}}},initialize:function(){$.getCSS=function(e,t){$(document.createElement("link")).attr({href:e,media:t||"screen",type:"text/css",rel:"stylesheet"}).appendTo("head")},$.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()}}}),define("extensions/utils",{initialize:function(e){var t=$(window),n=e.core.mediator,r=e.config.reader.ratio,i=e.config.reader.productId,s=e.config.reader.documentId;$.extend(e.core.util,{getWindowHeight:function(){var n=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;if(e.sandbox.reader.get("embed")&&e.sandbox.reader.get("flexible")&&n===!0){var i=e.config.reader.display==="double"?t.width()/2:t.width(),s=window.parseInt(i/r+e.sandbox.toolbar.get("height"));return t.height()<s?t.height():s}return t.height()},url:{getImages:function(t){return e.config.baseUrl+"/Content/img/picto/"+t},getContent:function(t){var n=e.sandbox.reader.get(),r=n.token?"&token="+n.token:"",o="&embed="+n.embed,u=e.sandbox.reader.get("streamingVersion"),a=u==null?"":"&version="+u;if(n.capacities.image)return e.config.baseUrl+"/BookReader/Page?documentId="+s+"&productId="+i+r+"&page="+t+o+a;if(n.capacities.flash)return e.config.baseUrl+"/FlashReader/Page?documentId="+s+"&productId="+i+r+"&page="+t+o+a;if(n.capacities.html)return e.config.baseUrl+"/BookReader/HtmlPage?documentId="+s+"&productId="+i+"&page="+t+a},getPreviewEmbed:function(t){return encodeURI(e.config.baseUrl+"/BookReader/EmbedPreview?productId="+i+"&width="+t.width+"&height="+t.height+"&startPage="+t.startPage+"&displayMode="+t.display+"&documentId="+s+"&isFlexible="+t.flexible)},getProduct:function(){return e.sandbox.reader.get("isPublic")?e.sandbox.reader.get("productUrl"):e.config.baseUrl},getAbo:function(){return e.config.baseUrl+"/abo"},getSubscription:function(){return e.sandbox.reader.get("subscriptionUrl")},getSubscription:function(){return e.sandbox.reader.get("subscriptionUrl")},getImageProduct:function(){return e.sandbox.reader.get("imageProductUrl")},getFullscreen:function(t){return encodeURI(e.config.baseUrl+"/BookReader/IframeEmbed?productId="+i+"&width=auto&height=auto&startPage="+t.startPage+"&displayMode="+t.display+"&documentId="+s+"&fullscreen=1")+"&token="+t.token},getFlashLoader:function(){return e.config.baseUrl+"/Content/flash/reader/FlashLoader.swf?v=5"},getAddToCart:function(){return e.config.baseUrl+"/Cart/Add/"+i},getFlashInstaller:function(){return e.config.baseUrl+"/Content/flash/reader/expressInstall.swf"}},request:function(t){t.url=(t.url.match("^//|http")?"":e.config.baseUrl)+t.url;var n=t.data||{};n.embed=e.sandbox.reader.get("embed"),!e.sandbox.reader.get("token")||(n.token=window.decodeURIComponent(e.sandbox.reader.get("token")));var r={type:t.type||"GET",url:t.url,data:n,success:function(e){t.success&&t.success(e)},error:function(e){t.error&&t.error(e)}};return t.jsonp&&(r.dataType="jsonp",r.jsonp="jsoncallback"),$.ajax(r)},canSearch:function(){var t=$.Deferred();return e.core.util.request({url:"/BookReader/CanSearch",type:"POST",data:{productId:i,documentId:s},success:function(e){t.resolve(e)},error:function(e){t.resolve({canSearch:!1})}}),t.promise()},getCSS:function(t){if(!e.config.cssLoaded){e.config.cssLoaded=!0;var n=e.config.baseUrl+"/BookReader/DocumentCss/"+s;t&&(n+="?version="+t),$.getCSS(n)}},getFont:function(t){if(!e.config.fontLoaded&&e.sandbox.reader.get("html").loadFont){e.config.fontLoaded=!0;var n="ttf";if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){var r=navigator.userAgent.match(/OS ([\d_]+)/)[1],i=window.parseInt(r.split("_")[0])>=5;n=i?"ttf":"svg"}else navigator.userAgent.match(/MSI/i)&&(n="eot");var o=e.config.baseUrl+"/BookReader/FontCss/"+s+"?ft="+n;t&&(o+="&version="+t),$.getCSS(o)}},print:function(e){console.warn("["+e.index+"] : "+e.msg)},createShadowImage:function(e){var t=e%2?"right":"left";return $("<span class='rd-shadow rd-shadow-"+t+"'></span>")},createExtractImage:function(){var t=["fr","de","en","es"],n=(navigator.language?navigator.language:navigator.userLanguage).substring(0,2);return $.inArray(n,t)===-1&&(n="en"),$("<image class='extract'>").attr({src:e.config.baseUrl+"/Content/imgv2/common/extract-strip_"+n+".png"})},checkValidation:function(e){var t=e.validate(),n=t.errorContext.length;n>0&&(t.checkForm(),t.showErrors())},browserType:{isIE:function(){return/MSIE (\d+\.\d+);/.test(navigator.userAgent)||/Trident/.test(navigator.userAgent)},isIE7:function(){return/MSIE (7\.\d+);/.test(navigator.userAgent)},isIE8:function(){return/MSIE (8\.\d+);/.test(navigator.userAgent)},isOpera:function(){return/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)},isFirefox:function(){return/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)},isWebkit:function(){return/WebKit[\/\s](\d+\.\d+)/.test(navigator.userAgent)}}}),n.on("reader.util.print",e.core.util.print)}}),define("extensions/gesture",{initialize:function(e){var t=e.core.mediator,n=e.sandbox,r=require("hammer");e.sandbox.gesture={callbacks:{right:function(e){e.gesture.preventDefault(),n.pages.set("currentIndex",n.pages.getPreviousIndexPage())},left:function(e){e.gesture.preventDefault(),n.pages.set("currentIndex",n.pages.getNextIndexPage())},defaultZoom:function(){n.zoom.set("zoom",1)},zoomLess:function(t){e.sandbox.fullscreen.get("enable")&&t.gesture.preventDefault()},zoomMore:function(t){e.sandbox.fullscreen.get("enable")&&t.gesture.preventDefault()}},connect:function(){var t=e.sandbox.reader.get("$element")[0];if(e.sandbox.util.browserType.isIE8()||e.sandbox.util.browserType.isIE7())return;e.sandbox.reader.get("capacities").html&&delete r.defaults.stop_browser_behavior.userSelect,e.sandbox.viewport.get("display")!=="scroll"&&(r(t).off("swiperight",e.sandbox.gesture.callbacks.right).on("swiperight",e.sandbox.gesture.callbacks.right.bind(this)),r(t).off("swipeleft",e.sandbox.gesture.callbacks.left).on("swipeleft",e.sandbox.gesture.callbacks.left.bind(this))),r(t).off("pinchin",e.sandbox.gesture.callbacks.zoomLess).on("pinchin",e.sandbox.gesture.callbacks.zoomLess.bind(this)),r(t).off("pinchout",e.sandbox.gesture.callbacks.zoomMore).on("pinchout",e.sandbox.gesture.callbacks.zoomMore.bind(this))}},t.on("reader.viewport.ready",e.sandbox.gesture.connect)}}),define("extensions/toolbar",{initialize:function(e){var t=require("backbone"),n=e.core.mediator,r=0,i=!0,s={access:{rendered:!1,width:{small:0,big:0}},fullscreen:{rendered:!1,width:{small:0,big:0}},navigation:{rendered:!1,width:{small:0,big:0}},share:{rendered:!1,width:{small:0,big:0}},zoom:{rendered:!1,width:{small:0,big:0}},embed:{rendered:!1,width:{small:0,big:0}},search:{rendered:!1,width:{small:0,big:0}},display:{rendered:!1,width:{small:0,big:0}},library:{rendered:!1,width:{small:0,big:0}}},o=[{access:"small"},{access:"small",fullscreen:"small"},{access:"small",fullscreen:"small",navigation:"small"},{access:"small",fullscreen:"small",navigation:"small",share:"small"},{access:"small",fullscreen:"small",navigation:"small",share:"small",embed:"small"},{access:"small",fullscreen:"small",navigation:"small",share:"small",embed:"small",search:"small"},{access:"big",fullscreen:"small",navigation:"small",share:"small",embed:"small",search:"small"},{access:"big",fullscreen:"small",navigation:"small",share:"big",embed:"small",search:"small"},{access:"big",fullscreen:"small",navigation:"big",share:"big",embed:"small",search:"small"},{access:"big",fullscreen:"small",navigation:"big",share:"big",embed:"small",search:"small",display:"small"},{access:"big",fullscreen:"small",navigation:"big",share:"big",embed:"small",library:"small",search:"small",display:"small"},{access:"big",fullscreen:"small",navigation:"big",share:"big",embed:"small",library:"small",search:"small",display:"small",zoom:"small"},{access:"big",fullscreen:"big",navigation:"big",share:"big",embed:"small",library:"small",search:"small",display:"small",zoom:"small"},{access:"big",fullscreen:"big",navigation:"big",share:"big",embed:"big",library:"small",search:"small",display:"small",zoom:"small"},{access:"big",fullscreen:"small",navigation:"big",share:"big",embed:"big",library:"small",search:"small",display:"big",zoom:"small"},{access:"big",fullscreen:"small",navigation:"big",share:"big",embed:"big",library:"big",search:"small",display:"big",zoom:"small"},{access:"big",fullscreen:"big",navigation:"big",share:"big",embed:"big",library:"big",search:"small",display:"big",zoom:"small"}],u=t.Model.extend({defaults:{height:0,top:0,fixed:!1},initialize:function(e){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"itemRendered"),this.on("change:height",function(){n.emit("reader.toolbar.height.changed",this.get("height"))}),this.on("change:fixed",function(){n.emit("reader.toolbar.fixed.changed",this.get("fixed"))})},itemRendered:function(e,t,n){i=!0,s[e]?(n||(n={},n.small=t?t.addClass("ys_98567_small").outerWidth(!0):0,n.big=t?t.removeClass("ys_98567_small").addClass("ys_98567_big").outerWidth(!0):0),this._addItemRendered(e,n.small,n.big),this._allItemsRendered()&&this.updateContent()):e==="logo"&&(r=n.width+10)},setSize:function(e,t){t.removeClass("ys_98567_small ys_98567_big"),e==="hide"?t[0].style.display="none":(t[0].style.display="",t.addClass(e==="big"?"ys_98567_big":"ys_98567_small"))},updateContent:function(){var t=e.sandbox.reader.get("width"),n={hide:[]};e.sandbox.reader.get("embed")&&(n.hide.push("display","search","library"),e.sandbox.reader.get("isPublic")===!1&&(n.hide.push("embed"),n.hide.push("share"))),e.sandbox.fullscreen.get("enable")&&n.hide.push("display"),e.sandbox.reader.get("canSearch")===!1&&n.hide.push("search");var r=this._getBestRule(t,n);this._setBestToolbar(r,n)},_getBestRule:function(e,t){var n=e,i=0,u=function(e,r){_.contains(t.hide,r)===!1&&(n+=s[r].width[e])};for(var a=o.length-1;e<=n+r&&a>=0;a--)n=0,i=a,_.each(o[i],u);return i},_addItemRendered:function(e,t,n){s[e].rendered=!0,s[e].width.small=t,s[e].width.big=n},_allItemsRendered:function(){var e=_.contains(_.pluck(s,"rendered"),!1);return!e},_setBestToolbar:function(t,r){var u=e.sandbox.emit;_.each(s,function(e,s){var u={setVisibility:i,type:o[t][s]&&_.contains(r.hide,s)===!1?o[t][s]:"hide"};n.emit("reader.toolbar."+s+".changeSize",u)}),i=!1}}),a=new u;e.sandbox.toolbar=a}}),define("extensions/loop",{initialize:function(e){var t=require("backbone"),n=t.Model.extend({defaults:{loopId:null,callbackFrameList:[],callbackTimeList:[]},initialize:function(){this.constructor.__super__.initialize.apply(this)},_startLoopFrame:function(){var e=this.get("callbackFrameList");_.each(e,function(e){e.callback()}),this.set("loopId",requestAnimationFrame(this._startLoopFrame.bind(this)))},_startLoopWithTime:function(){var e=this.get("callbackTimeList");_.each(e,function(t,n){var r=window.setInterval(function(){t.callback()},t.time);e[n].timer=r}),this.set("callbackTimeList",e)},_stopLoop:function(){this.get("loopId")&&(window.cancelAnimationFrame(this.get("loopId")),this.set("loopId",null));var e=this.get("callbackTimeList");_.each(e,function(t,n){t.timer&&(window.clearInterval(t.timer),delete e[n].timer)}),this.set("callbackTimeList",e)},_addCallback:function(e,t,n){if(n){var r=this.get("callbackTimeList");r.push({type:e,callback:t,time:n}),this.set("callbackTimeList",r)}else{var i=this.get("callbackFrameList");i.push({type:e,callback:t}),this.set("callbackFrameList",i)}},_removeCallback:function(e,t){var n=this.get(e),r=_.filter(n,function(e){return(typeof t=="string"?e.type:e.callback)!==t});this.set(e,r)},add:function(e,t,n){return this._addCallback(e,t,n),this},remove:function(e){return this._removeCallback("callbackFrameList",e),this._removeCallback("callbackTimeList",e),this},start:function(){return this._startLoopFrame(),this._startLoopWithTime(),this},stop:function(){return this._stopLoop(),this}}),r=new n;e.sandbox.loop=r}}),define("extensions/binders",{initialize:function(e){function t(){var e={};return{order:{first:-1,last:1},get:function(t){return e[t]},create:function(t){e[t]=new s},remove:function(t){e[t]=null}}}var n=require("backbone"),r=n.Model.extend({defaults:{order:0,callback:null}}),i=n.Collection.extend({model:r,initialize:function(){this.comparator="order"}}),s=n.Model.extend({defaults:{before:null,through:null,after:null},initialize:function(e){this.set("before",new i),this.set("through",new i),this.set("after",new i)},add:function(e,t,n){if(_.contains(this.keys(),e)===!1)return;var i={callback:t};n&&(i.order=n),this.get(e).add(new r(i))},remove:function(e,t){if(_.contains(this.keys(),e)===!1)return;var n=this.get(e).where({callback:t})[0];n&&this.get(e).remove(n)},call:function(e,t){if(_.contains(this.keys(),e)===!1)return;var n=this.get(e).pluck("callback");for(var r=0;r<n.length;r++)n[r](t)}});e.sandbox.binders=new t}}),define("nls/text",{root:{na:"NA",buy:"Buy for",download:"Download",addToCartUrl:"Add to cart","double":"Double",displayDouble:"Double display",scroll:"Scroll",displayScroll:"Scroll display",displaySlide:"Slide display",integrate:"Embed",fullscreen:"Full Screen",previousPage:"previous page",afterPage:"next page",share:"Share",pages:"pages",zoomMore:"Zoom +",zoomLess:"Zoom -",close:"Close",searchIntoTheDocument:"Search into the document",fullscreenMode:"Full Screen Mode",addToMyLibrary:"Add to my library",goToYouscribe:"Read it on YouScribe",toAccessNeedMoreInformation:"You need to fill some information below ",toAccessNeedMoreInformation2:"to fully access this document.",description:"Description",checkEmailBeforeAccessDocument:"Your email address will be checked before we send you the document access",validateAndShowDocument:"Access the document",waitForValidation:"Email validation in progress",waitValidationMessage:"To access the document you need to validate your e-mail adress by clicking on the link available in the e-mail that we sent",acceptCondition:"When accessing this document, I accept YouScribe's <a href='http://en.youscribe.com/Static?name=cgu' style='text-decoration:underline' target='_blank'>Terms of Service</a>",loadingSearch:"Loading results",previous:"Previous",next:"Next",results:"result(s)",resultOf:"result of",historic:"Historic",twitter:"Tweeter",shareOnFacebook:"Share on Facebook","googleLike+":"+1 Google+",sendByEmail:"Send by email",integrateDocumentToWebsite:"Embed this document to your site",displayMode:"Display mode",flexWidthAndHeight:"Flexible width and height",width:"Width",and:"and",height:"height",startPage:"Start reading at page",copyAndPaste:"Copy and paste this code on your site",preview:"preview",errorLogin:"Authentication error",errorCapacities:"The document is under process",extractQuestion:"Do you enjoyed this extract ?",extractMessage:"Access all of this book and thousands of other works by subscribing to YouScribe !",moreInfo:"More information",startTry:"Start your free trial"},fr:!0,en:!0,es:!0}),define("extensions/reader",["i18n!nls/text"],function(e){return{initialize:function(t){var n="9.0.45",r=require("backbone"),i=t.core.mediator,s=r.Model.extend({defaults:{$element:null,Publica:!1,flexible:!1,height:0,canSearch:!1,windowResized:!1,offset:{top:0,left:0}},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"_checkWindowResize","_start","_manageInfo","updateOffsetPositions"),this.on("change:width",function(){this.updateOffsetPositions(),i.emit("reader.resized",this.get("width"))}),i.on("reader.rights.changed",this._start),this._bindWindowResize()},updateOffsetPositions:function(){var e=this.get("$element").offset();this.set({offset:{top:e.top,left:e.left}})},getInfo:function(){var e=this._manageInfo;t.core.util.request({url:"/BookReader/info",data:{productId:this.get("productId"),documentId:this.get("documentId")},jsonp:!0,success:function(t){e(t)},error:function(e){e.statusText!=="abort"&&console.warn(e.statusText)}})},_bindWindowResize:function(){t.core.util.browserType.isIE8()?document.body.onresize=$.proxy(function(){this.set("windowResized",!0)},this):$(window).resize($.proxy(function(){this.set("windowResized",!0)},this)),t.sandbox.loop.add("reader",this._checkWindowResize)},_checkWindowResize:function(){this.get("windowResized")&&(this.set("windowResized",!1),i.emit("window.resized"))},_manageInfo:function(t){this._setTotalPage(t.nbPages),this._setTotalRatio(t.pagesRatio),this._setLeadSharing(t),this._checkCapacities(t.capacities),this.get("capacities").toString()||(t.message=e.errorCapacities,t.status="errorCapacities"),t=_.omit(t,"capacities","nbPages","leadSharing"),this.set(t,{silent:!0}),this._start()},_setLeadSharing:function(e){e.rights.reading&&(e.leadSharing.enable=!1),t.sandbox.leadSharing.set(e.leadSharing)},_setTotalPage:function(e){var n=parseInt(e,10);n?t.sandbox.pages.set("nbTotal",n):t.sandbox.pages.set("nbTotal","NC")},_setTotalRatio:function(e){var n=620,r=_.reduce(e,function(e,t){return e+n/t},0);t.sandbox.pages.set("totalRatio",n/r)},_setCapacities:function(e){var t={flash:!1,image:!1,html:!1};e==="flash"&&(t.flash=!0),e==="html"&&(t.html=!0),e==="image"&&(t.image=!0),t.toString=function(){return e},this.set("capacities",t)},_checkCapacities:function(e){e&&e.flash&&swfobject.hasFlashPlayerVersion(n)?this._setCapacities("flash"):e&&e.html?this._setCapacities("html"):e&&e.image?this._setCapacities("image"):this._setCapacities(null)},_checkCover:function(){return this.get("allowStreaming")===!1&&this.get("cover")?(this._setCapacities("image"),!0):!1},_checkPreviewPages:function(e){var t=this.get("previewPages");if(this.get("rights").reading===!1&&t.length>0){var n=_.filter(t,function(t){return t>=0&&t<e});return this.set("previewPages",n),n.length}return this.set("previewPages",[]),e},_getStatusMessage:function(){var e=this.get("status"),t={};return t.toolbarDisplay=e!=="errorCapacities"&&e!=="NotFound"&&e!=="NotAuthorized",t.messageDisplay=e!=="Available"&&e!=="HtmlOwner",t.viewportDisplay=e!=="errorCapacities"&&e!=="NotFound"&&e!=="NotAuthorized"&&e!=="StreamingUnavailable",t},_start:function(){var e=t.sandbox.pages.get("nbTotal");e==="NC"&&(e=1),this._checkCover()&&(e=1,this.set("message",""),this.set("status","Available")),this.get("capacities").html&&(t.sandbox.util.getCSS(this.get("streamingVersion")),t.sandbox.util.getFont(this.get("streamingVersion"))),e=this._checkPreviewPages(e);var n=this._getStatusMessage();t.sandbox.pages.create(e),i.emit("reader.render",_.extend(this.get(),n))}}),o=_.omit(t.config.reader,"fullscreen","display","currentPage");window.Publica&&(o.Publica=!0);var u=new s(o);t.sandbox.reader=u}}}),define("extensions/search",{initialize:function(e){var t=e.core.mediator,n=require("backbone"),r=n.Model.extend({defaults:{enable:!1,page:0,attached:!1,$element:null,topPourcent:0},destroy:function(){this.get("$element").remove()}}),i=n.Collection.extend({model:r,initialize:function(){this.on("change:enable",function(n){if(n.get("enable")){var r=_.each(this.reject(function(e){return e===n}),function(e){e.set("enable",!1),e.get("$element").css("background-color","yellow")});n.get("$element").css("background-color","#CC8B66"),e.sandbox.pages.set("currentIndex",n.get("page")-1),t.emit("reader.search.currentHighLight.changed",this.indexOf(n)+1)}})},parse:function(e){return e.found.length===0?e.found:(_.each(e.found,function(e,t){var n=(e.top-(e.bottom-e.top))/100,r=e.left/100,i=$('<div class="searchItem">').css({position:"absolute",height:(e.bottom-e.top)/100+"%",width:(e.right-e.left)/100+"%",top:n+"%",left:r+"%","background-color":"yellow",opacity:.6}).attr("data-index",t);e.$element=i}),e.found)}}),s=n.Model.extend({defaults:{word:null,highlights:null,currentHighlightIndex:null},initialize:function(t,n){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"setBestHighLightFromCurrentPage","_detachHighlights"),this.on("change:currentHighlightIndex",function(){if(this.get("currentHighlightIndex")===null)this._detachHighlights();else{var e=this.get("highlights").at(this.get("currentHighlightIndex"));e.get("enable")?e.trigger("change:enable",e):e.set("enable",!0)}}),this.set("highlights",new i),this.get("highlights").fetch({url:"/BookReader/Search",data:{productId:e.sandbox.reader.get("productId"),documentId:e.sandbox.reader.get("documentId"),q:this.get("word")},jsonp:!0,success:_.bind(n.addCb,this,this)})},setBestHighLightFromCurrentPage:function(){if(this.get("highlights").length===0)return;var t=this.get("highlights").min(function(t){return Math.abs(e.sandbox.pages.get("currentIndex")-(t.get("page")-1))});t.set("enable",!0)},_detachHighlights:function(){this.get("highlights").length&&_.each(this.get("highlights").pluck("$element"),function(e){e.detach()})}}),o=n.Model.extend({defaults:{searches:[],current:null},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"fetch","goTo","_addNewSeach","goToPrev","goToNext"),this.on("change:searches",function(){this.get("searches").length>3&&this._removeLastSearch(),this.set("current",_.last(this.get("searches")))}),this.on("change:current",function(){var e=this.get("current"),n=this.previous("current");n&&n.set("currentHighlightIndex",null);if(e){this._createHighLights(),e.setBestHighLightFromCurrentPage();var r=e.get("highlights"),i=r.invoke("toJSON"),s=r.indexOf(r.findWhere({enable:!0})),o={word:e.get("word"),current:s,total:r.length,history:_.map(this.get("searches"),function(e){return e.get("word")}).reverse(),found:i};t.emit("reader.search.found",o),r.length>0&&e.set("currentHighlightIndex",s,{force:!0})}})},add:function(e){var t=_.find(this.get("searches"),function(t){return t.get("word")===e});t?this.set("current",t,{force:!0}):new s({word:e},{addCb:this._addNewSeach})},getHistory:function(){return _.map(this.get("searches"),function(e){return e.get("word")}).reverse()},goToPrev:function(e){this.goTo(this.get("current").get("currentHighlightIndex")-parseInt(e,10))},goToNext:function(e){this.goTo(this.get("current").get("currentHighlightIndex")+parseInt(e,10))},goTo:function(e){var t=this.get("current").get("highlights").length-1,n=e<0?0:e>t?t:e;this.get("current").set("currentHighlightIndex",n)},getHighLight:function(e){if(this.get("current")){var t=this.get("current").get("highlights").filter(function(t){return t.get("page")-1===e});if(t.length>0)return t}return null},_addNewSeach:function(e){var t=_.clone(this.get("searches"));t.push(e),this.set("searches",t)},_removeLastSearch:function(){var e=_.first(this.get("searches")),t=e.get("highlights");_.invoke(t.toArray(),"destroy"),this.set("searches",_.without(this.get("searches"),e))},_createHighLights:function(){var t=this.get("current").get("highlights");for(var n=t.length-1;n>=0;n--){var r=e.sandbox.pages.at(t.at(n).get("page")-1).get("$element");r!==null&&r.append(t.at(n).get("$element"))}}}),u=new o;e.sandbox.search=u}}),define("extensions/keys",{initialize:function(e){var t=e.core.mediator,n=require("backbone"),r=n.Model.extend({defaults:{enable:!0},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"checkkey"),e.config.reader.embed===!0&&e.config.reader.fullscreen===!1&&this.set("enable",!1),$(document).keydown(this.checkkey)},checkkey:function(n){n.keyCode===27&&(n.preventDefault(),e.sandbox.popin.get("display")?t.emit("reader.popin.close"):e.sandbox.fullscreen.get("enable")&&t.emit("reader.fullscreen.clicked"));if(n.target.tagName==="INPUT"||n.target.tagName==="TEXTAREA"||this.get("enable")===!1)return;switch(n.keyCode){case 32:n.preventDefault(),e.sandbox.pages.set("currentIndex",e.sandbox.pages.getNextIndexPage());break;case 39:n.preventDefault(),e.sandbox.popin.get("display")&&e.sandbox.popin.get("currentType")==="search"?e.sandbox.search.goToNext(1):e.sandbox.pages.set("currentIndex",e.sandbox.pages.getNextIndexPage());break;case 37:n.preventDefault(),e.sandbox.popin.get("display")&&e.sandbox.popin.get("currentType")==="search"?e.sandbox.search.goToPrev(1):e.sandbox.pages.set("currentIndex",e.sandbox.pages.getPreviousIndexPage());break;case 36:n.preventDefault(),e.sandbox.pages.set("currentIndex",0);break;case 35:n.preventDefault(),e.sandbox.pages.set("currentIndex",e.sandbox.pages.length()-1);break;case 107:n.preventDefault(),e.sandbox.zoom.set("zoom",e.sandbox.zoom.getNextZoom());break;case 109:n.preventDefault(),e.sandbox.zoom.set("zoom",e.sandbox.zoom.getPreviousZoom());break;default:}}}),i=new r;e.sandbox.keys=i}}),define("extensions/zoom",{initialize:function(e){var t=e.core.mediator,n=require("backbone"),r=n.Model.extend({defaults:{zoom:null,minZoom:.1,maxZoom:1,unit:.1,beforeFS:null},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"updateAfterFullscreen"),this.on("change:zoom",function(){var t=this.get("zoom");e.sandbox.binders.get("zoom").call("through",t),e.sandbox.binders.get("zoom").call("after",t)}),e.sandbox.binders.create("zoom")},updateAfterFullscreen:function(e,t){var n=this._getZoomValues(t);if(e){var r=this._getDefaultFullScreenZoomValues(t);this.set({beforeFS:this.get("zoom")||n,zoom:r.zoom})}else this.set("zoom",this.get("beforeFS")||n,{force:!0})},_getZoomValues:function(e){var t=1024,n=parseFloat((t/e).toFixed(1));return n>1?1:n},setAttribute:function(e,t,r){if(e==="zoom"){t=this._checkZoom(t);if(t===null)return}n.Model.prototype.setAttribute.call(this,e,t,r)},getPreviousZoom:function(){var e=parseFloat((this.get("zoom")-this.get("unit")).toFixed(1));return e<this.get("minZoom")?this.get("minZoom"):e},getNextZoom:function(){var e=parseFloat((this.get("zoom")+this.get("unit")).toFixed(1));return e>this.get("maxZoom")?this.get("maxZoom"):e},_checkZoom:function(t){return t==="-"?t=this.getPreviousZoom():t==="+"&&(t=this.getNextZoom()),t!==this.get("zoom")&&e.sandbox.binders.get("zoom").call("before",t),t},_getDefaultFullScreenZoomValues:function(t){var n=this.get(),r=e.sandbox.fullscreen.get(),i={zoom:r.viewportZoomDefault};return e.sandbox.viewport.get("display")!=="double"&&r.viewportMaxWidth<t&&(i.zoom=window.parseFloat((r.viewportMaxWidth/t).toFixed(1))),this._fitFirstPageIntoViewport(i,t),i},_fitFirstPageIntoViewport:function(t,n){var r=e.sandbox.viewport.get("display");if(r==="scroll")return null;var i=e.sandbox.pages.at(e.sandbox.pages.get("currentIndex")).get("ratio"),s=null,o=e.sandbox.viewport.get("height");r==="slideshow"&&n/i>o&&(s=o*i),r==="double"&&n/2/i>o&&(s=o*2*i),s&&(t.zoom=Math.floor(s/n*10)/10)}}),i=new r;e.sandbox.zoom=i}}),define("extensions/fullscreen",{initialize:function(e){var t=e.core.mediator,n=require("backbone"),r=n.Model.extend({defaults:{enable:e.config.reader.fullscreen==1,viewportMaxWidth:1400,viewportZoomDefault:.8},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"setFullscreen"),this.on("change:enable",function(){var t=this.get("enable");e.sandbox.binders.get("fullscreen").call("through",t),e.sandbox.binders.get("fullscreen").call("after",t)}),e.sandbox.binders.create("fullscreen"),t.on("reader.fullscreen.clicked",this.setFullscreen)},setFullscreen:function(){var t=!this.get("enable");e.sandbox.reader.get("embed")?this.embedFullscreenChanged(t):(e.sandbox.binders.get("fullscreen").call("before",t),this.set("enable",t))},embedFullscreenChanged:function(t){if(t){var n=e.sandbox.reader.get();n.display=e.sandbox.viewport.get("display"),n.startPage=e.sandbox.pages.get("currentIndex")+1;var r=e.sandbox.util.url.getFullscreen(n);window.open(r,"FullScreen","menubar=no, status=no, width="+(screen.width-10)+", height="+screen.height)}else window.close()}}),i=new r;e.sandbox.fullscreen=i}}),define("extensions/lead-sharing",{initialize:function(e){var t=e.core.mediator,n=require("backbone"),r=n.Model.extend({defaults:{response:null,enable:!1,campagnId:null,display:!1,referer:null},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"_resetDisplay","_sendLeadSharingRender","rightsChanged","waitForValidation"),this.on("change:response",function(){this._sendLeadSharingRender()}),t.on("reader.rights.changed",this.rightsChanged),t.on("reader.viewport.display.changed",this._resetDisplay),t.on("reader.pages.currentIndex.changed",_.bind(this.show,this,"Streaming"))},rightsChanged:function(e){e.reading&&this.set("enable",!1)},waitForValidation:function(e,t){var n=this.waitForValidation;$.ajax({url:"/Premium/LeadSharingProcess/IsEmailInCampaign",data:{id:this.get("campagnId"),email:e},success:function(r){r.result?t():setTimeout(function(){n(e,t)},250)},error:function(){setTimeout(function(){n(e,t)},250)}})},processFormInput:function(e){var t={};e.find("select[id^='ysdate']").each(function(){var e=this.id.split("_"),n=e[2];t[n]=t[n]||{};var r=$(this).val();e[1]==="day"?t[n].day=r:e[1]==="month"?t[n].month=r:e[1]==="year"&&(t[n].year=r)}),$.each(t,function(t,n){if(n.year&&n.year.length>0&&n.month&&n.month.length>0&&n.day&&n.day.length>0){var r=n.year+"-"+n.month+"-"+n.day;e.find("#"+t).val(r)}})},makeRulesAndMessages:function(e,t,n,r){var i={},s={};e.validation.require&&e.validation.require.value&&(i.required=!0,s.required=e.validation.require.message),e.validation.maxLength&&e.validation.maxLength.value&&(i.maxLength=e.validation.maxLength.value,s.maxLength=e.validation.maxLength.message),e.validation.email&&e.validation.email.value&&(i.email=!0,s.email=e.validation.email.message),e.validation.date&&e.validation.date.value&&(i.date=!0,s.date=e.validation.date.message),e.displayType==="date"&&i.required?(n["ysdate_year_"+e.id]={dateRequired:!0},r["ysdate_year_"+e.id]={dateRequired:s.required}):(n["Values["+t+"].Value"]=i,r["Values["+t+"].Value"]=s)},show:function(t){var n=e.sandbox.viewport.get("ready")&&!e.sandbox.reader.get("rights").reading&&e.sandbox.leadSharing.get("enable")&&((e.sandbox.pages.get("currentIndex")===e.sandbox.pages.length()-1||e.sandbox.pages.get("currentIndex")>=e.sandbox.pages.length()-2&&e.sandbox.viewport.get("display")==="double")&&t!=="Download"||t==="Download")&&this.get("display")===!1;n&&(this.set("referer",t),e.sandbox.fullscreen.get("enable")&&e.sandbox.reader.get("embed")===!1&&e.sandbox.emit("reader.fullscreen.clicked"),this._getInfo())},_resetDisplay:function(){this.set("display",!1)},_sendLeadSharingRender:function(){e.sandbox.pages.set("currentIndex",0),this.set("display",!0),t.emit("reader.leadSharing.render",this.get("response"))},_getInfo:function(){var t=this;if(t.get("response")){t._sendLeadSharingRender();return}e.core.util.request({url:"/Premium/LeadSharingProcess/GetCampaignForm",data:{id:this.get("campagnId")},jsonp:!0,success:function(e){t.set("response",e)},error:function(e){e.statusText!=="abort"&&console.warn("response.statusText")}})}}),i=new r;e.sandbox.leadSharing=i}}),define("extensions/viewport",{initialize:function(e){var t=require("backbone"),n=e.core.mediator,r=0,i=t.Model.extend({defaults:{$element:null,display:e.config.reader.display,nbPagesToMove:1,height:null,ready:!1},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"readyChanged","createPages","setDisplay","pageCreatedCounter","subViewportReady","rightsChanged"),this.on("change:display",function(){this.set("ready",!1),n.emit("reader.viewport.display.changed",this.get("display"))}),this.on("change:ready",this.readyChanged),n.on("reader.subViewport.ready",this.subViewportReady),n.on("reader.toolbar.display.clicked",this.setDisplay),n.on("reader.rights.changed",this.rightsChanged)},createPages:function(){r=e.sandbox.pages.length();var t=e.sandbox.viewport[this.get("display")].getPagesTemplate(r);this._addModificationToCreatedPages(t).done(function(e){n.emit("reader.viewport.template.ready",e)})},readyChanged:function(){if(this.get("ready")){var t=e.sandbox.pages.get("currentIndex")||parseInt(e.config.reader.currentPage,10)-1;e.sandbox.pages.set("currentIndex",t,{force:!0}),e.sandbox.loop.start(),n.emit("reader.viewport.ready",this.get("ready"))}else e.sandbox.loop.stop().remove("viewport")},pageCreatedCounter:function(){r-=1,r===0&&(n.off("reader.viewport.pageCreated",this.pageCreatedCounter),n.emit("reader.viewport.pages.ready"))},rightsChanged:function(){this.set("ready",!1)},setDisplay:function(e){this.set("display",e)},subViewportReady:function(){var t=e.sandbox.fullscreen.get("enable");e.sandbox.fullscreen.set("enable",t,{force:!0}),this.set("ready",!0)},_addModificationToCreatedPages:function(e){var t=n.listeners("reader.viewport.template.pages.ready").length,r=$.Deferred();n.on("reader.viewport.pageCreated",this.pageCreatedCounter);if(t===0)r.resolve(e);else{var i=function s(i){t-=1,e=i,t===0&&(n.off("reader.viewport.template.modification",s),r.resolve(e))};n.on("reader.viewport.template.modification",i),n.emit("reader.viewport.template.pages.ready",e)}return r.promise()}}),s=new i;e.sandbox.viewport=s}}),define("extensions/viewport-scroll",{initialize:function(e){var t=require("backbone"),n=e.core.mediator,r=$(window),i=!1,s=t.Model.extend({defaults:{marginTopPage:10,loadingPagesNumberRef:3,scrollEnable:!1,previousScrollTop:null,pagesDisplayedIntoTheWindow:{first:0,last:0,middle:null},direction:"down",defaultAnimationDuration:1e3,scrollTop:0,scrollLeft:null,didIScroll:!1},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"getPagesTemplate","pageChanged","checkContent","reset","scrollerScrolled","checkScroll"),this.on("change:scrollLeft",function(){n.emit("reader.viewport.scroll",{top:this.get("scrollTop"),left:this.get("scrollLeft"),type:"left"})}),this.on("change:scrollTop",function(){var t=this.get("scrollTop"),r=this.previous("scrollTop");t<r?this.set("direction","up"):t>r&&this.set("direction","down");if(this.get("scrollEnable")){var i=this.get("pagesDisplayedIntoTheWindow").middle;this._setPagesDisplayedIntoTheWindow(t);var s=this.get("pagesDisplayedIntoTheWindow").middle;i!==s&&e.sandbox.pages.set("currentIndex",s)}n.emit("reader.viewport.scroll",{type:"top",top:t,left:this.get("scrollLeft")})})},getPagesTemplate:function(t){var n=[];for(var r=0;r<t;r++){var i=100/e.sandbox.pages.at(r).get("ratio"),s="<div class='rd-viewport-page loadingBG' data-aura-component='viewport-page' data-aura-page-index='"+r+"' style='position:relative;height:0;overflow:hidden;background-color:white;padding-bottom:"+i+"%'></div>";n.push(s)}return n},pageChanged:function(t){var r=e.sandbox.pages.indexOf(t);if(this.get("pagesDisplayedIntoTheWindow").middle===null&&r===0&&this.get("scrollEnable"))return;if(r===this.get("pagesDisplayedIntoTheWindow").middle&&this.get("scrollEnable")===!0)return;this.set("scrollEnable",!1);var i=t.get("$element").outerHeight(),s=e.sandbox.util.getWindowHeight(),o=Math.ceil(t.get("$element").position().top+this.get("marginTopPage"));if(i<s){o=t.get("$element").position().top;var u=o+i/2;o=u-s/2+e.sandbox.toolbar.get("height")}var a={top:o,duration:this.get("defaultAnimationDuration")};e.sandbox.fullscreen.get("enable")===!1&&(a.top+=e.sandbox.reader.get("offset").top),r===0&&(a.top=0),n.emit("reader.viewport.scroll.animate",a)},checkContent:function(){if(!this.get("scrollEnable"))return;var t=o.get("scrollTop"),n=o.get("previousScrollTop");n!==t&&(i=!0),Math.abs(n-t)<200&&i===!0&&(e.sandbox.content.load(o.get("pagesDisplayedIntoTheWindow").first,o.get("pagesDisplayedIntoTheWindow").last,o.get("loadingPagesNumberRef")),i=!1),o.set("previousScrollTop",o.get("scrollTop"))},scrollerScrolled:function(){this.set("didIScroll",!0)},checkScroll:function(){this.get("didIScroll")&&(this.set("didIScroll",!1),n.emit("reader.viewport.scroll.scrollerScrolled"))},_searchPageUp:function(t,n,r){if(t<=0)return 0;while(t>0){var i=e.sandbox.pages.at(t).get("$element").position().top+r;if(i<n)return t;t--}return t},_searchPageDown:function(t,n,r,i){if(t>n)return n;while(t<=n){var s=t===0?0:i;s+=e.sandbox.pages.at(t).get("$element").position().top;if(s>r)return t-1<0?0:t-1;t++}return n},_setPagesDisplayedIntoTheWindow:function(t){var n=e.sandbox.util.getWindowHeight(),r=e.sandbox.pages.length()-1,i=this.get("pagesDisplayedIntoTheWindow");e.sandbox.fullscreen.get("enable")===!1&&(t-=e.sandbox.reader.get("offset").top,t>0?(t+=e.sandbox.toolbar.get("height"),n-=e.sandbox.toolbar.get("height")):t-=e.sandbox.toolbar.get("height")),i.first=this.get("direction")==="up"?this._searchPageUp(i.first,t,0):this._searchPageDown(i.first,r,t,0),i.last=this._searchPageDown(i.first,r,n+t,10),i.middle=this._searchPageDown(i.first,r,n/2+t,10),this.set("pagesDisplayedIntoTheWindow",i)}}),o=new s;e.sandbox.viewport.scroll=o}}),define("extensions/viewport-slideshow",{initialize:function(e){var t=require("backbone"),n=e.core.mediator,r=t.Model.extend({defaults:{indexPageDisplayed:0,pageNumberToLoad:2},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"getPagesTemplate","pageChanged","reset"),this.on("change:indexPageDisplayed",function(){if(!e.sandbox.viewport.get("ready"))return;this.previous("indexPageDisplayed")!==undefined&&e.sandbox.pages.at(this.previous("indexPageDisplayed")).get("$element").css("position","absolute"),e.sandbox.pages.at(this.get("indexPageDisplayed")).get("$element").css("position","relative"),e.sandbox.content.load(this.get("indexPageDisplayed"),this.get("indexPageDisplayed"),this.get("pageNumberToLoad"))})},getPagesTemplate:function(t){var n=[];for(var r=0;r<t;r++){var i=100/e.sandbox.pages.at(r).get("ratio"),s="<div class='rd-viewport-page loadingBG' data-aura-component='viewport-page' data-aura-page-index='"+r+"' style='position:absolute;overflow:hidden;background-color:white;padding-bottom:"+i+"%'></div>";n.push(s)}return n},pageChanged:function(t){this.set("indexPageDisplayed",e.sandbox.pages.indexOf(t),{force:!0})},startArrows:function(){e.core.appSandbox.start([{name:"arrow",options:{el:".str-left.rd-arrow",direction:"prev"}},{name:"arrow",options:{el:".str-right.rd-arrow",direction:"next"}}])}}),i=new r;e.sandbox.viewport.slideshow=i}}),define("extensions/viewport-double",{initialize:function(e){var t=require("backbone"),n=e.core.mediator,r=t.Model.extend({defaults:{isTurning:!1},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"getPagesTemplate","reset")},getPagesTemplate:function(e){var t=[];for(var n=0;n<e;n++){var r=n<2||n>=e-2?"hard":"",i="<div class='rd-viewport-page "+r+" loadingBG' data-aura-component='viewport-page' data-aura-page-index='"+n+"' style='background-color:white'></div>";t.push(i)}return t}}),i=new r;e.sandbox.viewport.double=i}}),define("extensions/pages",{initialize:function(e){var t={notLoaded:0,loading:1,loaded:2,error:3,preLoaded:4},n=e.core.mediator,r=require("backbone"),i=r.Model.extend({defaults:{state:t.notLoaded,current:!1,$element:null,$content:null,zindex:0,previewImage:!1,scaled:!1,display:!1}}),s=r.Collection.extend({model:i,initialize:function(){this.on("change:top",function(e){n.emit("reader.pages.top.changed",{index:this.indexOf(e),top:e.get("top")})}),this.on("change:zindex",function(e){n.emit("reader.pages.zindex.changed",{index:this.indexOf(e),zindex:e.get("zindex")})}),this.on("change:height",function(e){var t=e.get("height")-e.previous("height");n.emit("reader.pages.height.changed",{index:this.indexOf(e),diff:t,height:e.get("height")})}),this.on("change:display",function(e){var t=e.get("$content");if(t===null)return;e.get("display")?t.show():t.hide()}),this.on("change:ratio",function(t){if(e.sandbox.viewport.get("ready")===!1)return;var n=this.getBestRatio();if(n!==this.bestRatio){var r=100/(100*n)*100,i=this.filter(function(t){return t.get("state")!==e.sandbox.pages.STATES.loaded});_.each(i,function(t){t.set("ratio",n,{silent:!0}),e.sandbox.viewport.get("display")!=="double"&&t.get("$element").css("padding-bottom",r+"%")}),e.sandbox.reader.set("ratio",n),this.bestRatio=n}}),this.on("change:width",function(e){var t=e.get("width")-e.previous("width"),r=e.get("ratio");e.set("height",Math.round(e.get("width")/r)),n.emit("reader.pages.width.changed",{index:this.indexOf(e),diff:t,width:e.get("width")})})},getBestRatio:function(){var t=this.groupBy(function(t){return t.get("state")===e.sandbox.pages.STATES.loaded?t.get("ratio"):0}),n=null;return _.each(t,function(e,t){var r=window.parseFloat(t,10);r!==0&&(n===null||n!==null&&n.nb<e.length)&&(n={ratio:t,nb:e.length})}),parseFloat(n?n.ratio:t[0].ratio,10)}}),o=r.Model.extend({defaults:{totalRatio:0,pages:null,currentIndex:0,nbTotal:1,firstPageIndexDisplayed:0,lastPageIndexDisplayed:0},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"preloadLoadedPages","checkCurrentIndex","getNextIndexPage","getPreviousIndexPage"),this.on("change:currentIndex",function(){n.emit("reader.pages.currentIndex.changed",this.get("pages").at(this.get("currentIndex")))})},checkCurrentIndex:function(e){var t=u.get("currentIndex");return e==="+"?e=this.getNextIndexPage():e==="-"?e=this.getPreviousIndexPage():e=parseInt(e,10),_.isNaN(e)?t:e<0?0:e>this.get("pages").length-1?this.get("pages").length-1:e},getNextIndexPage:function(){var t=u.get("currentIndex"),n=e.sandbox.viewport.get("nbPagesToMove");return t+n>this.get("pages").length-1?this.get("pages").length-1:t+n},getPreviousIndexPage:function(){var t=u.get("currentIndex"),n=e.sandbox.viewport.get("nbPagesToMove");return t-n<0?0:t-n},preloadLoadedPages:function(){var t=this.get("pages");t.each(function(t){var n=t.get("state");n===e.sandbox.pages.STATES.loaded&&t.set("state",e.sandbox.pages.STATES.preLoaded),n===e.sandbox.pages.STATES.loading&&(t.get("$content")?t.set("state",e.sandbox.pages.STATES.preLoaded):t.set("state",e.sandbox.pages.STATES.notLoaded))})},length:function(){return this.get("pages").length},indexOf:function(e){return this.get("pages").indexOf(e)},at:function(e){return e==="*"?this.get("pages"):this.get("pages").at(e)},setAttribute:function(e,t,n){e==="currentIndex"&&(t=u.checkCurrentIndex(t)),r.Model.prototype.setAttribute.apply(u,arguments)},create:function(t){var n=this.get("pages");n&&n.length>0&&n.reset();var r=[],o=e.sandbox.reader.get("pagesRatio")||[],u=e.sandbox.reader.get("ratio"),a=e.sandbox.reader.get("previewPages");t=a.length||t;for(var f=0;f<t;f++){var l=a[f]+1||f+1,c=new i({ratio:f<o.length?o[l-1]:u,number:l});r.push(c)}return this.set("pages",new s(r)),this},setDisplay:function(e,t){var n=this.get("firstPageIndexDisplayed"),r=this.get("lastPageIndexDisplayed"),i=this.get("pages"),s;if(n!==null){for(s=n;s<=r&&s<e;s++)i.at(s).set("display",!1);for(s=r;s>=n&&s>t;s--)i.at(s).set("display",!1)}for(s=e;s<=t;s++)i.at(s).set("display",!0);this.set("firstPageIndexDisplayed",e),this.set("lastPageIndexDisplayed",t)}}),u=new o;n.on("reader.viewport.display.changed",u.preloadLoadedPages),e.sandbox.pages=u,e.sandbox.pages.STATES=t}}),define("extensions/interpages",{initialize:function(e){var t=e.core.mediator,n=[];e.sandbox.interpages={createInterPagesTemplate:function(n){var r=function(r){var i=e.sandbox.interpages._parseInterPages(r,n);t.emit("reader.viewport.template.modification",i)};e.sandbox.viewport.get("display")==="scroll"?e.sandbox.interpages._getFromServer(r):t.emit("reader.viewport.template.modification",n)},_getFromServer:function(t){if(n.length>0){t(n);return}var r=e.sandbox.reader.get("productId","documentId");e.core.util.request({url:"/BookReader/InterPage",data:{productId:r.productId,documentId:r.documentId},jsonp:!0,success:function(e){n=e,t(n)},error:function(e){e.statusText!=="abort"&&console.warn(e.statusText)}})},_parseInterPages:function(t,n){var r=0,i={},s=e.sandbox.pages.length();return _.each(t,function(e){_.each(e.pages,function(t){if(t<0)return;var n='<div class="interpage">'+e.data+"</div>";i[t]=n})}),_.each(i,function(e,t){var i=parseInt(t,10)+r;i<s+r&&(n.splice(i,0,e),r++)}),n}},t.on("reader.viewport.template.pages.ready",e.sandbox.interpages.createInterPagesTemplate)}}),define("extensions/extract",{initialize:function(e){var t=e.core.mediator;e.sandbox.extract={createExtractMessageTemplate:function(n){var r=e.sandbox.viewport.get("display")==="scroll"&&e.sandbox.reader.get("rights").reading===!1&&!e.sandbox.reader.get("cover")&&e.sandbox.leadSharing.get("enable")===!1;if(r){var i='<div data-aura-component="extract-message"></div>';n.push(i),t.emit("reader.viewport.template.modification",n)}else t.emit("reader.viewport.template.modification",n)}},t.on("reader.viewport.template.pages.ready",e.sandbox.extract.createExtractMessageTemplate)}}),define("extensions/content",{initialize:function(e){var t=e.core.mediator;e.sandbox.content={load:function(t,n,r){if(e.sandbox.viewport.get("ready")===!1)return;var i=this._getFirstAndLastPages.apply(this,arguments);e.sandbox.pages.setDisplay(i.first,i.last);for(var s=t;s<=n;s++)this._loadContent(s);for(s=i.first;s<t;s++)this._loadContent(s);for(s=n+1;s<=i.last;s++)this._loadContent(s)},setContent:function(t,n){e.sandbox.content[e.sandbox.reader.get("capacities").toString()]._setContent(t,n)},loaded:function(t){var n=e.sandbox.pages.at(t.index),r=t.content||t;e.sandbox.content[e.sandbox.reader.get("capacities").toString()]._loaded(n,r)},scale:function(t,n){if(e.sandbox.viewport.get("ready")===!1)return;var r=e.sandbox.content[e.sandbox.reader.get("capacities").toString()]._scale;if(!r)return;if(arguments.length===1)r(arguments[0]);else{t||(t=0),n||(n=e.sandbox.pages.length());for(var i=n;i>=t;i--){var s=e.sandbox.pages.at(i-1);r(s)}}},error:function(t){var n=e.sandbox.pages.at(t.index);e.sandbox.content[e.sandbox.reader.get("capacities").toString()]._error(n,t)},_getFirstAndLastPages:function(t,n,r){var i=e.sandbox.pages.length()-1;t=t<0?0:t,n=n>i?i:n;var s=t-r>=0?t-r:0,o=n+r<=i?n+r:i;return{first:s,last:o}},_loadContent:function(t){var n=e.sandbox.pages.at(t);n.get("state")!==e.sandbox.pages.STATES.loading&&this[e.sandbox.reader.get("capacities").toString()]._load(n)},image:{_create:function(t,n){var r=new Image;return r.className="rd-content",t.set("state",e.sandbox.pages.STATES.loading),r.onload=_.bind(this._loaded,this,t,r),r.onError=_.bind(this._error,this,t),r.src=n,r},_load:function(t){if(t.get("state")===e.sandbox.pages.STATES.loaded)return;if(t.get("state")===e.sandbox.pages.STATES.preLoaded){this._loaded(t);return}if(e.sandbox.reader.get("cover")){var n=e.sandbox.reader.get("cover");n.className="rd-content",this._loaded(t,n);return}this._create(t,e.sandbox.util.url.getContent(t.get("number")-1))},_loaded:function(n,r){n.set("state",e.sandbox.pages.STATES.loaded),r&&this._setContent(n,r),t.emit("reader.pages.content.loaded",n)},_setContent:function(e,t){var n=parseFloat(t.width/t.height);e.set("ratio",n),e.set("$content",$(t))},_error:function(t,n){t.set({$content:null,state:e.sandbox.pages.STATES.error})}},flash:{_create:function(t){var n=e.sandbox.pages.indexOf(t);t.set("state",e.sandbox.pages.STATES.loading);var r="content_page_"+n,i=e.sandbox.util.url.getFlashLoader(),s={indexPage:n,scale:.5,url:encodeURIComponent(e.sandbox.util.url.getContent(t.get("number")-1)),times:0},o={menu:"false",allowFullScreen:"true",allowScriptAccess:"always",scale:"exactFit",wmode:"transparent"},u={id:r,name:r,styleclass:"rd-content"};swfobject.switchOffAutoHideShow(),swfobject.embedSWF(i,r,"100%","100%","9.0.0",!1,s,o,u,function(e){e.success?t.set("$flash",$(e.ref)):console.error("fail to load Flash page :(")})},_load:function(t){t.get("state")===e.sandbox.pages.STATES.loaded?t.set("display",!0):t.get("state")===e.sandbox.pages.STATES.preLoaded?(t.get("$element").html(t.get("$content")),t.set({state:e.sandbox.pages.STATES.loading,display:!0})):this._create(t)},_setPreviewPage:function(e,t){var n=e.get("$content"),r=e.get("$element");if(r.hasClass("loadingBG")===!1)return;var i=t.encode.replace(/[\r\n]/g,"");r.css({background:'url("data:image/jpeg;base64,'+i+'")',"background-size":"100%"})},_loaded:function(n,r){n.set("state",e.sandbox.pages.STATES.loaded),n.get("$content")||this._setContent(n,r),r.encode&&this._setPreviewPage(n,r),t.emit("reader.pages.content.loaded",n)},_setContent:function(e,t){var n=e.get("$flash");e.set("$content",n),e.unset("$flash");var r=parseFloat(t.width/t.height);e.set("ratio",r)},_error:function(t,n){t.set("state",e.sandbox.pages.STATES.error)}},html:{_load:function(t){if(t.get("state")===e.sandbox.pages.STATES.loaded)return;if(t.get("state")===e.sandbox.pages.STATES.preLoaded){this._loaded(t);return}t.set("state",e.sandbox.pages.STATES.loading),e.core.util.request({url:e.sandbox.util.url.getContent(t.get("number")-1),jsonp:!0,success:_.bind(e.sandbox.content.html._loaded,e.sandbox.content.html,t),error:_.bind(e.sandbox.content.html._error,e.sandbox.content.html,t)})},_loaded:function(n,r){n.set("state",e.sandbox.pages.STATES.loaded),r&&this._setContent(n,r),this._scale(n),t.emit("reader.pages.content.loaded",n)},_setContent:function(e,t){var n=$(t).clone(!0),r=$("<div class='rd-content'/>").append(n);e.get("display")?r.show():r.hide();var i=parseFloat(n.width()/n.height());e.set({originalWidth:n.width(),originalHeight:n.height(),ratio:i,$content:r.clone(!0)})},_scale:function(t){if(t.get("state")!==e.sandbox.pages.STATES.loaded||e.sandbox.viewport.get("ready")===!1)return;var n=e.sandbox.pages.indexOf(t),r=t.get("originalWidth"),i=t.get("$element").width()===0?e.sandbox.pages.at(e.sandbox.pages.get("currentIndex")).get("$element").width():t.get("$element").width(),s=i/r,o=t.get("$content").children();e.sandbox.util.browserType.isIE()?o.css("zoom",s):e.sandbox.util.browserType.isOpera()?o.css({"-o-transform":"scale("+s+")","-o-transform-origin":"left top"}):e.sandbox.util.browserType.isFirefox()?o.css({position:"absolute","-moz-transform":"scale("+s+")","-moz-transform-origin":"0 0"}):e.sandbox.util.browserType.isWebkit()&&o.css({"-webkit-transform":"scale("+s+")","-webkit-transform-origin-x":"0%","-webkit-transform-origin-y":"0%"}),t.set("scaled",!0)},_error:function(t,n){t.set({$content:null,state:e.sandbox.pages.STATES.error})}}}}}),define("extensions/popin",{initialize:function(e){var t=require("backbone"),n=null,r={download:{url:"/BookReader/DownloadTemplate"},library:{url:"/BookReader/LibraryTemplate"},mail:{url:"/BookReader/ShareTemplate"}},i=t.Model.extend({defaults:{display:!1,currentType:null},initialize:function(){this.constructor.__super__.initialize.apply(this)},getSocialLinks:function(t){return n=e.core.util.request({url:"/BookReader/Social",data:{id:e.sandbox.reader.get("productId")},jsonp:!0,success:function(e){t(e)},error:function(e){e.statusText!=="abort"&&console.warn(e.statusText)}}),n},getTemplate:function(t,i){if(r[t].template){i(r[t].template);return}return n=e.core.util.request({url:r[t].url,data:{productId:e.sandbox.reader.get("productId"),documentId:e.sandbox.reader.get("documentId")},jsonp:!0,success:function(e){i(e)},error:function(e){e.statusText!=="abort"&&console.warn(e.statusText)}}),n}}),s=new i;e.sandbox.popin=s}}),define("extensions/embed",{initialize:function(e){var t=e.core.mediator,n=require("backbone"),r=n.Model.extend({defaults:{display:"scroll",width:"100%",height:"100%",defaultWidth:620,startPage:1,code:null,flexible:!0},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"setDisplay","setSizeType","setWidth","setStartPage","getHeightFromRatio"),t.on("reader.popin.embed.display.change",this.setDisplay),t.on("reader.popin.embed.size.type",this.setSizeType),t.on("reader.popin.embed.width.change",this.setWidth),t.on("reader.popin.embed.startPage.change",this.setStartPage),this.on("change:display",function(){var e=this.previous("display");if(this.get("width")!=="100%")if(e==="double"||this.get("display")==="double"){var n=this.getHeightFromRatio(this.get("width"));this.set("height",n)}t.emit("reader.popin.embed.display.changed",this.get("display"))}),this.on("change:startPage",function(){t.emit("reader.popin.embed.startPage.changed",this.get("startPage"))}),this.on("change:width",function(){t.emit("reader.popin.embed.width.changed",this.get("width"))}),this.on("change:height",function(){t.emit("reader.popin.embed.height.changed",this.get("height"))}),this.on("change:defaultWidth",function(){var e=this.getHeightFromRatio(this.get("defaultWidth"));this.set("defaultHeight",e)})},setDisplay:function(e){this.set("display",e)},setSizeType:function(e){var t=this.getHeightFromRatio(this.get("defaultWidth"));e.type==="flex"?this.set({flexible:!0,width:"100%",height:"100%"}):this.set({flexible:!1,width:this.get("defaultWidth"),height:t})},setWidth:function(e){var t=parseInt(e,10),n=this.getHeightFromRatio(t);this.set({defaultWidth:t,width:t,height:n})},setStartPage:function(t){var n=t>>0,r=e.sandbox.pages.length();n<1?n=1:n>r&&(n=r),this.set("startPage",n)},getHeightFromRatio:function(t){var n=10+e.sandbox.toolbar.get("height"),r=e.sandbox.pages.at(this.get("startPage")-1).get("$content");return t=this.get("display")==="double"?t/2:t,Math.round(r.height()*t/r.width()+n)}}),i=new r;e.sandbox.popin.embed=i}}),define("extensions/watcher",{initialize:function(e){var t=e.core.mediator,n=require("backbone"),r="/Stat/ReadPart/"+e.config.reader.productId,i=1e3,s=3,o=3e4,u=n.Model.extend({defaults:{reading:!1,intervalHandler:null,nbTime:0},initialize:function(){_.bindAll(this,"_increment"),this.on("change:reading",function(){this.get("reading")?this.set("intervalHandler",setInterval(this._increment,i)):clearInterval(this.get("intervalHandler"))})},destroy:function(){clearInterval(this.get("intervalHandler"))},_increment:function(){(e.sandbox.viewport.get("display")!=="double"||!e.sandbox.viewport.double.get("isTurning"))&&$("body").data("visibility")=="visible"&&this.set("nbTime",this.get("nbTime")+1)}}),a=n.Collection.extend({model:u,setReadingParts:function(e){var t=this;e=_.uniq(e,!1,function(e){return t.indexOf(e)});var n=this.where({reading:!0});_.each(n,function(t){_.contains(e,t)===!1&&t.set("reading",!1)}),_.each(e,function(e){e.set("reading",!0)})},destroy:function(){_.invoke(this.toArray(),"destroy")},reloadTime:function(){this.each(function(e){var t=e.get("nbTime");e.set("nbTime",t%s)})}}),f=n.Model.extend({defaults:{sendingIntervalhandler:null},initialize:function(){this.constructor.__super__.initialize.apply(this),_.bindAll(this,"_startListening","_scrolled","_pageChanged","_send"),t.on("reader.viewport.ready",this._startListening),this._initVisible()},_initVisible:function(){function e(e){var n="visible",r="hidden",i={focus:n,focusin:n,pageshow:n,blur:r,focusout:r,pagehide:r};e=e||window.event,e.type in i?$(document.body).data("visibility",i[e.type]):$(document.body).data("visibility",this[t]?"hidden":"visible")}var t="hidden";t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e,e({type:document.visibilityState=="visible"?"focus":"blur"})},_startListening:function(){if(e.sandbox.reader.get("embed")||e.sandbox.reader.get("cover")||e.sandbox.reader.get("pagesRatio")==null)return;t.off("reader.viewport.scroll",this._scrolled),t.off("reader.pages.currentIndex.changed",this._pageChanged),this.get("sendingIntervalhandler")&&clearInterval(this.get("sendingIntervalhandler")),this._createParts(),e.sandbox.viewport.get("display")==="scroll"?(t.on("reader.viewport.scroll",this._scrolled),this._scrolled({type:"top",top:$(window).scrollTop()})):(t.on("reader.pages.currentIndex.changed",this._pageChanged),this._pageChanged(e.sandbox.pages.at(e.sandbox.pages.get("currentIndex")))),this.set("sendingIntervalhandler",setInterval(this._send,o)),$(window).unload(this._send)},_createParts:function(){this._parts&&this._parts.destroy();var t=[];for(var n=0;n<e.sandbox.reader.get("nbPart");n++)t.push(new u);this._parts=new a(t)},_pageChanged:function(t){var n=[];if(e.sandbox.viewport.get("display")==="double"){var r=e.sandbox.viewport.get("$element").children().turn("view"),i=e.sandbox.pages.at(r[0]-1),s=e.sandbox.pages.at(r[1]-1);i&&n.push(i),s&&n.push(s),this._parts.setReadingParts(this._getReadingPartsOfPages(n))}else e.sandbox.viewport.get("display")==="slideshow"&&(n.push(t),this._parts.setReadingParts(this._getReadingPartsOfPages(n)))},_scrolled:function(e){e.type==="top"&&this._parts.setReadingParts(this._getReadingPartsOfVisiblePagesFromPosition(e.top))},_getReadingPartsOfVisiblePagesFromPosition:function(t){var n=[],r=e.sandbox.viewport.scroll.get("pagesDisplayedIntoTheWindow");for(var i=r.first;i<=r.last;i++)n.push.apply(n,this._getReadingParts(e.sandbox.pages.at(i),t));return n},_getReadingPartsOfPages:function(e){var t=[];return _.each(e,function(e){t.push.apply(t,this._extractReadingParts(e,null))},this),t},_getReadingParts:function(t,n){var r=null,i=e.core.util.getWindowHeight(),s=e.sandbox.pages.indexOf(t),o=t.get("$element").position().top+(s!==0?10:0),u=t.get("$element").width()/e.sandbox.reader.get("pagesRatio")[s];e.sandbox.fullscreen.get("enable")===!1?(n-=e.sandbox.reader.get("offset").top,e.sandbox.toolbar.get("fixed")?(i=e.core.util.getWindowHeight()-e.sandbox.toolbar.get("height"),n+=e.sandbox.toolbar.get("height")):n-=e.sandbox.toolbar.get("height")):i=e.sandbox.viewport.get("height");if(o<n){if(o+u<n)return null;r=(o+u-n)*-1}else if(n+i<o+u){if(o>n+i)return null;r=n+i-o}return this._extractReadingParts(t,r)},_extractReadingParts:function(t,n){var r=e.sandbox.pages.indexOf(t),i=t.get("$element").width()/e.sandbox.reader.get("pagesRatio")[r];n=n||i;var s=t.get("$element").width()/e.sandbox.pages.get("totalRatio")/e.sandbox.reader.get("nbPart"),o=[],u=0;for(var a=0;a<r;a++)u+=t.get("$element").width()/e.sandbox.reader.get("pagesRatio")[a];n<0&&(u+=i+n,n*=-1);var f=parseInt(u/s),l=parseInt((u+n)/s);while(f<=l&&f<this._parts.length)o.push(this._parts.at(f)),f++;return o},_send:function(){var e=this._parts.filter(function(e){return e.get("nbTime")/s>1}),t=this._parts,n=[];_.each(e,function(e){n.push({i:t.indexOf(e),c:parseInt(e.get("nbTime")/s)})}),n.length>0&&$.ajax({url:r,type:"POST",traditional:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({model:n})}),this._parts.reloadTime()},_print:function(e){var t=this._parts;console.log("--------------"),_.each(e,function(e){console.log(t.indexOf(e),e.toJSON())})}}),l=new f;e.sandbox.watcher=l}}),define("extensions/mouse",{initialize:function(e){var t=e.core.mediator,n,r;e.sandbox.mouse={startListening:function(t){if(e.sandbox.reader.get("capacities").flash===!1)return;var i=e.sandbox.util.browserType.isFirefox(),s=i?"DOMMouseScroll":"mousewheel";n=t,r=i,t.on(s,this._mouseScrollCB)},_mouseScrollCB:function(e){var t=r?-e.originalEvent.detail:e.originalEvent.wheelDelta/40,i=n.scrollTop(),s=n[0],o=Math.max(s.scrollHeight,s.offsetHeight,s.clientHeight);if(i===0&&t>0||i+n.height()>=o&&t<0)return;n.scrollTop(i-t*30),e.preventDefault()}}}}),define("hbs/handlebars",[],function(){var e=function(){var e=function(){function e(e){this.string=e}var t;return e.prototype.toString=function(){return""+this.string},t=e,t}(),t=function(e){function t(e){return u[e]||"&amp;"}function n(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function r(e){return e instanceof o?e.toString():!e&&e!==0?"":(e=""+e,f.test(e)?e.replace(a,t):e)}function i(e){return!e&&e!==0?!0:h(e)&&e.length===0?!0:!1}var s={},o=e,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},a=/[&<>"'`]/g,f=/[&<>"'`]/;s.extend=n;var l=Object.prototype.toString;s.toString=l;var c=function(e){return typeof e=="function"};c(/x/)&&(c=function(e){return typeof e=="function"&&l.call(e)==="[object Function]"});var c;s.isFunction=c;var h=Array.isArray||function(e){return e&&typeof e=="object"?l.call(e)==="[object Array]":!1};return s.isArray=h,s.escapeExpression=r,s.isEmpty=i,s}(e),n=function(){function e(){var e=Error.prototype.constructor.apply(this,arguments);for(var t=0;t<n.length;t++)this[n[t]]=e[n[t]]}var t,n=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,t=e,t}(),r=function(e,t){function n(e,t){this.helpers=e||{},this.partials=t||{},r(this)}function r(e){e.registerHelper("helperMissing",function(e){if(arguments.length===2)return undefined;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var r=n.inverse||function(){},i=n.fn;return h(t)&&(t=t.call(this)),t===!0?i(this):t===!1||t==null?r(this):c(t)?t.length>0?e.helpers.each(t,n):r(this):i(t)}),e.registerHelper("each",function(e,t){var n=t.fn,r=t.inverse,i=0,s="",o;h(e)&&(e=e.call(this)),t.data&&(o=m(t.data));if(e&&typeof e=="object")if(c(e))for(var u=e.length;i<u;i++)o&&(o.index=i,o.first=i===0,o.last=i===e.length-1),s+=n(e[i],{data:o});else for(var a in e)e.hasOwnProperty(a)&&(o&&(o.key=a),s+=n(e[a],{data:o}),i++);return i===0&&(s=r(this)),s}),e.registerHelper("if",function(e,t){return h(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||o.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){h(e)&&(e=e.call(this));if(!o.isEmpty(e))return t.fn(e)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)})}function i(e,t){v.log(e,t)}var s={},o=e,u=t,a="1.1.2";s.VERSION=a;var f=4;s.COMPILER_REVISION=f;var l={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};s.REVISION_CHANGES=l;var c=o.isArray,h=o.isFunction,p=o.toString,d="[object Object]";s.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:v,log:i,registerHelper:function(e,t,n){if(p.call(e)===d){if(n||t)throw new u("Arg not supported with multiple helpers");o.extend(this.helpers,e)}else n&&(t.not=n),this.helpers[e]=t},registerPartial:function(e,t){p.call(e)===d?o.extend(this.partials,e):this.partials[e]=t}};var v={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(v.level<=e){var n=v.methodMap[e];typeof console!="undefined"&&console[n]&&console[n].call(console,t)}}};s.logger=v,s.log=i;var m=function(e){var t={};return o.extend(t,e),t};return s.createFrame=m,s}(t,n),i=function(e,t,n){function r(e){var t=e&&e[0]||1,n=h;if(t!==n){if(t<n){var r=p[n],i=p[t];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function i(e,t){if(!t)throw new Error("No environment passed to template");var n;t.compile?n=function(e,n,r,i,s,o){var a=u.apply(this,arguments);if(a)return a;var f={helpers:i,partials:s,data:o};return s[n]=t.compile(e,{data:o!==undefined},t),s[n](r,f)}:n=function(e,t){var n=u.apply(this,arguments);if(n)return n;throw new c("The partial "+t+" could not be compiled when running in runtime-only mode")};var i={escapeExpression:l.escapeExpression,invokePartial:n,programs:[],program:function(e,t,n){var r=this.programs[e];return n?r=o(e,t,n):r||(r=this.programs[e]=o(e,t)),r},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n={},l.extend(n,t),l.extend(n,e)),n},programWithDepth:s,noop:a,compilerInfo:null};return function(n,s){s=s||{};var o=s.partial?s:t,u,a;s.partial||(u=s.helpers,a=s.partials);var f=e.call(i,o,n,u,a,s.data);return s.partial||r(i.compilerInfo),f}}function s(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i}function o(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r}function u(e,t,n,r,i,s){var o={partial:!0,helpers:r,partials:i,data:s};if(e===undefined)throw new c("The partial "+t+" could not be found");if(e instanceof Function)return e(n,o)}function a(){return""}var f={},l=e,c=t,h=n.COMPILER_REVISION,p=n.REVISION_CHANGES;return f.template=i,f.programWithDepth=s,f.program=o,f.invokePartial=u,f.noop=a,f}(t,n,r),s=function(e,t,n,r,i){var s,o=e,u=t,a=n,f=r,l=i,c=function(){var e=new o.HandlebarsEnvironment;return f.extend(e,o),e.SafeString=u,e.Exception=a,e.Utils=f,e.VM=l,e.template=function(t){return l.template(t,e)},e},h=c();return h.create=c,s=h,s}(r,e,n,t,i),o=function(e){function t(e,n,r){this.type="program",this.statements=e,this.strip={},r?(this.inverse=new t(r,n),this.strip.right=n.left):n&&(this.strip.left=n.right)}function n(e,t,n,r){this.type="mustache",this.hash=t,this.strip=r;var i=n[3]||n[2];this.escaped=i!=="{"&&i!=="&";var s=this.id=e[0],o=this.params=e.slice(1),u=this.eligibleHelper=s.isSimple;this.isHelper=u&&(o.length||t)}function r(e,t,n){this.type="partial",this.partialName=e,this.context=t,this.strip=n}function i(e,t,n,r){if(e.id.original!==r.path.original)throw new v(e.id.original+" doesn't match "+r.path.original);this.type="block",this.mustache=e,this.program=t,this.inverse=n,this.strip={left:e.strip.left,right:r.strip.right},(t||n).strip.left=e.strip.right,(n||t).strip.right=r.strip.left,n&&!t&&(this.isInverse=!0)}function s(e){this.type="content",this.string=e}function o(e){this.type="hash",this.pairs=e}function u(e){this.type="ID";var t="",n=[],r=0;for(var i=0,s=e.length;i<s;i++){var o=e[i].part;t+=(e[i].separator||"")+o;if(o===".."||o==="."||o==="this"){if(n.length>0)throw new v("Invalid path: "+t);o===".."?r++:this.isScoped=!0}else n.push(o)}this.original=t,this.parts=n,this.string=n.join("."),this.depth=r,this.isSimple=e.length===1&&!this.isScoped&&r===0,this.stringModeValue=this.string}function a(e){this.type="PARTIAL_NAME",this.name=e.original}function f(e){this.type="DATA",this.id=e}function l(e){this.type="STRING",this.original=this.string=this.stringModeValue=e}function c(e){this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)}function h(e){this.type="BOOLEAN",this.bool=e,this.stringModeValue=e==="true"}function p(e){this.type="comment",this.comment=e}var d={},v=e;return d.ProgramNode=t,d.MustacheNode=n,d.PartialNode=r,d.BlockNode=i,d.ContentNode=s,d.HashNode=o,d.IdNode=u,d.PartialNameNode=a,d.DataNode=f,d.StringNode=l,d.IntegerNode=c,d.BooleanNode=h,d.CommentNode=p,d}(n),u=function(){var e,t=function(){function e(e,t){return{left:e[2]==="~",right:t[0]==="~"||t[1]==="~"}}function t(){this.yy={}}var n={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,inMustache_repetition0:28,inMustache_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,hash:35,hash_repetition_plus0:36,hashSegment:37,ID:38,EQUALS:39,DATA:40,pathSegments:41,SEP:42,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",38:"ID",39:"EQUALS",40:"DATA",42:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[35,1],[37,3],[26,1],[26,1],[26,1],[30,2],[21,1],[41,3],[41,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[36,1],[36,2]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return new i.ProgramNode(o[a-1]);case 2:return new i.ProgramNode([]);case 3:this.$=new i.ProgramNode([],o[a-1],o[a]);break;case 4:this.$=new i.ProgramNode(o[a-2],o[a-1],o[a]);break;case 5:this.$=new i.ProgramNode(o[a-1],o[a],[]);break;case 6:this.$=new i.ProgramNode(o[a]);break;case 7:this.$=new i.ProgramNode([]);break;case 8:this.$=new i.ProgramNode([]);break;case 9:this.$=[o[a]];break;case 10:o[a-1].push(o[a]),this.$=o[a-1];break;case 11:this.$=new i.BlockNode(o[a-2],o[a-1].inverse,o[a-1],o[a]);break;case 12:this.$=new i.BlockNode(o[a-2],o[a-1],o[a-1].inverse,o[a]);break;case 13:this.$=o[a];break;case 14:this.$=o[a];break;case 15:this.$=new i.ContentNode(o[a]);break;case 16:this.$=new i.CommentNode(o[a]);break;case 17:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],o[a-2],e(o[a-2],o[a]));break;case 18:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],o[a-2],e(o[a-2],o[a]));break;case 19:this.$={path:o[a-1],strip:e(o[a-2],o[a])};break;case 20:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],o[a-2],e(o[a-2],o[a]));break;case 21:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],o[a-2],e(o[a-2],o[a]));break;case 22:this.$=new i.PartialNode(o[a-2],o[a-1],e(o[a-3],o[a]));break;case 23:this.$=e(o[a-1],o[a]);break;case 24:this.$=[[o[a-2]].concat(o[a-1]),o[a]];break;case 25:this.$=[[o[a]],null];break;case 26:this.$=o[a];break;case 27:this.$=new i.StringNode(o[a]);break;case 28:this.$=new i.IntegerNode(o[a]);break;case 29:this.$=new i.BooleanNode(o[a]);break;case 30:this.$=o[a];break;case 31:this.$=new i.HashNode(o[a]);break;case 32:this.$=[o[a-2],o[a]];break;case 33:this.$=new i.PartialNameNode(o[a]);break;case 34:this.$=new i.PartialNameNode(new i.StringNode(o[a]));break;case 35:this.$=new i.PartialNameNode(new i.IntegerNode(o[a]));break;case 36:this.$=new i.DataNode(o[a]);break;case 37:this.$=new i.IdNode(o[a]);break;case 38:o[a-2].push({part:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 39:this.$=[{part:o[a]}];break;case 42:this.$=[];break;case 43:o[a-1].push(o[a]);break;case 46:this.$=[o[a]];break;case 47:o[a-1].push(o[a])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:29,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:30,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:31,21:24,30:25,38:[1,28],40:[1,27],41:26},{21:33,26:32,32:[1,34],33:[1,35],38:[1,28],41:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,38:[1,28],40:[1,27],41:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,42],24:[2,42],28:43,32:[2,42],33:[2,42],34:[2,42],38:[2,42],40:[2,42]},{18:[2,25],24:[2,25]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],38:[2,37],40:[2,37],42:[1,44]},{21:45,38:[1,28],41:26},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],40:[2,39],42:[2,39]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,40],21:50,27:49,38:[1,28],41:26},{18:[2,33],38:[2,33]},{18:[2,34],38:[2,34]},{18:[2,35],38:[2,35]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,38:[1,28],41:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,44],21:56,24:[2,44],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:55,36:61,37:62,38:[1,63],40:[1,27],41:26},{38:[1,64]},{18:[2,36],24:[2,36],32:[2,36],33:[2,36],34:[2,36],38:[2,36],40:[2,36]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,65]},{18:[2,41]},{18:[1,66]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24]},{18:[2,43],24:[2,43],32:[2,43],33:[2,43],34:[2,43],38:[2,43],40:[2,43]},{18:[2,45],24:[2,45]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],38:[2,26],40:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],38:[2,27],40:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],38:[2,28],40:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],38:[2,29],40:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],38:[2,30],40:[2,30]},{18:[2,31],24:[2,31],37:67,38:[1,68]},{18:[2,46],24:[2,46],38:[2,46]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],39:[1,69],40:[2,39],42:[2,39]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],38:[2,38],40:[2,38],42:[2,38]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{18:[2,47],24:[2,47],38:[2,47]},{39:[1,69]},{21:56,30:60,31:70,32:[1,57],33:[1,58],34:[1,59],38:[1,28],40:[1,27],41:26},{18:[2,32],24:[2,32],38:[2,32]}],defaultActions:{3:[2,2],16:[2,1],50:[2,41]},parseError:function(e,t){throw new Error(e)},parse:function(e){function t(e){i.length=i.length-2*e,s.length=s.length-e,o.length=o.length-e}function n(){var e;return e=r.lexer.lex()||1,typeof e!="number"&&(e=r.symbols_[e]||e),e}var r=this,i=[0],s=[null],o=[],u=this.table,a="",f=0,l=0,c=0,h=2,p=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var d=this.lexer.yylloc;o.push(d);var v=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var m,g,y,b,w,E,S={},x,T,N,C;for(;;){y=i[i.length-1];if(this.defaultActions[y])b=this.defaultActions[y];else{if(m===null||typeof m=="undefined")m=n();b=u[y]&&u[y][m]}if(typeof b=="undefined"||!b.length||!b[0]){var k="";if(!c){C=[];for(x in u[y])this.terminals_[x]&&x>2&&C.push("'"+this.terminals_[x]+"'");this.lexer.showPosition?k="Parse error on line "+(f+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+C.join(", ")+", got '"+(this.terminals_[m]||m)+"'":k="Parse error on line "+(f+1)+": Unexpected "+(m==1?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:d,expected:C})}}if(b[0]instanceof Array&&b.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+m);switch(b[0]){case 1:i.push(m),s.push(this.lexer.yytext),o.push(this.lexer.yylloc),i.push(b[1]),m=null,g?(m=g,g=null):(l=this.lexer.yyleng,a=this.lexer.yytext,f=this.lexer.yylineno,d=this.lexer.yylloc,c>0&&c--);break;case 2:T=this.productions_[b[1]][1],S.$=s[s.length-T],S._$={first_line:o[o.length-(T||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(T||1)].first_column,last_column:o[o.length-1].last_column},v&&(S._$.range=[o[o.length-(T||1)].range[0],o[o.length-1].range[1]]),E=this.performAction.call(S,a,l,f,this.yy,b[1],s,o);if(typeof E!="undefined")return E;T&&(i=i.slice(0,-1*T*2),s=s.slice(0,-1*T),o=o.slice(0,-1*T)),i.push(this.productions_[b[1]][0]),s.push(S.$),o.push(S._$),N=u[i[i.length-2]][i[i.length-1]],i.push(N);break;case 3:return!0}}return!0}},r=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return typeof e!="undefined"?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,n,r){function i(e,n){return t.yytext=t.yytext.substr(e,t.yyleng-n)}var s=r;switch(n){case 0:t.yytext.slice(-2)==="\\\\"?(i(0,1),this.begin("mu")):t.yytext.slice(-1)==="\\"?(i(0,1),this.begin("emu")):this.begin("mu");if(t.yytext)return 14;break;case 1:return 14;case 2:return t.yytext.slice(-1)!=="\\"&&this.popState(),t.yytext.slice(-1)==="\\"&&i(0,1),14;case 3:return i(0,4),this.popState(),15;case 4:return 25;case 5:return 16;case 6:return 20;case 7:return 19;case 8:return 19;case 9:return 23;case 10:return 22;case 11:this.popState(),this.begin("com");break;case 12:return i(3,5),this.popState(),15;case 13:return 22;case 14:return 39;case 15:return 38;case 16:return 38;case 17:return 42;case 18:break;case 19:return this.popState(),24;case 20:return this.popState(),18;case 21:return t.yytext=i(1,2).replace(/\\"/g,'"'),32;case 22:return t.yytext=i(1,2).replace(/\\'/g,"'"),32;case 23:return 40;case 24:return 34;case 25:return 34;case 26:return 33;case 27:return 38;case 28:return t.yytext=i(1,2),38;case 29:return"INVALID";case 30:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s])))/,/^(?:false(?=([~}\s])))/,/^(?:-?[0-9]+(?=([~}\s])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,30],inclusive:!0}},e}();return n.lexer=r,t.prototype=n,n.Parser=t,new t}();return e=t,e}(),a=function(e,t){function n(e){return e.constructor===s.ProgramNode?e:(i.yy=s,i.parse(e))}var r={},i=e,s=t;return r.parser=i,r.parse=n,r}(u,o),f=function(e){function t(e){this.value=e}function n(){}var r,i=e.COMPILER_REVISION,s=e.REVISION_CHANGES,o=e.log;n.prototype={nameLookup:function(e,t){var r,i;return e.indexOf("depth")===0&&(r=!0),/^[0-9]+$/.test(t)?i=e+"["+t+"]":n.isValidJavaScriptVariableName(t)?i=e+"."+t:i=e+"['"+t+"']",r?"("+e+" && "+i+")":i},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,n,r){this.environment=e,this.options=t||{},o("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(e,t);var i=e.opcodes,s;this.i=0;for(var u=i.length;this.i<u;this.i++)s=i[this.i],s.opcode==="DECLARE"?this[s.name]=s.value:this[s.opcode].apply(this,s.args),s.opcode!==this.stripNext&&(this.stripNext=!1);return this.pushSource(""),this.createFunctionContext(r)},preamble:function(){var e=[];if(!this.isChild){var t=this.namespace,n="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(n=n+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(n+=" data = data || {};"),e.push(n)}else e.push("");this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(e){var t=this.stackVars.concat(this.registers.list);t.length>0&&(this.source[1]=this.source[1]+", "+t.join(", "));if(!this.isChild)for(var n in this.context.aliases)this.context.aliases.hasOwnProperty(n)&&(this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");var r=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var u=0,a=this.environment.depths.list.length;u<a;u++)r.push("depth"+this.environment.depths.list[u]);var f=this.mergeSource();if(!this.isChild){var l=i,c=s[l];f="this.compilerInfo = ["+l+",'"+c+"'];\n"+f}if(e)return r.push(f),Function.apply(this,r);var h="function "+(this.name||"")+"("+r.join(",")+") {\n  "+f+"}";return o("debug",h+"\n\n"),h},mergeSource:function(){var e="",t;for(var n=0,r=this.source.length;n<r;n++){var i=this.source[n];i.appendToBuffer?t?t=t+"\n    + "+i.content:t=i.content:(t&&(e+="buffer += "+t+";\n  ",t=undefined),e+=i+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),e[e.length-1]="options",this.pushSource("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.pendingContent&&(e=this.pendingContent+e),this.stripNext&&(e=e.replace(/^\s+/,"")),this.pendingContent=e},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var e=this.popStack();this.pushSource("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(){this.push("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),typeof e=="string"?this.pushString(e):this.pushStackLiteral(e)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var e=this.hash;this.hash=undefined,this.options.stringParams&&(this.register("hashContexts","{"+e.contexts.join(",")+"}"),this.register("hashTypes","{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var n=this.lastHelper=this.setupHelper(e,t,!0),r=this.nameLookup("depth"+this.lastContext,t,"context");this.push(n.name+" || "+r),this.replaceStack(function(e){return e+" ? "+e+".call("+n.callParams+") "+": helperMissing.call("+n.helperMissingParams+")"})},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var n=this.setupHelper(0,e,t),r=this.lastHelper=this.nameLookup("helpers",e,"helper"),i=this.nameLookup("depth"+this.lastContext,e,"context"),s=this.nextStack();this.pushSource("if ("+s+" = "+r+") { "+s+" = "+s+".call("+n.callParams+"); }"),this.pushSource("else { "+s+" = "+i+"; "+s+" = typeof "+s+" === functionType ? "+s+".call("+n.callParams+") : "+s+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t=this.popStack(),n,r;this.options.stringParams&&(r=this.popStack(),n=this.popStack());var i=this.hash;n&&i.contexts.push("'"+e+"': "+n),r&&i.types.push("'"+e+"': "+r),i.values.push("'"+e+"': ("+t+")")},compiler:n,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler;var u=this.matchExistingProgram(r);u==null?(this.context.programs.push(""),u=this.context.programs.length,r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context),this.context.environments[u]=r):(r.index=u,r.name="program"+u)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){this.context.aliases.self="this";if(e==null)return"self.noop";var t=this.environment.children[e],n=t.depths.list,r,i=[t.index,t.name,"data"];for(var s=0,o=n.length;s<o;s++)r=n[s],r===1?i.push("depth0"):i.push("depth"+(r-1));return(n.length===0?"self.program(":"self.programWithDepth(")+i.join(", ")+")"},register:function(e,t){this.useRegister(e),this.pushSource(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new t(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=undefined),e&&this.source.push(e)},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.pushSource(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var n="",r=this.isInline(),i;if(r){var s=this.popStack(!0);if(s instanceof t)i=s.value;else{var o=this.stackSlot?this.topStackName():this.incrStack();n="("+this.push(o)+" = "+s+"),",i=this.topStack()}}else i=this.topStack();var u=e.call(this,i);return r?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+n+u+")")):(/^stack/.test(i)||(i=this.nextStack()),this.pushSource(i+" = ("+n+u+");")),i},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var n=0,r=e.length;n<r;n++){var i=e[n];i instanceof t?this.compileStack.push(i):this.pushStack(i)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var n=this.isInline(),r=(n?this.inlineStack:this.compileStack).pop();return!e&&r instanceof t?r.value:(n||this.stackSlot--,r)},topStack:function(e){var n=this.isInline()?this.inlineStack:this.compileStack,r=n[n.length-1];return!e&&r instanceof t?r.value:r},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,n){var r=[];this.setupParams(e,r,n);var i=this.nameLookup("helpers",t,"helper");return{params:r,name:i,callParams:["depth0"].concat(r).join(", "),helperMissingParams:n&&["depth0",this.quotedString(t)].concat(r).join(", ")}},setupParams:function(e,t,n){var r=[],i=[],s=[],o,u,a;r.push("hash:"+this.popStack()),u=this.popStack(),a=this.popStack();if(a||u)a||(this.context.aliases.self="this",a="self.noop"),u||(this.context.aliases.self="this",u="self.noop"),r.push("inverse:"+u),r.push("fn:"+a);for(var f=0;f<e;f++)o=this.popStack(),t.push(o),this.options.stringParams&&(s.push(this.popStack()),i.push(this.popStack()));return this.options.stringParams&&(r.push("contexts:["+i.join(",")+"]"),r.push("types:["+s.join(",")+"]"),r.push("hashContexts:hashContexts"),r.push("hashTypes:hashTypes")),this.options.data&&r.push("data:data"),r="{"+r.join(",")+"}",n?(this.register("options",r),t.push("options")):t.push(r),t.join(", ")}};var u="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),a=n.RESERVED_WORDS={};for(var f=0,l=u.length;f<l;f++)a[u[f]]=!0;return n.isValidJavaScriptVariableName=function(e){return!n.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1},r=n,r}(r),l=function(e,t,n,r){function i(){}function s(e,t){if(e==null||typeof e!="string"&&e.constructor!==c.ProgramNode)throw new a("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var n=f(e),r=(new i).compile(n,t);return(new l).compile(r,t)}function o(e,t,n){function r(){var r=f(e),s=(new i).compile(r,t),o=(new l).compile(s,t,undefined,!0);return n.template(o)}if(e==null||typeof e!="string"&&e.constructor!==c.ProgramNode)throw new a("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var s;return function(e,t){return s||(s=r()),s.call(this,e,t)}}var u={},a=e,f=t.parse,l=n,c=r;return u.Compiler=i,i.prototype={compiler:i,disassemble:function(){var e=this.opcodes,t,n=[],r,i;for(var s=0,o=e.length;s<o;s++){t=e[s];if(t.opcode==="DECLARE")n.push("DECLARE "+t.name+"="+t.value);else{r=[];for(var u=0;u<t.args.length;u++)i=t.args[u],typeof i=="string"&&(i='"'+i.replace("\n","\\n")+'"'),r.push(i);n.push(t.opcode+" "+r.join(" "))}}return n.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var r=this.opcodes[n],i=e.opcodes[n];if(r.opcode!==i.opcode||r.args.length!==i.args.length)return!1;for(var s=0;s<r.args.length;s++)if(r.args[s]!==i.args[s])return!1}t=this.children.length;if(e.children.length!==t)return!1;for(n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.accept(e)},accept:function(e){var t=e.strip||{},n;return t.left&&this.opcode("strip"),n=this[e.type](e),t.right&&this.opcode("strip"),n},program:function(e){var t=e.statements;for(var n=0,r=t.length;n<r;n++)this.accept(t[n]);return this.isSimple=r===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++,r;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var i=0,s=t.depths.list.length;i<s;i++){r=t.depths.list[i];if(r<2)continue;this.addDepth(r-1)}return n},block:function(e){var t=e.mustache,n=e.program,r=e.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=this.classifyMustache(t);i==="helper"?this.helperMustache(t,n,r):i==="simple"?(this.simpleMustache(t),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(t,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("pushHash");for(var i=0,s=t.length;i<s;i++)n=t[i],r=n[1],this.options.stringParams?(r.depth&&this.addDepth(r.depth),this.opcode("getContext",r.depth||0),this.opcode("pushStringParam",r.stringModeValue,r.type)):this.accept(r),this.opcode("assignToHash",n[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,n=this.classifyMustache(e);n==="simple"?this.simpleMustache(e):n==="helper"?this.helperMustache(e):this.ambiguousMustache(e),e.escaped&&!t.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(e,t,n){var r=e.id,i=r.parts[0],s=t!=null||n!=null;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",i,s)},simpleMustache:function(e){var t=e.id;t.type==="DATA"?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,n){var r=this.setupFullMustacheParams(e,t,n),i=e.id.parts[0];if(this.options.knownHelpers[i])this.opcode("invokeKnownHelper",r.length,i);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+i);this.opcode("invokeHelper",r.length,i)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var n=1,r=e.parts.length;n<r;n++)this.opcode("lookup",e.parts[n])},DATA:function(e){this.options.data=!0;if(e.id.isScoped||e.id.depth)throw new a("Scoped data references are not supported: "+e.original);this.opcode("lookupData");var t=e.id.parts;for(var n=0,r=t.length;n<r;n++)this.opcode("lookup",t[n])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},classifyMustache:function(e){var t=e.isHelper,n=e.eligibleHelper,r=this.options;if(n&&!t){var i=e.id.parts[0];r.knownHelpers[i]?t=!0:r.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){var t=e.length,n;while(t--)n=e[t],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.stringModeValue,n.type)):this[n.type](n)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("emptyHash"),t},setupFullMustacheParams:function(e,t,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("emptyHash"),r}},u.precompile=s,u.compile=o,u}(n,a,f,o),c=function(e,t,n,r,i){var s,o=e,u=t,a=n.parser,f=n.parse,l=r.Compiler,c=r.compile,h=r.precompile,p=i,d=o.create,v=function(){var e=d();return e.compile=function(t,n){return c(t,n,e)},e.precompile=h,e.AST=u,e.Compiler=l,e.JavaScriptCompiler=p,e.Parser=a,e.parse=f,e};return o=v(),o.create=v,s=o,s}(s,o,a,l,f);return c}();return e}),define("hbs/underscore",[],function(){function e(t,n,r){if(t===n)return t!==0||1/t==1/n;if(t==null||n==null)return t===n;t._chain&&(t=t._wrapped),n._chain&&(n=n._wrapped);if(t.isEqual&&E.isFunction(t.isEqual))return t.isEqual(n);if(n.isEqual&&E.isFunction(n.isEqual))return n.isEqual(t);var i=u.call(t);if(i!=u.call(n))return!1;switch(i){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:t==0?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if(typeof t!="object"||typeof n!="object")return!1;var s=r.length;while(s--)if(r[s]==t)return!0;r.push(t);var o=0,a=!0;if(i=="[object Array]"){o=t.length,a=o==n.length;if(a)while(o--)if(!(a=o in t==o in n&&e(t[o],n[o],r)))break}else{if("constructor"in t!="constructor"in n||t.constructor!=n.constructor)return!1;for(var f in t)if(E.has(t,f)){o++;if(!(a=E.has(n,f)&&e(t[f],n[f],r)))break}if(a){for(f in n)if(E.has(n,f)&&!(o--))break;a=!o}}return r.pop(),a}var t={},n=Array.prototype,r=Object.prototype,i=Function.prototype,s=n.slice,o=n.unshift,u=r.toString,a=r.hasOwnProperty,f=n.forEach,l=n.map,c=n.reduce,h=n.reduceRight,p=n.filter,d=n.every,v=n.some,m=n.indexOf,g=n.lastIndexOf,y=Array.isArray,b=Object.keys,w=i.bind,E=function(e){return new _(e)};E.VERSION="1.3.3";var S=E.each=E.forEach=function(e,n,r){if(e==null)return;if(f&&e.forEach===f)e.forEach(n,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&n.call(r,e[i],i,e)===t)return}else for(var o in e)if(E.has(e,o)&&n.call(r,e[o],o,e)===t)return};E.map=E.collect=function(e,t,n){var r=[];return e==null?r:l&&e.map===l?e.map(t,n):(S(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),e.length===+e.length&&(r.length=e.length),r)},E.reduce=E.foldl=E.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(c&&e.reduce===c)return r&&(t=E.bind(t,r)),i?e.reduce(t,n):e.reduce(t);S(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},E.reduceRight=E.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(h&&e.reduceRight===h)return r&&(t=E.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=E.toArray(e).reverse();return r&&!i&&(t=E.bind(t,r)),i?E.reduce(s,t,n,r):E.reduce(s,t)},E.find=E.detect=function(e,t,n){var r;return x(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},E.filter=E.select=function(e,t,n){var r=[];return e==null?r:p&&e.filter===p?e.filter(t,n):(S(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},E.reject=function(e,t,n){var r=[];return e==null?r:(S(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},E.every=E.all=function(e,n,r){var i=!0;return e==null?i:d&&e.every===d?e.every(n,r):(S(e,function(e,s,o){if(!(i=i&&n.call(r,e,s,o)))return t}),!!i)};var x=E.some=E.any=function(e,n,r){n||(n=E.identity);var i=!1;return e==null?i:v&&e.some===v?e.some(n,r):(S(e,function(e,s,o){if(i||(i=n.call(r,e,s,o)))return t}),!!i)};E.include=E.contains=function(e,t){var n=!1;return e==null?n:m&&e.indexOf===m?e.indexOf(t)!=-1:(n=x(e,function(e){return e===t}),n)},E.invoke=function(e,t){var n=s.call(arguments,2);return E.map(e,function(e){return(E.isFunction(t)?t||e:e[t]).apply(e,n)})},E.pluck=function(e,t){return E.map(e,function(e){return e[t]})},E.max=function(e,t,n){if(!t&&E.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&E.isEmpty(e))return-Infinity;var r={computed:-Infinity};return S(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},E.min=function(e,t,n){if(!t&&E.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&E.isEmpty(e))return Infinity;var r={computed:Infinity};return S(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},E.shuffle=function(e){var t=[],n;return S(e,function(e,r,i){n=Math.floor(Math.random()*(r+1)),t[r]=t[n],t[n]=e}),t},E.sortBy=function(e,t,n){var r=E.isFunction(t)?t:function(e){return e[t]};return E.pluck(E.map(e,function(e,t,i){return{value:e,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n===void 0?1:r===void 0?-1:n<r?-1:n>r?1:0}),"value")},E.groupBy=function(e,t){var n={},r=E.isFunction(t)?t:function(e){return e[t]};return S(e,function(e,t){var i=r(e,t);(n[i]||(n[i]=[])).push(e)}),n},E.sortedIndex=function(e,t,n){n||(n=E.identity);var r=0,i=e.length;while(r<i){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r},E.toArray=function(e){return e?E.isArray(e)?s.call(e):E.isArguments(e)?s.call(e):e.toArray&&E.isFunction(e.toArray)?e.toArray():E.values(e):[]},E.size=function(e){return E.isArray(e)?e.length:E.keys(e).length},E.first=E.head=E.take=function(e,t,n){return t!=null&&!n?s.call(e,0,t):e[0]},E.initial=function(e,t,n){return s.call(e,0,e.length-(t==null||n?1:t))},E.last=function(e,t,n){return t!=null&&!n?s.call(e,Math.max(e.length-t,0)):e[e.length-1]},E.rest=E.tail=function(e,t,n){return s.call(e,t==null||n?1:t)},E.compact=function(e){return E.filter(e,function(e){return!!e})},E.flatten=function(e,t){return E.reduce(e,function(e,n){return E.isArray(n)?e.concat(t?n:E.flatten(n)):(e[e.length]=n,e)},[])},E.without=function(e){return E.difference(e,s.call(arguments,1))},E.uniq=E.unique=function(e,t,n){var r=n?E.map(e,n):e,i=[];return e.length<3&&(t=!0),E.reduce(r,function(n,r,s){if(t?E.last(n)!==r||!n.length:!E.include(n,r))n.push(r),i.push(e[s]);return n},[]),i},E.union=function(){return E.uniq(E.flatten(arguments,!0))},E.intersection=E.intersect=function(e){var t=s.call(arguments,1);return E.filter(E.uniq(e),function(e){return E.every(t,function(t){return E.indexOf(t,e)>=0})})},E.difference=function(e){var t=E.flatten(s.call(arguments,1),!0);return E.filter(e,function(e){return!E.include(t,e)})},E.zip=function(){var e=s.call(arguments),t=E.max(E.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=E.pluck(e,""+r);return n},E.indexOf=function(e,t,n){if(e==null)return-1;var r,i;if(n)return r=E.sortedIndex(e,t),e[r]===t?r:-1;if(m&&e.indexOf===m)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(r in e&&e[r]===t)return r;return-1},E.lastIndexOf=function(e,t){if(e==null)return-1;if(g&&e.lastIndexOf===g)return e.lastIndexOf(t);var n=e.length;while(n--)if(n in e&&e[n]===t)return n;return-1},E.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var T=function(){};E.bind=function(e,t){var n,r;if(e.bind===w&&w)return w.apply(e,s.call(arguments,1));if(!E.isFunction(e))throw new TypeError;return r=s.call(arguments,2),n=function(){if(this instanceof n){T.prototype=e.prototype;var i=new T,o=e.apply(i,r.concat(s.call(arguments)));return Object(o)===o?o:i}return e.apply(t,r.concat(s.call(arguments)))}},E.bindAll=function(e){var t=s.call(arguments,1);return t.length==0&&(t=E.functions(e)),S(t,function(t){e[t]=E.bind(e[t],e)}),e},E.memoize=function(e,t){var n={};return t||(t=E.identity),function(){var r=t.apply(this,arguments);return E.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},E.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},E.defer=function(e){return E.delay.apply(E,[e,1].concat(s.call(arguments,1)))},E.throttle=function(e,t){var n,r,i,s,o,u,a=E.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&e.apply(n,r),a()};return i||(i=setTimeout(f,t)),s?o=!0:u=e.apply(n,r),a(),s=!0,u}},E.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)};n&&!r&&e.apply(i,s),clearTimeout(r),r=setTimeout(o,t)}},E.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments))}},E.wrap=function(e,t){return function(){var n=[e].concat(s.call(arguments,0));return t.apply(this,n)}},E.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},E.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},E.keys=b||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)E.has(e,n)&&(t[t.length]=n);return t},E.values=function(e){return E.map(e,E.identity)},E.functions=E.methods=function(e){var t=[];for(var n in e)E.isFunction(e[n])&&t.push(n);return t.sort()},E.extend=function(e){return S(s.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},E.pick=function(e){var t={};return S(E.flatten(s.call(arguments,1)),function(n){n in e&&(t[n]=e[n])}),t},E.defaults=function(e){return S(s.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e},E.isEqual=function(t,n){return e(t,n,[])},E.isEmpty=function(e){if(e==null)return!0;if(E.isArray(e)||E.isString(e))return e.length===0;for(var t in e)if(E.has(e,t))return!1;return!0},E.isElement=function(e){return!!e&&e.nodeType==1},E.isArray=y||function(e){return u.call(e)=="[object Array]"},E.isObject=function(e){return e===Object(e)},E.isArguments=function(e){return u.call(e)=="[object Arguments]"},E.isArguments(arguments)||(E.isArguments=function(e){return!!e&&!!E.has(e,"callee")}),E.isFunction=function(e){return u.call(e)=="[object Function]"},E.isString=function(e){return u.call(e)=="[object String]"},E.isNumber=function(e){return u.call(e)=="[object Number]"},E.isFinite=function(e){return E.isNumber(e)&&isFinite(e)},E.isNaN=function(e){return e!==e},E.isBoolean=function(e){return e===!0||e===!1||u.call(e)=="[object Boolean]"},E.isDate=function(e){return u.call(e)=="[object Date]"},E.isRegExp=function(e){return u.call(e)=="[object RegExp]"},E.isNull=function(e){return e===null},E.isUndefined=function(e){return e===void 0},E.has=function(e,t){return a.call(e,t)},E.noConflict=function(){return root._=previousUnderscore,this},E.identity=function(e){return e},E.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},E.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},E.result=function(e,t){if(e==null)return null;var n=e[t];return E.isFunction(n)?n.call(e):n},E.mixin=function(e){S(E.functions(e),function(t){P(t,E[t]=e[t])})};var N=0;E.uniqueId=function(e){var t=N++;return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,k={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var L in k)k[k[L]]=L;var A=/\\|'|\r|\n|\t|\u2028|\u2029/g,O=/\\(\\|'|r|n|t|u2028|u2029)/g,M=function(e){return e.replace(O,function(e,t){return k[t]})};E.template=function(e,t,n){n=E.defaults(n||{},E.templateSettings);var r="__p+='"+e.replace(A,function(e){return"\\"+k[e]}).replace(n.escape||C,function(e,t){return"'+\n_.escape("+M(t)+")+\n'"}).replace(n.interpolate||C,function(e,t){return"'+\n("+M(t)+")+\n'"}).replace(n.evaluate||C,function(e,t){return"';\n"+M(t)+"\n;__p+='"})+"';\n";n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+r+"return __p;\n";var i=new Function(n.variable||"obj","_",r);if(t)return i(t,E);var s=function(e){return i.call(this,e,E)};return s.source="function("+(n.variable||"obj")+"){\n"+r+"}",s},E.chain=function(e){return E(e).chain()};var _=function(e){this._wrapped=e};E.prototype=_.prototype;var D=function(e,t){return t?E(e).chain():e},P=function(e,t){_.prototype[e]=function(){var e=s.call(arguments);return o.call(e,this._wrapped),D(t.apply(E,e),this._chain)}};return E.mixin(E),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];_.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);var r=n.length;return(e=="shift"||e=="splice")&&r===0&&delete n[0],D(n,this._chain)}}),S(["concat","join","slice"],function(e){var t=n[e];_.prototype[e]=function(){return D(t.apply(this._wrapped,arguments),this._chain)}}),_.prototype.chain=function(){return this._chain=!0,this},_.prototype.value=function(){return this._wrapped},E}),define("hbs/i18nprecompile",["hbs/handlebars","hbs/underscore"],function(e,t){function n(r,i,s){return s=s||{},i=i||{},r&&r.type==="program"&&r.statements&&(t(r.statements).forEach(function(t,o){var u="<!-- i18n error -->";if(t.type==="mustache"&&t.id&&t.id.original==="$"){if(t.params.length&&t.params[0].string){var a=t.params[0].string;u=i[a]||(s.originalKeyFallback?a:u)}r.statements[o]=new e.AST.ContentNode(u)}else t.program&&(t.program=n(t.program,i,s))}),r.inverse&&n(r.inverse,i,s)),r}return function(t,r,i){i=i||{};var s,o;return s=e.parse(t),r!==!1&&(s=n(s,r,i)),o=(new e.Compiler).compile(s,i),(new e.JavaScriptCompiler).compile(o,i)}}),function(window){var JSON=window.JSON||{};(function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})})(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",["hbs/handlebars","hbs/underscore","hbs/i18nprecompile","hbs/json2"],function(e,t,n,r){var i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=function(){throw new Error("Environment unsupported.")},a=[],f="w+",l="hbs",c="@hbs",h="/styles/",p="/demo-build/styles/",d="templates/helpers/",v="templates/i18n/",m="screen.build.css";e.registerHelper("$",function(){}),typeof window!="undefined"&&window.navigator&&window.document&&!window.navigator.userAgent.match(/Node.js/)?(s=function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return arguments[0]===!0?new XDomainRequest:new XMLHttpRequest;for(t=0;t<3;t++){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},getIEVersion=function(){var e=-1;if(navigator.appName=="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(t)!=null&&(e=parseFloat(RegExp.$1))}return e},u=function(e,t){var n=!1;if(e.indexOf("http")!=0)n=!1;else{var r=e.substr(0,5)==="https"?8:7,i=window.location.href.substr(0,5)==="https"?8:7,o=e.substr(r).split("/").shift(),u=getIEVersion();n=o!=window.location.href.substr(i).split("/").shift()&&u>=7}if(n){var a=s(!0);a.open("GET",e),a.onload=function(){t(a.responseText)},a.onprogress=function(){},a.ontimeout=function(){},a.onerror=function(){},setTimeout(function(){a.send()},0)}else{var f=s();f.open("GET",e,!0),f.onreadystatechange=function(e){f.readyState===4&&t(f.responseText)},f.send(null)}}):typeof process!="undefined"&&process.versions&&!!process.versions.node?(i=require.nodeRequire("fs"),u=function(e,t){var n=i.readFileSync(e,"utf8")||"";n=n.replace(/^\uFEFF/,""),t(n)}):typeof java!="undefined"&&typeof java.io!="undefined"&&(u=function(e,t){var n=new java.io.File(e),r=new java.io.FileReader(n),i=new java.io.BufferedReader(r),s,o="";while((s=i.readLine())!==null)o+=new String(s)+"\n";i.close(),t(o)});var g={},y=function(e,t){g[e]?t(g[e]):u(e,function(n){g[e]=n,t.call(this,n)})},b=[],w={};return{get:function(){return e},write:function(e,t,n){if(t+c in a){var r=a[t+c];n.asModule(e+"!"+t,r)}},version:"0.5.0",load:function(s,o,g,E){function S(e,n){return t(e).forEach(function(e){e&&e.type&&e.type==="partial"&&n.push(e.partialName.name),e&&e.program&&e.program.statements&&S(e.program.statements,n),e&&e.program&&e.program.inverse&&e.program.inverse.statements&&S(e.program.inverse.statements,n)}),n}function x(e){var n=[];return e&&e.statements&&(n=S(e.statements,[])),t(n).unique()}function T(e){var t,n,i;if(e&&e.statements){t=e.statements[0];if(t&&t.type==="comment")try{return n=t.comment.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),i=r.parse(n),n}catch(s){return'{ "description" : "'+t.comment+'" }'}}return"{}"}function N(e){if(!e)return[];var t=[e[0]],n=e[0],r;for(r=1;r<e.length;++r)e.hasOwnProperty(r)&&(n+="."+e[r],t.push(n));return t}function C(n,r,i,s){i=i?i+".":"";var o="",u=!1;return t(n).forEach(function(n){var u,a,f;if(n&&n.type&&n.type==="mustache"){if(!n.params||!n.params.length){u=N(n.id.parts);for(a in u)u[a]&&(o=u[a]||o,r.push(i+u[a]));r.push(i+n.id.string)}var l=["this",".","..","./..","../..","../../.."];n.params&&typeof e.helpers[n.id.string]=="undefined"&&t(n.params).forEach(function(a){(t(l).contains(a.original)||a instanceof e.AST.StringNode||a instanceof e.AST.IntegerNode||a instanceof e.AST.BooleanNode)&&s.push(n.id.string),u=N(a.parts);for(var f in u)u[f]&&(o=u[f]||o,s.push(n.id.string),r.push(i+u[f]))})}n&&n.mustache&&C([n.mustache],r,i+o,s),n&&n.program&&n.program.statements&&(f=C([n.mustache],[],"",s)[0]||"",n.program.inverse&&n.program.inverse.statements&&C(n.program.inverse.statements,r,i+o+(f?i+o?"."+f:f:""),s),C(n.program.statements,r,i+o+(f?i+o?"."+f:f:""),s))}),r}function k(e){var n=[],r=[];e&&e.statements&&(n=C(e.statements,[],undefined,r));var i=["helperMissing","blockHelperMissing","each","if","unless","with"];return{vars:t(n).chain().unique().map(function(e){return e===""?".":e.length&&e[e.length-1]==="."?e.substr(0,e.length-1)+"[]":e}).value(),helpers:t(r).chain().unique().map(function(e){return t(i).contains(e)?undefined:e}).compact().value()}}function L(e){var t=e.split("/");for(var n=0;n<t.length;n++)t[n]==".."&&(delete t[n-1],delete t[n]);return t.join("/").replace(/\/\/+/g,"/")}function A(l){u(H,function(u){var c=e.parse(u),v=x(c),y=T(c),S=k(c),N=S.vars,C=S.helpers||[],A="",P="",H="",B=[],j,F,I,q,R,U=s.substr(0,s.lastIndexOf("/")+1);require.config.hbs=require.config.hbs||{},require.config.hbs._partials=require.config.hbs._partials||{};if(y!=="{}")try{I=r.parse(y)}catch(z){console.log("couldn't parse meta for %s",V)}for(var W in v)if(v.hasOwnProperty(W)&&typeof v[W]=="string"){var X=v[W],V;X.match(/^(\.|\/)+/)?V=L(U+X):V=L(D+X),require.config.hbs._partials[V]=require.config.hbs._partials[V]||[],require.config.hbs._partials[V].references=require.config.hbs._partials[V].references||[],require.config.hbs._partials[V].references.push(X),require.config.hbs._loadedDeps=require.config.hbs._loadedDeps||{},B[W]="hbs!"+V}j=B.join("', '"),C=C.concat(I&&I.helpers?I.helpers:[]),F=_?"":function(){var e,t=[],n=E.hbs&&E.hbs.helperPathCallback?E.hbs.helperPathCallback:function(e){return(E.hbs&&E.hbs.helperDirectory?E.hbs.helperDirectory:d)+e};for(e=0;e<C.length;e++)t[e]="'"+n(C[e],V)+"'";return t}().join(","),F&&(F=","+F);if(I)try{I.styles&&(b=t.union(b,I.styles),require.isBrowser&&!E.isBuild?(q=document.head||document.getElementsByTagName("head")[0],t(I.styles).forEach(function(e){w[e]||(R=document.createElement("link"),R.href=E.baseUrl+h+e+".css",R.media="all",R.rel="stylesheet",R.type="text/css",q.appendChild(R),w[e]=R)})):E.isBuild&&function(){var e=require.nodeRequire("fs"),n=t(I.styles).map(function(e){return w[e]?"":(w[e]=!0,"@import url("+e+".css);\n")}).join("\n");e.open(__dirname+p+m,f,"0666",function(t,r){e.writeSync(r,n,null,encoding="utf8"),e.close(r)}),f="a"}())}catch(z){console.log("error injecting styles")}!E.isBuild&&!E.serverRender&&(A="<!-- START - "+s+" -->",P="<!-- END - "+s+" -->",H="t.meta = "+y+";\n"+"t.helpers = "+r.stringify(C)+";\n"+"t.deps = "+r.stringify(B)+";\n"+"t.vars = "+r.stringify(N)+";\n");var $=M?!1:t.extend(l,E.localeMapping),J=E.hbs||{},K=t.extend(J.compileOptions||{},{originalKeyFallback:J.originalKeyFallback}),Q=n(u,$,K),G=E.isBuild?"":"'"+s+"',";j&&(j=", '"+j+"'");var Y=[];require.config.hbs._partials[s]&&(Y=require.config.hbs._partials[s].references),u="/* START_TEMPLATE */\ndefine("+G+"['hbs','hbs/handlebars'"+j+F+"], function( hbs, Handlebars ){ \n"+"var t = Handlebars.template("+Q+");\n";for(var W=0;W<Y.length;W++)u+="Handlebars.registerPartial('"+Y[W]+"', t);\n";u+=H+"return t;\n"+"});\n"+"/* END_TEMPLATE */\n",E.isBuild&&(a[O]=u),E.isBuild||(u+="\r\n//@ sourceURL="+V),E.isBuild?(g.fromText(s,u),o([s],function(e){g(e)})):require(B,function(){g.fromText(u),o([s],function(e){g(e)})}),E.removeCombined&&i.unlinkSync(V)})}var O=s+c;E.hbs=E.hbs||{};var M=E.hbs.i18n!=1,_=E.hbs.helpers==0,D="";E.hbs.partialsUrl&&(D=E.hbs.partialsUrl,D.match(/\/$/)||(D+="/"));var P=[],H,B=E.hbs&&E.hbs.templateExtension===!1;B?H=o.toUrl(s):H=o.toUrl(s+"."+(E.hbs&&E.hbs.templateExtension?E.hbs.templateExtension:l));if(M)A(!1);else{var j=(E.hbs&&E.hbs.i18nDirectory?E.hbs.i18nDirectory:v)+(E.locale||"en_us")+".json";try{y(o.toUrl(j),function(e){A(r.parse(e))})}catch(F){if(!!E.hbs)throw F;console.warn("hbs: Error reading "+j+", disabling i18n. Ignore this if you're using jam, otherwise check your i18n configuration.\n"),E.hbs={i18n:!1,helpers:!0},A(!1)}}}}}),define("hbs!aura_components/arrow/arrow",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="rd-arrow-',(o=n.direction)?o=o.call(t,{hash:{}}):(o=t&&t.direction,o=typeof o===u?o.call(t,{hash:{}}):o),s+=a(o)+'">&nbsp;</div>',s});return n}),define("./__component__$arrow@default",["underscore","i18n!nls/text","hbs!aura_components/arrow/arrow"],function(e,t,n){return{View:{events:{click:function(e){this.sandbox.pages.set("currentIndex",this.component.options.direction==="prev"?"-":"+")}}},initialize:function(){e.bindAll(this,"displayChanged","checkDisplayArrow"),this.sandbox.on("reader.viewport.display.changed",this.displayChanged),this.sandbox.on("reader.pages.currentIndex.changed",this.checkDisplayArrow),this.render()},render:function(){this.html(n(this.options)),this.sandbox.emit("reader.arrows.rendered")},checkDisplayArrow:function(e){var t=this.sandbox.pages.indexOf(e);t===0&&this.options.direction==="prev"?this.$el.css("visibility","hidden"):t===this.sandbox.pages.length()-1&&this.options.direction==="next"?this.$el.css("visibility","hidden"):this.$el.css("visibility")==="hidden"&&this.$el.css("visibility","visible")},displayChanged:function(e){e!=="slideshow"&&this.sandbox.stop()}}}),define("hbs!aura_components/extract-message/extract-message",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var n="",r;return n+='\r\n                        <p class="extract-block-msg2">\r\n                            '+d((r=(r=e&&e.text,r==null||r===!1?r:r.extractMessage),typeof r===p?r.apply(e):r))+"\r\n                        </p>\r\n                    ",n}function o(e,t){var r="",i,s;return r+='\r\n                        <div class="extract-block-valid">\r\n                            <a href="',(i=n.subscribeUrl)?i=i.call(e,{hash:{}}):(i=e&&e.subscribeUrl,i=typeof i===p?i.call(e,{hash:{}}):i),r+=d(i)+'" class="Extractbtn tracking-sub-extract" ',(i=n.embedPopup)?i=i.call(e,{hash:{}}):(i=e&&e.embedPopup,i=typeof i===p?i.call(e,{hash:{}}):i),r+=d(i)+">\r\n                                "+d((i=(i=e&&e.text,i==null||i===!1?i:i.startTry),typeof i===p?i.apply(e):i))+'\r\n                            </a>\r\n                        </div>\r\n                        <div class="extract-block-valid2">\r\n                            <a href="',(s=n.aboUrl)?s=s.call(e,{hash:{}}):(s=e&&e.aboUrl,s=typeof s===p?s.call(e,{hash:{}}):s),r+=d(s)+'" ',(s=n.embedPopup)?s=s.call(e,{hash:{}}):(s=e&&e.embedPopup,s=typeof s===p?s.call(e,{hash:{}}):s),r+=d(s)+' class="tracking-sub-more">\r\n                                '+d((i=(i=e&&e.text,i==null||i===!1?i:i.moreInfo),typeof i===p?i.apply(e):i))+"\r\n                            </a>\r\n                        </div>\r\n                    ",r}function u(e,t){var r="",i;r+="\r\n                        ",i=n["if"].call(e,e&&e.buyableUrl,{hash:{},inverse:v.program(8,f,t),fn:v.program(6,a,t)});if(i||i===0)r+=i;return r+="\r\n                    ",r}function a(e,t){var r="",i,s;return r+='\r\n                            <div class="extract-block-valid">\r\n                                <a href="',(i=n.buyableUrl)?i=i.call(e,{hash:{}}):(i=e&&e.buyableUrl,i=typeof i===p?i.call(e,{hash:{}}):i),r+=d(i)+'" class="Extractbtn tracking-buy-extract" ',(i=n.embedPopup)?i=i.call(e,{hash:{}}):(i=e&&e.embedPopup,i=typeof i===p?i.call(e,{hash:{}}):i),r+=d(i)+">\r\n                                    "+d((i=(i=e&&e.text,i==null||i===!1?i:i.buy),typeof i===p?i.apply(e):i))+" ",(s=n.price)?s=s.call(e,{hash:{}}):(s=e&&e.price,s=typeof s===p?s.call(e,{hash:{}}):s),r+=d(s)+"€\r\n                                </a>\r\n                            </div>\r\n                        ",r}function f(e,t){var r="",i;return r+='\r\n                            <div class="extract-block-valid">\r\n                                <a href="',(i=n.aboUrl)?i=i.call(e,{hash:{}}):(i=e&&e.aboUrl,i=typeof i===p?i.call(e,{hash:{}}):i),r+=d(i)+'" class="Extractbtn tracking-sub-extract" ',(i=n.embedPopup)?i=i.call(e,{hash:{}}):(i=e&&e.embedPopup,i=typeof i===p?i.call(e,{hash:{}}):i),r+=d(i)+">\r\n                                    "+d((i=(i=e&&e.text,i==null||i===!1?i:i.startTry),typeof i===p?i.apply(e):i))+"\r\n                                </a>\r\n                            </div>\r\n                        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var l="",c,h,p="function",d=this.escapeExpression,v=this;l+='<div id="extract-block">\r\n    <div class="subcontainer">\r\n        <div class="extract-block-img">\r\n            <div>\r\n                <img src="',(c=n.productUrlImage)?c=c.call(t,{hash:{}}):(c=t&&t.productUrlImage,c=typeof c===p?c.call(t,{hash:{}}):c),l+=d(c)+'" alt=""/>\r\n            </div>\r\n        </div>\r\n        <div class="extract-block-msg">\r\n            <div class="subcontainer">\r\n                <div class="extract-block1-msg">\r\n                    <p class="extract-block-msg1">\r\n                        '+d((c=(c=t&&t.text,c==null||c===!1?c:c.extractQuestion),typeof c===p?c.apply(t):c))+"\r\n                    </p>\r\n\r\n                    ",h=n["if"].call(t,t&&t.isSubscription,{hash:{},inverse:v.noop,fn:v.program(1,s,i)});if(h||h===0)l+=h;l+='\r\n                </div>\r\n                <div class="extract-block2-msg">\r\n                    ',h=n["if"].call(t,t&&t.subscribeUrl,{hash:{},inverse:v.program(5,u,i),fn:v.program(3,o,i)});if(h||h===0)l+=h;return l+="\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>",l});return n}),define("./__component__$extract-message@default",["underscore","i18n!nls/text","hbs!aura_components/extract-message/extract-message"],function(e,t,n){return{initialize:function(){this.options={},this.render()},render:function(){var e=this.sandbox.reader.get("offers");this.options.text=t,this.options.aboUrl=this.sandbox.util.url.getAbo(),e.indexOf("Subscription")!==-1?(this.options.subscribeUrl=this.sandbox.util.url.getSubscription(),this.options.isSubscription=!0):e.indexOf("Buyable")!==-1&&(this.options.price=this.sandbox.reader.get("price"),this.options.buyableUrl=this.sandbox.util.url.getAddToCart()),this.options.embedPopup=this.sandbox.reader.get("embed")?'target="_blank"':"",this.options.productUrlImage=this.sandbox.util.url.getImageProduct(),this.html(n(this.options))}}}),define("hbs!aura_components/message/message",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function";s+='<div class="rd-str-message">\r\n    ',(o=n.message)?o=o.call(t,{hash:{}}):(o=t&&t.message,o=typeof o===u?o.call(t,{hash:{}}):o);if(o||o===0)s+=o;return s+="\r\n</div>\r\n",s});return n}),define("./__component__$message@default",["underscore","hbs!aura_components/message/message"],function(e,t){return{initialize:function(){var e=this.sandbox.reader.get("message");this.render({message:e}),this.sandbox.emit("reader.viewport.ready")},render:function(e){return this.html(t(e)),this}}}),define("./__component__$popin-download@default",["underscore","i18n!nls/text"],function(e,t){return{initialize:function(){e.bindAll(this,"render","logged"),this.sandbox.on("popin.logged",this.logged),this.$el.html("<div class='loading'></div>"),this.sandbox.popin.getTemplate("download",this.render)},logged:function(){this.$el.html("<div class='loading'></div>"),this.sandbox.popin.getTemplate("download",this.render)},render:function(e){this.html(e),this.sandbox.emit("reader.popin.rendered",{type:this.$el.find(".ys_98567_reader_nav_options_close").length>0?"login":"download",$content:this.$el})}}}),define("templates/helpers/compare",["hbs/handlebars"],function(e){function t(e,t,n){if(arguments.length!==3)throw new Error("Handlerbars Helper 'compare' needs 3 parameters");var r=n.hash.operator||"==",i={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"||":function(e,t){return e||t},"!=":function(e,t){return e!=t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},"typeof":function(e,t){return typeof e==t}};if(!i[r])throw new Error("Handlerbars Helper 'compare' doesn't know the operator "+r);var s=i[r](e,t);return s?n.fn(this):n.inverse(this)}return e.registerHelper("compare",t),t}),define("hbs!aura_components/popin-embed/popin-embed",["hbs","hbs/handlebars","templates/helpers/compare"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var r="",i;return r+='\r\n                    <input id="width" type="text" name="width" value="',(i=n.defaultWidth)?i=i.call(e,{hash:{}}):(i=e&&e.defaultWidth,i=typeof i===c?i.call(e,{hash:{}}):i),r+=h(i)+'" class="ys_98567_txt_num update custom_width" />\r\n                ',r}function o(e,t){var r="",i;return r+='\r\n                    <input id="width" type="text" name="width" value="',(i=n.width)?i=i.call(e,{hash:{}}):(i=e&&e.width,i=typeof i===c?i.call(e,{hash:{}}):i),r+=h(i)+'" class="ys_98567_txt_num update custom_width" />\r\n                ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var u="",a,f,l,c="function",h=this.escapeExpression,p=this,d=n.helperMissing;u+='\r\n<form id="embed-form">\r\n\r\n    <div class="ys_98567_str-ctn1">\r\n        <div class="ys_98567_reader_options_embed_display embed_display">\r\n            <span>'+h((a=(a=t&&t.text,a==null||a===!1?a:a.displayMode),typeof a===c?a.apply(t):a))+' :</span>\r\n            <div title="'+h((a=(a=t&&t.text,a==null||a===!1?a:a.displayScroll),typeof a===c?a.apply(t):a))+'" class="ys_98567_options_embed_display_infinite rd-embed-display active" data-value="scroll">&nbsp;</div>\r\n            <div title="'+h((a=(a=t&&t.text,a==null||a===!1?a:a.displayDouble),typeof a===c?a.apply(t):a))+'" class="ys_98567_options_embed_display_double  rd-embed-display" data-value="double">&nbsp;</div>\r\n            <div title="'+h((a=(a=t&&t.text,a==null||a===!1?a:a.displaySlide),typeof a===c?a.apply(t):a))+'" class="ys_98567_options_embed_display_slideshow  rd-embed-display" data-value="slideshow">&nbsp;</div>\r\n        </div>\r\n        <div class="ys_98567_reader_options_embed_flex">\r\n            <input id="embed-flex" type="radio" checked="checked" name="embed_size" value="flex" class="rd-flex" />\r\n            <label for="embed-flex" class="ys_98567_popin_embed_options">\r\n                '+h((a=(a=t&&t.text,a==null||a===!1?a:a.flexWidthAndHeight),typeof a===c?a.apply(t):a))+'\r\n            </label>\r\n        </div>\r\n        <div class="ys_98567_reader_options_embed_custom">\r\n            <input id="ys_98567_options_embed_perso" type="radio" name="embed_size" value="custom" class="rd-custom"/>\r\n            <label for="ys_98567_options_embed_perso" class="ys_98567_popin_embed_options">\r\n                '+h((a=(a=t&&t.text,a==null||a===!1?a:a.width),typeof a===c?a.apply(t):a))+'\r\n                <div class="ys_98567_input_txt">\r\n                \r\n                ',l={hash:{operator:"=="},inverse:p.noop,fn:p.program(1,s,i)},f=(a=n.compare||t&&t.compare,a?a.call(t,t&&t.width,"100%",l):d.call(t,"compare",t&&t.width,"100%",l));if(f||f===0)u+=f;u+="\r\n                ",l={hash:{operator:"!="},inverse:p.noop,fn:p.program(3,o,i)},f=(a=n.compare||t&&t.compare,a?a.call(t,t&&t.width,"100%",l):d.call(t,"compare",t&&t.width,"100%",l));if(f||f===0)u+=f;return u+='\r\n                </div>\r\n                px \r\n            </label>\r\n        </div>\r\n        <div class="ys_98567_reader_options_embed_start">\r\n            '+h((a=(a=t&&t.text,a==null||a===!1?a:a.startPage),typeof a===c?a.apply(t):a))+'<div class="ys_98567_input_txt">\r\n            <input id="Text2" type="text" name="firstpage" value="1" class="ys_98567_txt_num update start_page" /></div>\r\n        </div> \r\n    </div><!--\r\n --><div class="ys_98567_str-ctn2">\r\n        <div class="ys_98567_reader_options_embed_code">\r\n            <p>'+h((a=(a=t&&t.text,a==null||a===!1?a:a.copyAndPaste),typeof a===c?a.apply(t):a))+' :</p>\r\n            <textarea name="embed-code"></textarea>\r\n        </div>      \r\n    </div>\r\n\r\n\r\n    <div class="ys_98567_str-ctn-actions">\r\n        <div class="ys_98567_str-next-step">\r\n            Suivant\r\n        </div>\r\n        <div class="ys_98567_str-previous-step">\r\n            Précédent\r\n        </div>\r\n        <a target="_blank" class="ys_98567_button_preview embed-preview" title="'+h((a=(a=t&&t.text,a==null||a===!1?a:a.preview),typeof a===c?a.apply(t):a))+'">'+h((a=(a=t&&t.text,a==null||a===!1?a:a.preview),typeof a===c?a.apply(t):a))+"</a>\r\n    </div>\r\n</form>\r\n\r\n\r\n",u});return n}),define("./__component__$popin-embed@default",["underscore","i18n!nls/text","hbs!aura_components/popin-embed/popin-embed"],function(e,t,n){return{initialize:function(){e.bindAll(this,"render"),this.getEmbedCode()},getEmbedCode:function(){this.sandbox.util.request({url:"/BookReader/EmbedCode",data:this.sandbox.reader.get("productId","documentId"),jsonp:!0,success:this.render})},render:function(e){var r=this.sandbox.popin.embed.get();r.text=t,this.html(n(r));var i=this.sandbox.pages.at(0),s={$ctn:this.$el,code:e.code,productId:this.sandbox.reader.get("productId"),ratio:this.sandbox.reader.get("ratio"),toolbarHeight:this.sandbox.toolbar.get("height"),width:i.get("$content").width(),height:i.get("$content").height()};this.sandbox.emit("reader.popin.rendered",{type:"embed",$content:this.$el,options:s})}}}),define("./__component__$popin-library@default",["underscore","i18n!nls/text"],function(e,t){return{initialize:function(){e.bindAll(this,"render","submitted","logged"),this.sandbox.on("popin.logged",this.logged),this.$el.html("<div class='loading'></div>"),this.sandbox.popin.getTemplate("library",this.render)},logged:function(){this.$el.html("<div class='loading'></div>"),this.sandbox.popin.getTemplate("library",this.render)},submitted:function(e,t){t.IsValid&&window.setTimeout(function(){this.sandbox.emit("reader.popin.close")},2e3)},render:function(e){this.html(e),this.$el.find("#add_to_library_form").on("submitted",this.submitted),this.sandbox.emit("reader.popin.rendered",{type:this.$el.find(".ys_98567_reader_nav_options_close").length>0?"login":"library",$content:this.$el})}}}),define("hbs!aura_components/popin-search/popin-search",["hbs","hbs/handlebars","templates/helpers/compare"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var r="",i,s,u;r+=" \r\n<div class='ys_98567_search-result'>\r\n	",u={hash:{operator:">"},inverse:E.program(7,f,t),fn:E.program(2,o,t),data:t},s=(i=n.compare||e&&e.compare,i?i.call(e,(i=e&&e.found,i==null||i===!1?i:i.length),0,u):S.call(e,"compare",(i=e&&e.found,i==null||i===!1?i:i.length),0,u));if(s||s===0)r+=s;return r+="\r\n</div>\r\n",r}function o(e,t){var r="",i,s,o;r+="\r\n		<div class='ys_98567_search-header'>\r\n			",o={hash:{operator:">"},inverse:E.noop,fn:E.program(3,u,t),data:t},s=(i=n.compare||e&&e.compare,i?i.call(e,(i=e&&e.found,i==null||i===!1?i:i.length),1,o):S.call(e,"compare",(i=e&&e.found,i==null||i===!1?i:i.length),1,o));if(s||s===0)r+=s;r+="		\r\n			<div class='ys_98567_search-count'>\r\n				",(s=n.total)?s=s.call(e,{hash:{},data:t}):(s=e&&e.total,s=typeof s===b?s.call(e,{hash:{},data:t}):s),r+=w(s)+" "+w((i=(i=e&&e.text,i==null||i===!1?i:i.results),typeof i===b?i.apply(e):i))+"\r\n			</div>\r\n		</div>\r\n		<div class='ys_98567_search-result-list'>\r\n			<table>\r\n				",s=n.each.call(e,e&&e.found,{hash:{},inverse:E.noop,fn:E.program(5,a,t),data:t});if(s||s===0)r+=s;return r+="\r\n			</table>\r\n		</div>\r\n	",r}function u(e,t){var r="",i,s;return r+="\r\n				<div class='ys_98567_search-nav'>\r\n					<input type='button' value='"+w((i=(i=e&&e.text,i==null||i===!1?i:i.previous),typeof i===b?i.apply(e):i))+"' title='"+w((i=(i=e&&e.text,i==null||i===!1?i:i.previous),typeof i===b?i.apply(e):i))+"' class='arrow prev'></input>\r\n					<span class='current'>",(s=n.current)?s=s.call(e,{hash:{},data:t}):(s=e&&e.current,s=typeof s===b?s.call(e,{hash:{},data:t}):s),r+=w(s)+"</span> / ",(s=n.total)?s=s.call(e,{hash:{},data:t}):(s=e&&e.total,s=typeof s===b?s.call(e,{hash:{},data:t}):s),r+=w(s)+"\r\n					<input type='button' value='"+w((i=(i=e&&e.text,i==null||i===!1?i:i.next),typeof i===b?i.apply(e):i))+"' title='"+w((i=(i=e&&e.text,i==null||i===!1?i:i.next),typeof i===b?i.apply(e):i))+"' class='arrow next'></input>\r\n				</div>\r\n			",r}function a(e,t){var r="",i,s;return r+="\r\n					<tr>\r\n						<td class='foundWord' data-index='"+w((i=(i=t,i==null||i===!1?i:i.index),typeof i===b?i.apply(e):i))+"'>\r\n							",(s=n.summary)?s=s.call(e,{hash:{},data:t}):(s=e&&e.summary,s=typeof s===b?s.call(e,{hash:{},data:t}):s),r+=w(s)+"\r\n						</td>\r\n						<td class='foundWordLine' data-index='"+w((i=(i=t,i==null||i===!1?i:i.index),typeof i===b?i.apply(e):i))+"'>\r\n							P. ",(s=n.page)?s=s.call(e,{hash:{},data:t}):(s=e&&e.page,s=typeof s===b?s.call(e,{hash:{},data:t}):s),r+=w(s)+"\r\n						</td>\r\n					</tr>\r\n				",r}function f(e,t){var r="",i,s;return r+="\r\n		0 "+w((i=(i=e&&e.text,i==null||i===!1?i:i.resultOf),typeof i===b?i.apply(e):i))+"  <b>",(s=n.word)?s=s.call(e,{hash:{},data:t}):(s=e&&e.word,s=typeof s===b?s.call(e,{hash:{},data:t}):s),r+=w(s)+"</b>\r\n	",r}function l(e,t){var r="",i,s;r+="\r\n<div class='ys_98567_search-history'>\r\n	<span class=\"ys_98567_search-history-title\"> "+w((i=(i=e&&e.text,i==null||i===!1?i:i.historic),typeof i===b?i.apply(e):i))+" :</span>\r\n	",s=n.each.call(e,e&&e.history,{hash:{},inverse:E.noop,fn:E.programWithDepth(10,c,t,e),data:t});if(s||s===0)r+=s;return r+="\r\n</div>\r\n",r}function c(e,t,r){var i="",s,o,u;i+="\r\n		",u={hash:{operator:">"},inverse:E.noop,fn:E.program(11,h,t),data:t},o=(s=n.compare||e&&e.compare,s?s.call(e,(s=t,s==null||s===!1?s:s.index),0,u):S.call(e,"compare",(s=t,s==null||s===!1?s:s.index),0,u));if(o||o===0)i+=o;i+="\r\n		",u={hash:{operator:"==="},inverse:E.programWithDepth(15,d,t,e),fn:E.programWithDepth(13,p,t,e),data:t},o=(s=n.compare||e&&e.compare,s?s.call(e,e,r&&r.word,u):S.call(e,"compare",e,r&&r.word,u));if(o||o===0)i+=o;return i+="\r\n	",i}function h(e,t){return"\r\n			-\r\n		"}function p(e,t,n){var r="";return r+="\r\n			<span class='historyWord selected' data-word='"+w(typeof n===b?n.apply(e):n)+"'>"+w(typeof n===b?n.apply(e):n)+"</span>\r\n		",r}function d(e,t,n){var r="";return r+="\r\n			<span class='historyWord' data-word='"+w(typeof n===b?n.apply(e):n)+"'>"+w(typeof n===b?n.apply(e):n)+"</span>\r\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var v="",m,g,y,b="function",w=this.escapeExpression,E=this,S=n.helperMissing;v+="<div class='ys_98567_search-form-ctn'>\r\n	<div class='ys_98567_search-form'>\r\n		<input type='text' class='value' placeholder=\""+w((m=(m=t&&t.text,m==null||m===!1?m:m.searchIntoTheDocument),typeof m===b?m.apply(t):m))+"\" value='",(g=n.word)?g=g.call(t,{hash:{},data:i}):(g=t&&t.word,g=typeof g===b?g.call(t,{hash:{},data:i}):g),v+=w(g)+"'></input>\r\n		<input type='button' value='search' class='search'></input>\r\n	</div>\r\n	<div class='loading' style='display:none;'></div>\r\n</div>\r\n\r\n\r\n",g=n["if"].call(t,t&&t.word,{hash:{},inverse:E.noop,fn:E.program(1,s,i),data:i});if(g||g===0)v+=g;v+="\r\n\r\n",y={hash:{operator:">"},inverse:E.noop,fn:E.program(9,l,i),data:i},g=(m=n.compare||t&&t.compare,m?m.call(t,(m=t&&t.history,m==null||m===!1?m:m.length),0,y):S.call(t,"compare",(m=t&&t.history,m==null||m===!1?m:m.length),0,y));if(g||g===0)v+=g;return v+="\r\n",v});return n}),define("./__component__$popin-search@default",["underscore","i18n!nls/text","hbs!aura_components/popin-search/popin-search"],function(e,t,n){return{View:{events:{"click .prev":function(){this.sandbox.search.goToPrev(1)},"click .next":function(){this.sandbox.search.goToNext(1)},"keydown .value":function(e){e.keyCode===13&&this.$el.find(".search").click()},"click .search":function(){var e=this.$el.find(".value").val();this.sandbox.search.add(e)},"click .historyWord":function(e){var t=$(e.currentTarget).data("word");this.sandbox.search.add(t)},"click .foundWord":function(e){var t=$(e.currentTarget).data("index");this.sandbox.search.goTo(t)}}},initialize:function(){e.bindAll(this,"render","close","highLightChanged"),this.sandbox.on("reader.search.found",this.render),this.sandbox.on("reader.popin.close",this.close),this.sandbox.on("reader.search.currentHighLight.changed",this.highLightChanged);var t=this.sandbox.search.getHistory();this.render({history:t})},close:function(){this.sandbox.search.set("current",null)},highLightChanged:function(e){return this.$el.find(".current").html(e),this},render:function(e){return e.text=t,this.html(n(e)),this.sandbox.emit("reader.popin.rendered",{type:"search",$content:this.$el}),this}}}),define("hbs!aura_components/popin-share/popin-share",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u,a="function",f=this.escapeExpression;return s+='<div class="ys_98567_reader_options_share">\r\n    <div title="'+f((o=(o=t&&t.text,o==null||o===!1?o:o.twitter),typeof o===a?o.apply(t):o))+'" class="ys_98567_options_share_twitter twitter_pop" data-href="',(u=n.twitterUrl)?u=u.call(t,{hash:{}}):(u=t&&t.twitterUrl,u=typeof u===a?u.call(t,{hash:{}}):u),s+=f(u)+'">&nbsp;</div>\r\n    <div title="'+f((o=(o=t&&t.text,o==null||o===!1?o:o.shareOnFacebook),typeof o===a?o.apply(t):o))+'" class="ys_98567_options_share_fb facebook_pop" data-href="',(u=n.facebookUrl)?u=u.call(t,{hash:{}}):(u=t&&t.facebookUrl,u=typeof u===a?u.call(t,{hash:{}}):u),s+=f(u)+'">&nbsp;</div>\r\n    <div title="'+f((o=(o=t&&t.text,o==null||o===!1?o:o.googleLike),typeof o===a?o.apply(t):o))+'" class="ys_98567_options_share_likegoogle social_pop" data-href="',(u=n.googlePlusUrl)?u=u.call(t,{hash:{}}):(u=t&&t.googlePlusUrl,u=typeof u===a?u.call(t,{hash:{}}):u),s+=f(u)+'">&nbsp;</div>\r\n    <div title="'+f((o=(o=t&&t.text,o==null||o===!1?o:o.sendByEmail),typeof o===a?o.apply(t):o))+'" class="ys_98567_options_share_email">&nbsp;</div>\r\n</div>',s});return n}),define("./__component__$popin-share@default",["underscore","i18n!nls/text","hbs!aura_components/popin-share/popin-share"],function(e,t,n){return{View:{events:{"click .ys_98567_options_share_email":function(){this.sandbox.popin.getTemplate("mail",this.component.renderMail)},"click #ys_98567_popup_email_valid_btn":function(e){$(e.currentTarget).valid()!==!0&&this.sandbox.emit("reader.popin.previous")}}},initialize:function(){e.bindAll(this,"render","renderMail","submitted"),this.sandbox.popin.getSocialLinks($.proxy(function(e){this.render(e)},this))},render:function(e){return this.html(n(e)),this.sandbox.emit("reader.popin.rendered",{type:"share",$content:this.$el}),this},submitted:function(e,t){t.IsValid&&window.setTimeout(function(){this.sandbox.emit("reader.popin.close")},2e3)},renderMail:function(e){e.text=t,this.html(e),this.$el.find("form").on("submitted",this.submitted),this.sandbox.emit("reader.popin.rendered",{type:"mail",$content:this.$el})}}}),define("hbs!aura_components/reader/reader",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){return'\r\n			<div data-aura-component="toolbar" class="ys_98567_reader_navbar_container"></div>\r\n		'}function o(e,t){return'\r\n			<div data-aura-component="message" class=""></div>\r\n		'}function u(e,t){var r="",i;return r+='\r\n				\r\n				<div class="rd-viewport" tabindex="0" data-aura-component="viewport" id="ysctn5_',(i=n.documentId)?i=i.call(e,{hash:{}}):(i=e&&e.documentId,i=typeof i===l?i.call(e,{hash:{}}):i),r+=c(i)+'" style="background-color: ',(i=n.backgroundColor)?i=i.call(e,{hash:{}}):(i=e&&e.backgroundColor,i=typeof i===l?i.call(e,{hash:{}}):i),r+=c(i)+'"></div>\r\n			',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var a="",f,l="function",c=this.escapeExpression,h=this;a+="<div class='rd-str-body'>\r\n	<div class='rd-str-area-free top'>  \r\n		",f=n["if"].call(t,t&&t.toolbarDisplay,{hash:{},inverse:h.noop,fn:h.program(1,s,i)});if(f||f===0)a+=f;a+="\r\n		",f=n["if"].call(t,t&&t.messageDisplay,{hash:{},inverse:h.noop,fn:h.program(3,o,i)});if(f||f===0)a+=f;a+="\r\n	</div>    \r\n	<div class='rd-str-area middle'>\r\n		<div class='rd-str-area-column rd-viewport-ctn '>\r\n			",f=n["if"].call(t,t&&t.viewportDisplay,{hash:{},inverse:h.noop,fn:h.program(5,u,i)});if(f||f===0)a+=f;return a+="\r\n		</div>   \r\n	</div>\r\n</div>\r\n",a});return n}),define("./__component__$reader@default",["underscore","hbs!aura_components/reader/reader"],function(e,t){window.require.locale="en";var n=$("html, body"),r=$(window);return{initialize:function(){e.bindAll(this,"render","fullscreenChanged","checkWidth"),this.sandbox.on("reader.render",this.render),this.sandbox.on("window.resized",this.sandbox.reader.updateOffsetPositions),this.sandbox.binders.get("fullscreen").add("through",this.fullscreenChanged,this.sandbox.binders.order.first),this.$el.addClass("rd-reader"),this.sandbox.reader.set("$element",this.$el),this.sandbox.reader.set("cover",this.$el.find(".cover img")[0]),this._setSize(),this.sandbox.reader.getInfo()},render:function(e){this._checkPreloadPages(),e.backgroundColor=this.sandbox.reader.get("profile")?this.sandbox.reader.get("profile").backgroundColor:null,this.html(t(e)),this.sandbox.reader.updateOffsetPositions()},checkWidth:function(){this.sandbox.reader.set("width",this.$el.width())},fullscreenChanged:function(e){if(this.sandbox.reader.get("embed"))return;e?(this.$el.css({position:"fixed",top:0,left:0,"z-index":1e3}),n.css("position","fixed"),r.scrollTop(this.sandbox.reader.get("offset").top)):(this.$el.css({position:"",top:"",left:"","z-index":""}),n.css("position",""))},_checkPreloadPages:function(){var e=this.$el.find(".preload");if(e.length>0&&this.sandbox.reader.get("capacities").html){var t=this.sandbox;e.children().each(function(e,n){var r=e,i=t.reader.get("previewPages").length;t.reader.get("previewPages").length===0&&(r=parseInt($(n).attr("nb"))-1,i=t.pages.get("nbTotal")-1);if(r<i){var s=t.pages.at(r);t.content.setContent(s,this),s.set("state",t.pages.STATES.preLoaded)}}),e.remove()}},_setSize:function(){var e={width:this.sandbox.reader.get("width"),flexible:!1};if(e.width[e.width.length-1]==="%"||e.width==="auto"){var t=e.width==="auto"?100:parseInt(e.width,10),n=Math.round(this.$el.parent().width()*t/100);e.flexible=!0,e.width=n,this.$el.width(t+"%"),this.sandbox.loop.add("reader",this.checkWidth)}else e.width=parseInt(e.width,10),this.$el.width(e.width);this.sandbox.reader.set(e,{silent:!0})}}}),define("hbs!aura_components/toolbar/toolbar",["hbs","hbs/handlebars","templates/helpers/compare"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var n="",r;return n+='\r\n            <div data-aura-component="toolbar-fullscreen" class="ys_98567_fullscreen ys_98567_off no-select"\r\n                 title="'+g((r=(r=e&&e.text,r==null||r===!1?r:r.fullscreenMode),typeof r===m?r.apply(e):r))+'" style="visibility:hidden"></div>\r\n        ',n}function o(e,t){var n="",r;return n+='\r\n            <div data-aura-component="toolbar-fullscreen" class="ys_98567_fullscreen ys_98567_on no-select"\r\n                 title="'+g((r=(r=e&&e.text,r==null||r===!1?r:r.fullscreenMode),typeof r===m?r.apply(e):r))+'" style="visibility:hidden"></div>\r\n        ',n}function u(e,t){var r="",i;r+="\r\n            ",i=n["if"].call(e,e&&e.logoTypeDisplay,{hash:{},inverse:y.program(13,h,t),fn:y.program(6,a,t)});if(i||i===0)r+=i;return r+="\r\n        ",r}function a(e,t){var r="",i,s,o;r+="\r\n                ",o={hash:{operator:"=="},inverse:y.noop,fn:y.program(7,f,t)},s=(i=n.compare||e&&e.compare,i?i.call(e,e&&e.logoTypeDisplay,1,o):b.call(e,"compare",e&&e.logoTypeDisplay,1,o));if(s||s===0)r+=s;r+="\r\n                ",o={hash:{operator:"=="},inverse:y.noop,fn:y.program(9,l,t)},s=(i=n.compare||e&&e.compare,i?i.call(e,e&&e.logoTypeDisplay,2,o):b.call(e,"compare",e&&e.logoTypeDisplay,2,o));if(s||s===0)r+=s;r+="\r\n                ",o={hash:{operator:"=="},inverse:y.noop,fn:y.program(11,c,t)},s=(i=n.compare||e&&e.compare,i?i.call(e,e&&e.logoTypeDisplay,3,o):b.call(e,"compare",e&&e.logoTypeDisplay,3,o));if(s||s===0)r+=s;return r+="\r\n\r\n            ",r}function f(e,t){var r="",i,s;return r+='\r\n                    <a target="_blank" href="',(i=n.productUrl)?i=i.call(e,{hash:{}}):(i=e&&e.productUrl,i=typeof i===m?i.call(e,{hash:{}}):i),r+=g(i)+'" class="ys_98567_logo-duo-vert no-select rd-logo"\r\n                       title="'+g((i=(i=e&&e.text,i==null||i===!1?i:i.goToYouscribe),typeof i===m?i.apply(e):i))+'">\r\n                        <span class="ys_98567_partner">\r\n                            <img src="',(s=n.logo)?s=s.call(e,{hash:{}}):(s=e&&e.logo,s=typeof s===m?s.call(e,{hash:{}}):s),r+=g(s)+'" alt=""/>\r\n                        </span>\r\n                        <span class="ys_98567_brand-ys">\r\n                            <span>\r\n                                avec YouScribe\r\n                            </span>\r\n                        </span>\r\n                    </a>\r\n                ',r}function l(e,t){var r="",i,s;return r+='\r\n                    <a target="_blank" href="',(i=n.productUrl)?i=i.call(e,{hash:{}}):(i=e&&e.productUrl,i=typeof i===m?i.call(e,{hash:{}}):i),r+=g(i)+'" class="ys_98567_logo-duo-horiz no-select rd-logo"\r\n                       title="'+g((i=(i=e&&e.text,i==null||i===!1?i:i.goToYouscribe),typeof i===m?i.apply(e):i))+'">\r\n                    <span class="ys_98567_partner">\r\n                        <img src="',(s=n.logo)?s=s.call(e,{hash:{}}):(s=e&&e.logo,s=typeof s===m?s.call(e,{hash:{}}):s),r+=g(s)+'" alt=""/>\r\n                    </span>\r\n                    <span class="ys_98567_brand-ys">\r\n                        <span>\r\n                            avec YouScribe\r\n                        </span>\r\n                    </span>\r\n                    </a>\r\n                ',r}function c(e,t){var r="",i,s;return r+='\r\n                    <a target="_blank" href="',(i=n.productUrl)?i=i.call(e,{hash:{}}):(i=e&&e.productUrl,i=typeof i===m?i.call(e,{hash:{}}):i),r+=g(i)+'" class="ys_98567_logo-duo-horiz no-select rd-logo"\r\n                       title="'+g((i=(i=e&&e.text,i==null||i===!1?i:i.goToYouscribe),typeof i===m?i.apply(e):i))+'">\r\n                    <span class="ys_98567_partner">\r\n                        <img src="',(s=n.logo)?s=s.call(e,{hash:{}}):(s=e&&e.logo,s=typeof s===m?s.call(e,{hash:{}}):s),r+=g(s)+'" alt=""/>\r\n                    </span>\r\n                    <span class="ys_98567_brand-ys">\r\n                        <span>\r\n                            ',(s=n.brandName)?s=s.call(e,{hash:{}}):(s=e&&e.brandName,s=typeof s===m?s.call(e,{hash:{}}):s),r+=g(s)+"\r\n                            <br>\r\n                            avec YouScribe\r\n                        </span>\r\n                    </span>\r\n                    </a>\r\n                ",r}function h(e,t){var r="",i;return r+='\r\n                <a target="_blank" href="',(i=n.productUrl)?i=i.call(e,{hash:{}}):(i=e&&e.productUrl,i=typeof i===m?i.call(e,{hash:{}}):i),r+=g(i)+'" class="ys_98567_logo no-select rd-logo"\r\n                   title="'+g((i=(i=e&&e.text,i==null||i===!1?i:i.goToYouscribe),typeof i===m?i.apply(e):i))+'"><span class="ys_98567_ico">&nbsp;</span></a>\r\n            ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var p="",d,v,m="function",g=this.escapeExpression,y=this,b=n.helperMissing;p+='<div class="ys_98567_reader_navbar_subcontainer">\r\n\r\n    <!-- ------ NAVBAR ------- -->\r\n    <div class="ys_98567_reader_navbar" style=\'overflow:hidden;background-color:',(d=n.backgroundToolbarColor)?d=d.call(t,{hash:{}}):(d=t&&t.backgroundToolbarColor,d=typeof d===m?d.call(t,{hash:{}}):d),p+=g(d)+'\'>\r\n\r\n        <!-- Access -->\r\n        <div data-aura-component="toolbar-access" class="ys_98567_access no-select" style="visibility:hidden"></div>\r\n\r\n        <!-- Navigation -->\r\n        <div data-aura-component="toolbar-navigation" class="ys_98567_navigation no-select"\r\n             style="visibility:hidden"></div>\r\n\r\n        <!-- Zoom -->\r\n        <div data-aura-component="toolbar-zoom" class="ys_98567_zoom no-select" style="visibility:hidden"></div>\r\n\r\n\r\n        <!-- Fullscreen -->\r\n        ',d=n["if"].call(t,t&&t.fullscreen,{hash:{},inverse:y.program(3,o,i),fn:y.program(1,s,i)});if(d||d===0)p+=d;p+='\r\n\r\n\r\n        <!-- Display -->\r\n        <div data-aura-component="toolbar-display" class="ys_98567_display no-select" style="visibility:hidden"></div>\r\n\r\n        <!-- Search -->\r\n        <div data-aura-component="toolbar-search" class="ys_98567_search no-select"\r\n             title="'+g((d=(d=t&&t.text,d==null||d===!1?d:d.searchIntoTheDocument),typeof d===m?d.apply(t):d))+'" style="visibility:hidden"></div>\r\n\r\n        <!-- Integrate -->\r\n        <div data-aura-component="toolbar-embed" class="ys_98567_embed_btn ys_98567_big no-select"\r\n             title="'+g((d=(d=t&&t.text,d==null||d===!1?d:d.integrate),typeof d===m?d.apply(t):d))+'" style="visibility:hidden"></div>\r\n\r\n        <!-- Share -->\r\n        <div data-aura-component="toolbar-share" class="ys_98567_share ys_98567_big no-select" title="'+g((d=(d=t&&t.text,d==null||d===!1?d:d.share),typeof d===m?d.apply(t):d))+'"\r\n             style="visibility:hidden"></div>\r\n\r\n        <!-- Library -->\r\n        <div data-aura-component="toolbar-library" class="ys_98567_library no-select" title="'+g((d=(d=t&&t.text,d==null||d===!1?d:d.addToMyLibrary),typeof d===m?d.apply(t):d))+'"\r\n             style="visibility:hidden"></div>\r\n\r\n        <!-- Logo -->\r\n        ',v=n["if"].call(t,t&&t.embed,{hash:{},inverse:y.noop,fn:y.program(5,u,i)});if(v||v===0)p+=v;return p+='\r\n    </div>\r\n\r\n    <!-- ------ POPIN ------- -->\r\n    <div class="ys_98567_reader_navbar_options_container no-select">\r\n        <div data-aura-component="toolbar-popin" class="ys_98567_reader_navbar_options ys_98567_str-',(v=n.type)?v=v.call(t,{hash:{}}):(v=t&&t.type,v=typeof v===m?v.call(t,{hash:{}}):v),p+=g(v)+'"\r\n             style="display:none;">\r\n        </div>\r\n    </div>\r\n',p});return n}),define("./__component__$toolbar@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar/toolbar"],function(e,t,n){var r=null,i=null;return{initialize:function(){e.bindAll(this,"render","scrollAction","updatePositionAndWidthFixedToolbar","detachFromTop","_setLogoWidth"),this.sandbox.on("window.resized",this.updatePositionAndWidthFixedToolbar),this.sandbox.on("reader.resized",this.updatePositionAndWidthFixedToolbar),this.sandbox.on("reader.viewport.scroll",this.scrollAction),this.sandbox.on("reader.viewport.display.changed",this.detachFromTop),this.render()},detachFromTop:function(){this._fixToTop(!1)},render:function(){var e={};return e.text=t,e.embed=this.sandbox.reader.get("embed"),e.type=e.embed?"small1":"big",e.productUrl=this.sandbox.util.url.getProduct(),e.fullscreen=this.sandbox.fullscreen.get("enable"),this.sandbox.reader.get("profile")&&(e.backgroundToolbarColor=this.sandbox.reader.get("profile").backgroundToolbarColor,e.logo=this.sandbox.reader.get("profile").logo,e.logoTypeDisplay=this.sandbox.reader.get("profile").logoTypeDisplay,e.brandName=this.sandbox.reader.get("profile").brandName),this.html(n(e)),this.sandbox.toolbar.set("height",this.$el.height()),setTimeout(this._setLogoWidth,50),this},scrollAction:function(e){this.sandbox.reader.get("embed")||(e.type==="top"?this._checkScrollTop(e):e.type==="left"&&this._checkScrollLeft(e))},updatePositionAndWidthFixedToolbar:function(e){if(this.$el.css("position")==="fixed"){var t={},n=$(window).scrollLeft();n!==i&&(i=n),t.left=this.sandbox.reader.get("offset").left-i,e&&(t.width=e),this.$el.css(t)}this.sandbox.toolbar.updateContent()},_checkScrollTop:function(e){var t=this.sandbox.reader.get("offset"),n=this.sandbox.reader.get("$element"),r=t.top<e.top;r&=e.top<n.height()+t.top-this.$el.height();var i=r?{left:t.left-e.left,width:n.width()}:null;this._fixToTop(r,i)},_checkScrollLeft:function(e){var t=this.sandbox.reader.get("offset");this.sandbox.toolbar.get("fixed")&&i!==e.left&&(this.$el.css("left",t.left-e.left),i=e.left)},_fixToTop:function(e,t){e&&this.sandbox.fullscreen.get("enable")===!1?this.sandbox.toolbar.get("fixed")===!1&&(this.$el.css({position:"fixed",left:t.left,width:t.width,"z-index":2}),this.sandbox.toolbar.set("fixed",!0)):this.sandbox.toolbar.get("fixed")===!0&&(this.$el.css({position:"",left:"",width:"","z-index":""}),this.sandbox.toolbar.set("fixed",!1))},_setLogoWidth:function(){var e=this.$el.find(".rd-logo"),t=e.length>0?e.outerWidth(!0):0;this.sandbox.toolbar.itemRendered("logo",e,{width:t})}}}),define("hbs!aura_components/toolbar-access/toolbar-access",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var r="",i;r+="\r\n	",i=n["if"].call(e,e&&e.display,{hash:{},inverse:h.noop,fn:h.program(2,o,t)});if(i||i===0)r+=i;return r+="\r\n",r}function o(e,t){var r="",i,s;return r+='\r\n		<div data-aura-component="toolbar-download" class="ys_98567_download ys_98567_big" title="'+c((i=(i=e&&e.text,i==null||i===!1?i:i.download),typeof i===l?i.apply(e):i))+'" style="background-color: ',(s=n.accessButtonColor)?s=s.call(e,{hash:{}}):(s=e&&e.accessButtonColor,s=typeof s===l?s.call(e,{hash:{}}):s),r+=c(s)+'">\r\n	',r}function u(e,t){var r="",i,s;return r+='\r\n	<a data-aura-component="toolbar-buy" class="ys_98567_buy ys_98567_big"  title="'+c((i=(i=e&&e.text,i==null||i===!1?i:i.addToCartUrl),typeof i===l?i.apply(e):i))+"\" href='",(s=n.addToCartUrl)?s=s.call(e,{hash:{}}):(s=e&&e.addToCartUrl,s=typeof s===l?s.call(e,{hash:{}}):s),r+=c(s)+"' style=\"background-color: ",(s=n.accessButtonColor)?s=s.call(e,{hash:{}}):(s=e&&e.accessButtonColor,s=typeof s===l?s.call(e,{hash:{}}):s),r+=c(s)+'"></a>\r\n',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var a="",f,l="function",c=this.escapeExpression,h=this;a+="\r\n\r\n\r\n",f=n["if"].call(t,t&&t.download,{hash:{},inverse:h.program(4,u,i),fn:h.program(1,s,i)});if(f||f===0)a+=f;return a});return n}),define("./__component__$toolbar-access@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-access/toolbar-access"],function(e,t,n){return{initialize:function(){e.bindAll(this,"changeSize","childItemsRendered"),this.sandbox.on("reader.toolbar.access.changeSize",this.changeSize),this.sandbox.on("reader.toolbar.access.item.rendered",this.childItemsRendered),this.render()},render:function(){var e=this.sandbox.reader.get("rights"),r=this.sandbox.reader.get("isFree"),i=!0,s=e.download.display;r===!1&&e.reading===!1?(i=!1,s=!0):e.download.enable===!1&&(s=!1);var o={text:t,display:s,addToCartUrl:this.sandbox.util.url.getAddToCart(),download:i,accessButtonColor:this.sandbox.reader.get("profile")?this.sandbox.reader.get("profile").accessButtonColor:null};return this.html(n(o)),s===!1&&this.sandbox.toolbar.itemRendered("access",null),this},childItemsRendered:function(){return this.sandbox.toolbar.itemRendered("access",this.$el.children()),this},changeSize:function(e){return e.setVisibility&&(this.$el[0].style.visibility="visible"),this.$el.children().length>0&&this.sandbox.toolbar.setSize(e.type,this.$el.children()),this}}}),define("hbs!aura_components/toolbar-buy/toolbar-buy",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="ys_98567_txt">',(o=n.price)?o=o.call(t,{hash:{}}):(o=t&&t.price,o=typeof o===u?o.call(t,{hash:{}}):o),s+=a(o)+'€</span>\r\n<span class="ys_98567_ico">&nbsp;</span>',s});return n}),define("./__component__$toolbar-buy@default",["underscore","hbs!aura_components/toolbar-buy/toolbar-buy"],function(e,t){return{View:{events:{click:function(e){this.sandbox.leadSharing.get("enable")?(e.preventDefault(),this.sandbox.leadSharing.show("Download")):$(e.currentTarget).addTrackingOnClick({category:"Reader",action:"AddToCart",label:this.sandbox.reader.get("productId"),value:null})}}},initialize:function(){this.render()},render:function(){return this.html(t({price:this.sandbox.reader.get("price")})),this.sandbox.emit("reader.toolbar.access.item.rendered","buy"),this}}}),define("hbs!aura_components/toolbar-display/toolbar-display",["hbs","hbs/handlebars","templates/helpers/compare"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var n="",r;return n+='\r\n	<div class="ys_98567_display_double ys_98567_big" title="'+p((r=(r=e&&e.text,r==null||r===!1?r:r.displayDouble),typeof r===h?r.apply(e):r))+'"><span class="ys_98567_ico">&nbsp;</span></div>\r\n',n}function o(e,t){var n="",r;return n+='\r\n	<div class="ys_98567_display_infinite ys_98567_big"  title="'+p((r=(r=e&&e.text,r==null||r===!1?r:r.displayScroll),typeof r===h?r.apply(e):r))+'"><span class="ys_98567_ico">&nbsp;</span></div>\r\n',n}function u(e,t){var n="",r;return n+='\r\n	<div class="ys_98567_display_slideshow ys_98567_big"  title="'+p((r=(r=e&&e.text,r==null||r===!1?r:r.displaySlide),typeof r===h?r.apply(e):r))+'"><span class="ys_98567_ico">&nbsp;</span></div>\r\n',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var a="",f,l,c,h="function",p=this.escapeExpression,d=this,v=n.helperMissing;c={hash:{operator:"!="},inverse:d.noop,fn:d.program(1,s,i)},l=(f=n.compare||t&&t.compare,f?f.call(t,t&&t.display,"double",c):v.call(t,"compare",t&&t.display,"double",c));if(l||l===0)a+=l;a+="\r\n\r\n\r\n",c={hash:{operator:"!="},inverse:d.noop,fn:d.program(3,o,i)},l=(f=n.compare||t&&t.compare,f?f.call(t,t&&t.display,"scroll",c):v.call(t,"compare",t&&t.display,"scroll",c));if(l||l===0)a+=l;a+="\r\n\r\n\r\n",c={hash:{operator:"!="},inverse:d.noop,fn:d.program(5,u,i)},l=(f=n.compare||t&&t.compare,f?f.call(t,t&&t.display,"slideshow",c):v.call(t,"compare",t&&t.display,"slideshow",c));if(l||l===0)a+=l;return a+="\r\n",a});return n}),define("./__component__$toolbar-display@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-display/toolbar-display"],function(e,t,n){return{View:{events:{"click .ys_98567_display_infinite":function(){this.sandbox.emit("reader.toolbar.display.clicked","scroll")},"click .ys_98567_display_double":function(){this.sandbox.emit("reader.toolbar.display.clicked","double")},"click .ys_98567_display_slideshow":function(){this.sandbox.emit("reader.toolbar.display.clicked","slideshow")}}},initialize:function(){e.bindAll(this,"render","changeSize"),this.sandbox.on("reader.viewport.display.changed",this.render),this.sandbox.on("reader.toolbar.display.changeSize",this.changeSize),this.render()},render:function(e){var r={display:this.sandbox.viewport.get("display"),text:t};return this.html(n(r)),this.sandbox.toolbar.itemRendered("display",this.$el),this},changeSize:function(e){return e.setVisibility&&(this.$el[0].style.visibility="visible"),this.sandbox.toolbar.setSize(e.type,this.$el),this}}}),define("hbs!aura_components/toolbar-download/toolbar-download",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="ys_98567_txt">'+a((o=(o=t&&t.text,o==null||o===!1?o:o.download),typeof o===u?o.apply(t):o))+'</span>\r\n<span class="ys_98567_ico">&nbsp;</span>',s});return n}),define("./__component__$toolbar-download@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-download/toolbar-download"],function(e,t,n){return{View:{events:{click:function(){this.sandbox.leadSharing.get("enable")?this.sandbox.leadSharing.show("Download"):this.sandbox.emit("reader.popin.change","download")}}},initialize:function(){this.render()},render:function(){return this.html(n({text:t})),this.sandbox.emit("reader.toolbar.access.item.rendered","download"),this}}}),define("hbs!aura_components/toolbar-embed/toolbar-embed",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="ys_98567_ico">&nbsp;</span>\r\n<span class="ys_98567_txt">'+a((o=(o=t&&t.text,o==null||o===!1?o:o.integrate),typeof o===u?o.apply(t):o))+"</span>\r\n",s});return n}),define("./__component__$toolbar-embed@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-embed/toolbar-embed"],function(e,t,n){return{View:{events:{click:function(){this.sandbox.emit("reader.popin.change","embed")}}},initialize:function(){e.bindAll(this,"changeSize"),this.sandbox.on("reader.toolbar.embed.changeSize",this.changeSize),this.render()},render:function(){return this.html(n({text:t})),this.sandbox.toolbar.itemRendered("embed",this.$el),this},changeSize:function(e){return e.setVisibility&&(this.$el[0].style.visibility="visible"),this.sandbox.toolbar.setSize(e.type,this.$el),this}}}),define("hbs!aura_components/toolbar-fullscreen/toolbar-fullscreen",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="ys_98567_ico">&nbsp;</span>\r\n<span class="ys_98567_txt">'+a((o=(o=t&&t.text,o==null||o===!1?o:o.fullscreen),typeof o===u?o.apply(t):o))+"</span>\r\n",s});return n}),define("./__component__$toolbar-fullscreen@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-fullscreen/toolbar-fullscreen"],function(e,t,n){return{View:{events:{click:function(){this.sandbox.emit("reader.fullscreen.clicked")}}},initialize:function(){e.bindAll(this,"fullscreenChanged","changeSize"),this.sandbox.binders.get("fullscreen").add("through",this.fullscreenChanged),this.sandbox.on("reader.toolbar.fullscreen.changeSize",this.changeSize),this.render()},render:function(){return this.html(n({text:t})),this.sandbox.toolbar.itemRendered("fullscreen",this.$el),this},fullscreenChanged:function(e){if(this.sandbox.reader.get("embed"))return;return e?(this.$el.removeClass("ys_98567_on").addClass("ys_98567_off"),$("iframe").hide()):(this.$el.removeClass("ys_98567_off").addClass("ys_98567_on"),$("iframe").show()),this},changeSize:function(e){return e.setVisibility&&(this.$el[0].style.visibility="visible"),this.sandbox.toolbar.setSize(e.type,this.$el),this}}}),define("hbs!aura_components/toolbar-library/toolbar-library",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<span class="ys_98567_ico">&nbsp;</span>'});return n}),define("./__component__$toolbar-library@default",["underscore","hbs!aura_components/toolbar-library/toolbar-library"],function(e,t){return{View:{events:{click:function(){this.sandbox.emit("reader.popin.change","library")}}},initialize:function(){e.bindAll(this,"changeSize"),this.sandbox.on("reader.toolbar.library.changeSize",this.changeSize),this.render()},render:function(){return this.html(t),this.sandbox.toolbar.itemRendered("library",this.$el),this},changeSize:function(e){e.setVisibility&&(this.$el[0].style.visibility="visible"),this.sandbox.toolbar.setSize(e.type,this.$el)}}}),define("hbs!aura_components/toolbar-navigation/toolbar-navigation",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u,a="function",f=this.escapeExpression;return s+='<div class="ys_98567_previous rd-prev-page" title="'+f((o=(o=t&&t.text,o==null||o===!1?o:o.previousPage),typeof o===a?o.apply(t):o))+'"><span class="ys_98567_ico" unselectable="on">&nbsp;</span></div>\r\n<div class="ys_98567_paging">\r\n	<input type="text" name="pagenumber" value="',(u=n.currentPage)?u=u.call(t,{hash:{}}):(u=t&&t.currentPage,u=typeof u===a?u.call(t,{hash:{}}):u),s+=f(u)+'" class="ys_98567_one rd-current-page">\r\n	<span class="ys_98567_end"> ⁄ </span>\r\n	<span class="page-number rd-total-page">',(u=n.nbPages)?u=u.call(t,{hash:{}}):(u=t&&t.nbPages,u=typeof u===a?u.call(t,{hash:{}}):u),s+=f(u)+'</span>\r\n</div>\r\n<div class="ys_98567_next rd-next-page" title="'+f((o=(o=t&&t.text,o==null||o===!1?o:o.afterPage),typeof o===a?o.apply(t):o))+'"><span class="ys_98567_ico">&nbsp;</span></div>\r\n',s});return n}),define("hbs!aura_components/toolbar-navigation/toolbar-navigation-cover",["hbs","hbs/handlebars","templates/helpers/compare"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var r="",i;return r+="\r\n<p style='line-height:45px;margin:0 10px' class=\"rd-total-page-cover\">",(i=n.nbTotal)?i=i.call(e,{hash:{}}):(i=e&&e.nbTotal,i=typeof i===l?i.call(e,{hash:{}}):i),r+=c(i)+" "+c((i=(i=e&&e.text,i==null||i===!1?i:i.pages),typeof i===l?i.apply(e):i))+"</p>\r\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var o="",u,a,f,l="function",c=this.escapeExpression,h=this,p=n.helperMissing;f={hash:{operator:"!="},inverse:h.noop,fn:h.program(1,s,i)},a=(u=n.compare||t&&t.compare,u?u.call(t,t&&t.nbTotal,"NC",f):p.call(t,"compare",t&&t.nbTotal,"NC",f));if(a||a===0)o+=a;return o+="\r\n\r\n\r\n",o});return n}),define("./__component__$toolbar-navigation@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-navigation/toolbar-navigation","hbs!aura_components/toolbar-navigation/toolbar-navigation-cover"],function(e,t,n,r){var i=null,s=null,o=null,u=null;return{View:{events:{"click .rd-prev-page":function(){this.sandbox.pages.set("currentIndex",this.sandbox.pages.getPreviousIndexPage())},"click .rd-next-page":function(){this.sandbox.pages.set("currentIndex",this.sandbox.pages.getNextIndexPage())},"change .rd-current-page":function(e){var t=this.sandbox.dom.find(e.target).val();this.sandbox.pages.set("currentIndex",parseInt(t,10)-1)},"keyup .rd-current-page":function(e){e.keyCode===13&&$(e.currentTarget).blur()}}},initialize:function(){e.bindAll(this,"changeSize","updateCurrentPage","updateNbPages"),this.sandbox.on("reader.toolbar.navigation.changeSize",this.changeSize),this.render()},render:function(){return this.sandbox.reader.get("cover")?this._coverRender():this._defaultRender(),this},updateCurrentPage:function(e){u.val(e.get("number"))},updateNbPages:function(){s.innerHtml=this.sandbox.pages.get("nbTotal")},changeSize:function(e){e.setVisibility&&(this.$el[0].style.visibility="visible"),e.type==="hide"?this.$el.hide():(this.$el.show(),this.sandbox.reader.get("cover")||this._showOrHideArrow(e.type==="big"))},_showOrHideArrow:function(e){e&&this.sandbox.viewport.get("display")!=="slideshow"?i.show():i.hide()},_coverRender:function(){this.html(r({nbTotal:this.sandbox.pages.get("nbTotal"),text:t})),this.sandbox.toolbar.itemRendered("navigation",this.$el,{small:this.$el.width(),big:this.$el.width()})},_defaultRender:function(){var e=this.sandbox.pages.at(this.sandbox.pages.get("currentIndex"));this.html(n({currentPage:e.get("number"),nbPages:this.sandbox.pages.get("nbTotal"),text:t})),i=this.$el.find(".rd-next-page, .rd-prev-page"),u=this.$el.find(".rd-current-page"),s=this.$el.find(".rd-total-page");var r=i.hide().parent().outerWidth(!0),o=i.show().parent().outerWidth(!0);this.sandbox.toolbar.itemRendered("navigation",this.$el,{small:r,big:o}),this.sandbox.on("reader.pages.ui.updateCurrentPage",this.updateCurrentPage),this.sandbox.on("reader.pages.currentIndex.changed",this.updateCurrentPage)}}}),define("hbs!aura_components/toolbar-popin/loading",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ys_98567_reader_close rd-close" title="'+a((o=(o=t&&t.text,o==null||o===!1?o:o.close),typeof o===u?o.apply(t):o))+"\">&nbsp;</div>\r\n<div class='option'>\r\n	<div class='loading'></div>\r\n</div>",s});return n}),define("hbs!aura_components/toolbar-popin/loaded",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u,a="function",f=this.escapeExpression;s+='<div class="ys_98567_reader_close rd-close" title="'+f((o=(o=t&&t.text,o==null||o===!1?o:o.close),typeof o===a?o.apply(t):o))+'">&nbsp;</div>\r\n',(u=n.content)?u=u.call(t,{hash:{}}):(u=t&&t.content,u=typeof u===a?u.call(t,{hash:{}}):u);if(u||u===0)s+=u;return s});return n}),define("./__component__$toolbar-popin@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-popin/loading","hbs!aura_components/toolbar-popin/loaded"],function(e,t,n,r){var i=null;return{View:{events:{"click .rd-close":function(){this.sandbox.emit("reader.popin.close")},"click .ys_98567_str-previous-step":function(){this.component.goToPreviousStep()},"click .ys_98567_str-next-step":function(){this.component.goToNextStep()}}},initialize:function(){e.bindAll(this,"change","goToPreviousStep","goToNextStep","close"),this.sandbox.on("reader.popin.change",this.change),this.sandbox.on("reader.popin.close",this.close),this.sandbox.on("reader.popin.previous",this.goToPreviousStep),this.sandbox.on("reader.popin.next",this.goToNextStep)},goToPreviousStep:function(){return this.$el.hasClass("ys_98567_str-small2")&&this.$el.removeClass("ys_98567_str-small2").addClass("ys_98567_str-small1"),this},goToNextStep:function(){return this.$el.hasClass("ys_98567_str-small1")&&this.$el.removeClass("ys_98567_str-small1").addClass("ys_98567_str-small2"),this},render:function(e){return e?this.html(r({content:e,text:t})):this.html(n({text:t})),this},change:function(e){return e!==this.sandbox.popin.get("currentType")?(this._clear(),this.sandbox.popin.get("currentType")||this._open(),this.sandbox.popin.set({currentType:e}),this.goToPreviousStep(),i=setTimeout($.proxy(function(){this.render('<div data-aura-component="popin-'+e+'"></div>')},this),1e3)):this.close(),this},close:function(){return this.sandbox.popin.set({currentType:null,display:!1}),this.$el.fadeOut("fast"),this},_clear:function(){return this.sandbox.emit("reader.popin.clear"),clearTimeout(i),this.render(),this},_open:function(){return this.sandbox.popin.set("display",!0),this.$el.fadeIn("fast"),this}}}),define("hbs!aura_components/toolbar-search/toolbar-search",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<span class="ys_98567_ico">&nbsp;</span>'});return n}),define("./__component__$toolbar-search@default",["underscore","hbs!aura_components/toolbar-search/toolbar-search"],function(e,t){return{View:{events:{click:function(){this.sandbox.emit("reader.popin.change","search")}}},initialize:function(){e.bindAll(this,"changeSize"),this.sandbox.on("reader.toolbar.search.changeSize",this.changeSize),this.render()},render:function(){return this.html(t),this.sandbox.util.canSearch().then($.proxy(function(e){this.sandbox.reader.set(e),this.sandbox.toolbar.itemRendered("search",this.$el)},this)),this},changeSize:function(e){return e.setVisibility&&(this.$el[0].style.visibility="visible"),this.sandbox.toolbar.setSize(e.type,this.$el),this}}}),define("hbs!aura_components/toolbar-share/toolbar-share",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="ys_98567_ico">&nbsp;</span>\r\n<span class="ys_98567_txt">'+a((o=(o=t&&t.text,o==null||o===!1?o:o.share),typeof o===u?o.apply(t):o))+"</span>\r\n",s});return n}),define("./__component__$toolbar-share@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-share/toolbar-share"],function(e,t,n){return{View:{events:{click:function(){this.sandbox.emit("reader.popin.change","share")}}},initialize:function(){e.bindAll(this,"changeSize"),this.sandbox.on("reader.toolbar.share.changeSize",this.changeSize),this.render()},render:function(){return this.html(n({text:t})),this.sandbox.toolbar.itemRendered("share",this.$el),this},changeSize:function(e){return e.setVisibility&&(this.$el[0].style.visibility="visible"),this.sandbox.toolbar.setSize(e.type,this.$el),this}}}),define("hbs!aura_components/toolbar-zoom/toolbar-zoom",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ys_98567_zoomout rd-zoom-less disable"  title="'+a((o=(o=t&&t.text,o==null||o===!1?o:o.zoomLess),typeof o===u?o.apply(t):o))+'"><span class="ys_98567_ico">&nbsp;</span></div><!--\r\n--><div class="ys_98567_zoomin rd-zoom-more disable" title="'+a((o=(o=t&&t.text,o==null||o===!1?o:o.zoomMore),typeof o===u?o.apply(t):o))+'"><span class="ys_98567_ico">&nbsp;</span></div>\r\n',s});return n}),define("./__component__$toolbar-zoom@default",["underscore","i18n!nls/text","hbs!aura_components/toolbar-zoom/toolbar-zoom"],function(e,t,n){var r=null,i=null,s=null,o=0;return{View:{events:{"click .rd-zoom-more":function(){this.sandbox.zoom.set("zoom",this.sandbox.zoom.getNextZoom())},"click .rd-zoom-less":function(){this.sandbox.zoom.set("zoom",this.sandbox.zoom.getPreviousZoom())}}},initialize:function(){e.bindAll(this,"changeSize","updateZoom"),this.sandbox.on("reader.toolbar.zoom.changeSize",this.changeSize),this.sandbox.binders.get("zoom").add("through",this.updateZoom),this.render(),r=this.$el.find(".rd-zoom-less"),i=this.$el.find(".rd-zoom-more"),s=this.$el.parents(".subcontainer"),o=s.width(),this.updateZoom()},render:function(){return this.html(n({text:t})),this.sandbox.toolbar.itemRendered("zoom",this.$el),this},updateZoom:function(){return this._enable(),this},changeSize:function(e){return e.setVisibility&&(this.$el[0].style.visibility="visible"),this.sandbox.toolbar.setSize(e.type,this.$el),this},_enable:function(){var e=this.sandbox.zoom.get("zoom","unit","minZoom","maxZoom");return e.zoom-e.unit<e.minZoom?(r.hasClass("enable")&&r.removeClass("enable"),r.addClass("disable")):(r.hasClass("disable")&&r.removeClass("disable"),r.addClass("enable")),e.zoom+e.unit>e.maxZoom?(i.hasClass("enable")&&i.removeClass("enable"),i.addClass("disable")):(i.hasClass("disable")&&i.removeClass("disable"),i.addClass("enable")),this}}}),define("hbs!aura_components/viewport/viewport",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+="<div class='rd-viewport-display rd-viewport-display-",(o=n.display)?o=o.call(t,{hash:{}}):(o=t&&t.display,o=typeof o===u?o.call(t,{hash:{}}):o),s+=a(o)+" ",(o=n.ie)?o=o.call(t,{hash:{}}):(o=t&&t.ie,o=typeof o===u?o.call(t,{hash:{}}):o),s+=a(o)+"' data-aura-component=\"viewport-display-",(o=n.display)?o=o.call(t,{hash:{}}):(o=t&&t.display,o=typeof o===u?o.call(t,{hash:{}}):o),s+=a(o)+'" id="ysctn5_',(o=n.documentId)?o=o.call(t,{hash:{}}):(o=t&&t.documentId,o=typeof o===u?o.call(t,{hash:{}}):o),s+=a(o)+'"></div>\r\n<div class=\'rd-lead-sharing leadsharing_container_br_98567\' data-aura-component="viewport-lead-sharing"></div>\r\n\r\n',s});return n}),define("./__component__$viewport@default",["underscore","hbs!aura_components/viewport/viewport"],function(e,t){var n=$(window),r=$("html, body");return{initialize:function(){e.bindAll(this,"render","fullscreenChanged","updateHeight","leadSharingRendered"),this.sandbox.on("reader.viewport.display.changed",this.render),this.sandbox.on("reader.leadSharing.render",this.leadSharingRendered),this.sandbox.binders.get("fullscreen").add("after",this.fullscreenChanged),this.sandbox.on("window.resized",this.updateHeight),this.sandbox.on("reader.toolbar.height.changed",this.updateHeight),this.sandbox.mouse.startListening(this.$el),this.sandbox.viewport.set("$element",this.$el),this.render()},updateHeight:function(){var e="";if(this.sandbox.fullscreen.get("enable")||this.sandbox.reader.get("embed"))e=this.sandbox.util.getWindowHeight()-this.sandbox.toolbar.get("height");return this.sandbox.viewport.set("height",e===""?null:e),this.$el.parents(".middle").css("height",e),e},render:function(){var e=this.sandbox.viewport.get();e.ie=this._setIEClass();var i=this.sandbox.reader.get("offset").top;return n.scrollTop()>i&&r.scrollTop(i),this.$el.css("overflow",""),e.documentId=this.sandbox.reader.get("documentId")>>0,this.html(t(e)),this},fullscreenChanged:function(e){return this.updateHeight(),this.sandbox.zoom.updateAfterFullscreen(e,this.$el.width()),this},leadSharingRendered:function(){this.sandbox.viewport.get("display")!=="double"&&this.$el.find(".rd-viewport-display").css({overflow:"hidden",height:"100%"})},_setIEClass:function(){var e="";return this.sandbox.util.browserType.isIE7()?e="ie7":this.sandbox.util.browserType.isIE8()&&(e="ie8"),r.addClass(e),e}}}),define("hbs!aura_components/viewport-display-double/viewport-display-double",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var n="",r;n+="\r\n	",r=typeof e===a?e.apply(e):e;if(r||r===0)n+=r;return n+="\r\n",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var o="",u,a="function",f=this;o+="\r\n\r\n ",u=n.each.call(t,t&&t.elements,{hash:{},inverse:f.noop,fn:f.program(1,s,i)});if(u||u===0)o+=u;return o+="\r\n",o});return n}),define("./__component__$viewport-display-double@default",["underscore","hbs!aura_components/viewport-display-double/viewport-display-double"],function(e,t){var n={},r=null,i=$(window),s=$("body");return{initialize:function(){e.bindAll(this,"ready","checkBookSize","resize","setTableLayout","pagechanged","_start","_end","_turning","_turned"),r=this.$el.parents(".rd-viewport"),this.sandbox.viewport.set("nbPagesToMove",2),this.sandbox.on("reader.viewport.template.ready",function(e){this.render(e)},this),this.sandbox.on("reader.viewport.pages.ready",this.ready),this.sandbox.on("reader.pages.currentIndex.changed",this.pagechanged),this.sandbox.on("reader.pages.content.loaded",this.checkBookSize),this.sandbox.binders.get("fullscreen").add("through",this.setTableLayout),this.sandbox.binders.get("zoom").add("through",this.resize,this.sandbox.binders.order.last),this.sandbox.on("window.resized",this.resize),this.sandbox.viewport.createPages()},remove:function(){this.sandbox.binders.get("fullscreen").remove("through",this.setTableLayout),this.sandbox.binders.get("zoom").remove("through",this.resize),this.sandbox.viewport.double.reset()},render:function(e){this.html(t({elements:e}))},checkBookSize:function(e){var t=this.sandbox.pages.indexOf(e);if(this.$el.turn("view").indexOf(t+1)===-1)return;var r=n.width/2/e.get("ratio");n.height=r;var i=this.$el.turn("size"),s=i.width/2/e.get("ratio");this.$el.turn("size",i.width,s),this._checkOverflow("start")},ready:function(){var e=this.$el.width(),t=e/2/this.sandbox.reader.get("ratio");this.setTableLayout(),this.$el.turn({width:e,height:t,gradients:!$.isTouch,acceleration:!0,autoCenter:!1,pages:this.sandbox.pages.length(),when:{start:this._start,end:this._end,turning:this._turning,turned:this._turned}}),n=this.$el.turn("size"),this.sandbox.emit("reader.subViewport.ready","double")},resize:function(e){var t=n.width*e;this.sandbox.pages.at("*").invoke("set",{scaled:!1}),this.sandbox.reader.get("embed")===!1&&(t=this.sandbox.viewport.get("$element").width()*e);var r=t*n.height/n.width;this.$el.turn("size",t,r),this._checkHeight()},setTableLayout:function(e){this.sandbox.reader.get("embed")&&(e?s.css("overflow","hidden"):s.css("overflow","auto")),e=this.sandbox.reader.get("embed")||e,this.$el.parents(".middle").css("table-layout",e?"fixed":"")},pagechanged:function(t){var n=this.$el.turn("view"),r=this.sandbox.pages.indexOf(t)+1;e.indexOf(n,r)===-1?this.$el.turn("page",r):this.pageTurned(t)},pageTurned:function(e){var t=this.sandbox.pages.indexOf(e);if(t!==this.sandbox.pages.get("currentIndex")){this.sandbox.pages.set("currentIndex",t);return}var n=this.$el.turn("view"),r=this.$el.turn("range");n[0]===0&&(n[0]=n[1]),n[1]===0&&(n[1]=n[0]),this.sandbox.content.scale(r[0],r[1]),this.sandbox.content.load(n[0]-1,n[1]-1,2)},_start:function(e,t,n){this._checkOverflow("start")},_end:function(e,t,n){this._checkOverflow("end")},_turned:function(e,t,n){this.sandbox.viewport.double.set("isTurning",!1);if(this.sandbox.viewport.get("ready")===!1)return;var r=this.sandbox.pages.at(t-1);this.pageTurned(r)},_turning:function(e,t,n){this.sandbox.viewport.double.set("isTurning",!0),this.sandbox.emit("reader.pages.ui.updateCurrentPage",this.sandbox.pages.at(t-1))},_checkHeight:function(){var e=this.sandbox.viewport.get("$element");(this.sandbox.fullscreen.get("enable")||this.sandbox.reader.get("embed"))&&this.$el.height()>this.sandbox.util.getWindowHeight()-this.sandbox.toolbar.get("height")?e.css("height",this.sandbox.util.getWindowHeight()-this.sandbox.toolbar.get("height")):e.css("height",""),this._checkOverflow("end")},_checkOverflow:function(e){var t=this.sandbox.viewport.get("$element");e==="start"?t.hasScrollBar()===!1&&t.css("overflow","visible"):e==="end"&&((this.sandbox.fullscreen.get("enable")||this.sandbox.reader.get("embed"))&&this.$el.height()>t.height()||this.$el.width()>t.width())&&t.css("overflow","auto"),this.sandbox.fullscreen.get("enable")&&t.focus()}}}),define("hbs!aura_components/viewport-display-scroll/viewport-display-scroll",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var n="",r;n+="\r\n	",r=typeof e===a?e.apply(e):e;if(r||r===0)n+=r;return n+="\r\n",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var o="",u,a="function",f=this;u=n.each.call(t,t&&t.elements,{hash:{},inverse:f.noop,fn:f.program(1,s,i)});if(u||u===0)o+=u;return o+="\r\n",o});return n}),define("./__component__$viewport-display-scroll@default",["underscore","hbs!aura_components/viewport-display-scroll/viewport-display-scroll"],function(e,t){var n=$(window),r=$("html, body"),i=!1,s=null,o=null,u=null,a={top:0,height:0},f=0;return{initialize:function(){e.bindAll(this,"ready","animate","setHeight","zoomChanged","fullscreenChanged","setScrollPosition","savePosition","_scrollAnimationStep","_scrollAnimationComplete"),s=this.sandbox.viewport.get("$element"),i=this.sandbox.reader.get("embed"),this.sandbox.viewport.set("nbPagesToMove",1),this.sandbox.loop.add("viewport",this.sandbox.viewport.scroll.checkScroll),this.sandbox.loop.add("viewport",this.sandbox.viewport.scroll.checkContent,150),this.sandbox.on("reader.viewport.template.ready",function(e){this.render(e)},this),this.sandbox.on("reader.viewport.pages.ready",this.ready),this.sandbox.on("reader.viewport.scroll.animate",this.animate),this.sandbox.on("reader.resized",this.setHeight),this.sandbox.on("reader.viewport.scroll.scrollerScrolled",this.setScrollPosition),this.sandbox.on("reader.pages.currentIndex.changed",this.sandbox.viewport.scroll.pageChanged),this.sandbox.binders.get("fullscreen").add("before",this.savePosition),this.sandbox.binders.get("fullscreen").add("through",this.fullscreenChanged),this.sandbox.binders.get("zoom").add("before",this.savePosition),this.sandbox.binders.get("zoom").add("through",this.zoomChanged,this.sandbox.binders.order.last),this.sandbox.viewport.createPages()},remove:function(){this.sandbox.binders.get("fullscreen").remove("before",this.savePosition),this.sandbox.binders.get("fullscreen").remove("through",this.fullscreenChanged),this.sandbox.binders.get("zoom").remove("before",this.savePosition),this.sandbox.binders.get("zoom").remove("through",this.zoomChanged),this.sandbox.loop.remove(this.sandbox.viewport.scroll.checkContent),this.sandbox.loop.remove(this.sandbox.viewport.scroll.checkScroll),this.sandbox.off("reader.pages.currentIndex.changed",this.sandbox.viewport.scroll.pageChanged),this.sandbox.viewport.scroll.reset()},render:function(e){return this.html(t({elements:e})),o=this.sandbox.reader.get("embed")?s:n,o.on("scroll",this.sandbox.viewport.scroll.scrollerScrolled),this},setScrollPosition:function(e,t,r){return o=this.sandbox.fullscreen.get("enable")||i?s:n,e?o.scrollTop(e):e=o.scrollTop(),t?o.scrollLeft(t):t=o.scrollLeft(),this.sandbox.viewport.scroll.set({scrollTop:e,scrollLeft:t},r),this},ready:function(){return this.setHeight(),this.sandbox.viewport.scroll.set("scrollEnable",!0),this.sandbox.emit("reader.subViewport.ready","scroll"),this},setHeight:function(){var e="auto";if(this.sandbox.reader.get("embed")||this.sandbox.fullscreen.get("enable"))e=this.sandbox.util.getWindowHeight()-this.sandbox.toolbar.get("height");return s.height(e),this.sandbox.fullscreen.get("enable")&&this.$el.parents(".rd-viewport").focus(),this},animate:function(e){var t=i||this.sandbox.fullscreen.get("enable");u=t?s:r,f=e.top,u.animate({scrollTop:f},{duration:e.duration,queue:!1,step:this._scrollAnimationStep,complete:this._scrollAnimationComplete})},fullscreenChanged:function(e){return o.off("scroll",this.sandbox.viewport.scroll.scrollerScrolled),o=this.sandbox.reader.get("embed")||e?s:n,o.on("scroll",this.sandbox.viewport.scroll.scrollerScrolled),this.setHeight(),this._goNewTopFromPreviousPositions(),this},zoomChanged:function(e){var t=e*100;return this.sandbox.reader.get("embed")===!1?this.$el.width(t+"%"):this.$el.width(e===1?"":t+"%"),this._goNewTopFromPreviousPositions(),this},savePosition:function(){if(this.sandbox.viewport.get("ready")===!1)return;var e=0,t=0;if(i||this.sandbox.fullscreen.get("enable"))e=this.$el.height(),t=o.scrollTop();else{var n=this.sandbox.reader.get("offset").top,r=this.sandbox.toolbar.get("fixed")?this.sandbox.toolbar.get("height"):0;e=s.height(),t=o.scrollTop()-n+r}return a={top:t,height:e},this},_scrollAnimationStep:function(e,t){return this.sandbox.toolbar.get("fixed")&&(t.end=f-this.sandbox.toolbar.get("height")),this},_scrollAnimationComplete:function(){function e(){u.is(":not(:animated)")&&(this.sandbox.viewport.scroll.set("scrollEnable",!0),this.setScrollPosition(null,null,{force:!0}),window.clearTimeout(t))}var t=null;t=window.setTimeout(e.bind(this),100)},_goNewTopFromPreviousPositions:function(){if(this.sandbox.viewport.get("ready")===!1||this.sandbox.toolbar.get("fixed")===!1)return;var e=this.sandbox.reader.get("offset").top,t=i||this.sandbox.fullscreen.get("enable")?this.$el.height():s.height(),n=Math.floor(a.top*t/a.height);return!i&&!this.sandbox.fullscreen.get("enable")&&(n+=e,n>this.sandbox.util.getWindowHeight()&&(n-=this.sandbox.toolbar.get("height"))),this.setScrollPosition(n),this}}}),define("hbs!aura_components/viewport-display-slideshow/viewport-display-slideshow",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var n="",r;n+="\r\n	",r=typeof e===a?e.apply(e):e;if(r||r===0)n+=r;return n+="\r\n",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var o="",u,a="function",f=this;u=n.each.call(t,t&&t.elements,{hash:{},inverse:f.noop,fn:f.program(1,s,i)});if(u||u===0)o+=u;return o+="\r\n",o});return n}),define("./__component__$viewport-display-slideshow@default",["underscore","hbs!aura_components/viewport-display-slideshow/viewport-display-slideshow"],function(e,t){var n=null,r=null,i=$(window);return{initialize:function(){e.bindAll(this,"ready","resize","checkHeight","checkViewportReady"),r=0,n=0,this.sandbox.viewport.set("nbPagesToMove",1),this.sandbox.on("reader.viewport.template.ready",function(e){this.render(e)},this),this.sandbox.on("reader.viewport.pages.ready",this.checkViewportReady),this.sandbox.binders.get("zoom").add("through",this.resize),this.sandbox.on("window.resized",this.checkHeight),this.sandbox.viewport.createPages(),this.sandbox.on("reader.pages.currentIndex.changed",this.checkHeight),this.sandbox.on("reader.arrows.rendered",this.checkViewportReady),this.sandbox.on("reader.pages.currentIndex.changed",this.sandbox.viewport.slideshow.pageChanged),this.createArrows()},createArrows:function(){var e=this.$el.parents(".rd-viewport-ctn");e.before($('<div class="rd-str-area-column str-left rd-arrow no-select">')),e.after($('<div class="rd-str-area-column str-right rd-arrow no-select">')),this.sandbox.viewport.slideshow.startArrows()},remove:function(){this.sandbox.binders.get("zoom").remove("through",this.resize),this.sandbox.off("reader.pages.currentIndex.changed",this.sandbox.viewport.slideshow.pageChanged),this.sandbox.viewport.slideshow.reset()},render:function(e){this.html(t({elements:e}))},checkViewportReady:function(){r++,r===3&&this.ready()},ready:function(){this.sandbox.emit("reader.subViewport.ready","slideshow")},resize:function(e){var t=e*100;this.sandbox.reader.get("embed")===!1?this.$el.width(t+"%"):this.$el.width(e===1?"":t+"%"),this.checkHeight()},checkHeight:function(){(this.sandbox.fullscreen.get("enable")||this.sandbox.reader.get("embed"))&&this.$el.height()>this.sandbox.util.getWindowHeight()-this.sandbox.toolbar.get("height")?this.$el.parent().css("height",this.sandbox.util.getWindowHeight()-this.sandbox.toolbar.get("height")):this.$el.parent().css("height",""),this.sandbox.fullscreen.get("enable")&&this.$el.parents(".rd-viewport").focus()}}}),define("templates/helpers/enumerate",["hbs/handlebars"],function(e){function t(e,t){if(arguments.length!==2)throw new Error("Handlerbars Helper 'enumerate' needs 2 parameters");var n="",r=0,i=0,s=[];e=="numeric"?(r=parseInt(t.hash.start),i=parseInt(t.hash.end)):e=="day"?(r=1,i=32):e=="month"?(r=1,i=13,s=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Décembre"]):e=="year"&&(r=(new Date).getFullYear()-100,i=(new Date).getFullYear()+1),t.hash.emptyFirstChoice&&(n+=t.fn(this,{data:{index:null,value:null}}));for(var o=r;o<i;o++){var u=o;s.length>o-r&&(u=s[o-r]),n+=t.fn(this,{data:{index:o,value:u}})}return n}return e.registerHelper("enumerate",t),t}),define("templates/helpers/safeString",["hbs/handlebars"],function(e){function t(t){return new e.SafeString(t)}return e.registerHelper("safeString",t),t}),define("templates/helpers/fieldTemplate",["hbs/handlebars","templates/helpers/enumerate","templates/helpers/compare","templates/helpers/safeString"],function(e){function t(t,l,c){if(arguments.length<3)throw new Error("Handlerbars Helper 'fieldTemplate' needs 3 parameters");var h="";t.index=l,c&&(t.email=c.email);switch(t.displayType){case"checkbox":t.type==="list"?h=r(t):h=n(t);break;case"select":h=i(t);break;case"radiobutton":h=s(t);break;case"textarea":h=u(t);break;case"hidden":h=a(t);break;case"date":h=f(t);break;default:h=o(t)}return new e.SafeString(h)}var n=e.compile('<input id="{{id}}" type="checkbox" name="Values[{{index}}].Value" class="input_checkbox" value="true" /><label for="{{id}}" class="checkbox">{{label}}</label><input name="Values[{{index}}].Value" type="hidden" value="false">'),r=e.compile('<td class="lead-label"><label>{{label}}</label>{{#each this.values}}{{#compare this.value ../defaultValue operator="=="}}<input id="{{../id}}" type="checkbox" name="../Values[{{index}}].Value" class="input_checkbox" value="{{this.value}}" checked="checked"/>{{else}}<input id="{{../id}}" type="checkbox" name="../Values[{{index}}].Value" class="input_checkbox" value="{{this.value}}" />{{/compare}}<label for="{{../id}}" class="checkbox">{{label}}</label>{{/each}}'),i=e.compile('<td class="lead-label"><label for="{{id}}">{{label}}</label><select id="{{id}}" name="Values[{{index}}].Value" {{#if this.multiple}}multiple="multiple"{{/if}} {{#if this.size}}size="{{this.size}}"{{/if}}>{{#each this.values}}{{#compare this.value ../defaultValue operator="=="}}<option value="{{this.value}}" selected="selected">{{this.label}}</option>{{else}}<option value="{{this.value}}" >{{this.label}}</option>{{/compare}}{{/each}}</select>'),s=e.compile('<td class="lead-label"><label for="{{id}}">{{label}}</label>{{#each this.values}}<label>{{#compare this.value ../defaultValue operator="=="}}<input name="Values[{{../index}}].Value" value="{{this.value}}" type="radio" checked="checked" />{{else}}<input name="Values[{{../index}}].Value" value="{{this.value}}" type="radio" />{{/compare}}{{this.label}} </label>{{/each}}'),o=e.compile('<td class="lead-label"><label for="{{id}}">{{this.label}}</label>{{#compare this.name "email" operator="=="}}{{#if email}}<input name="Values[{{index}}].Value" id="{{this.id}}" type="text" class="input_txt" value="{{email}}" />{{else}}<input name="Values[{{index}}].Value" id="{{this.id}}" type="text" class="input_txt" />{{/if}}{{else}}<input name="Values[{{index}}].Value" id="{{this.id}}" type="text" class="input_txt" />{{/compare}}'),u=e.compile('<td class="lead-label"><label for="{{id}}">{{this.label}}</label><textarea name="Values[{{index}}].Value" id="{{this.id}}" rows="{{this.rows}}" cols="{{this.cols}}" ></textarea>'),a=e.compile('<td colspan="2" style="display:none"><input name="Values[{{index}}].Value" id="{{this.id}}" type="hidden" class="input_txt" value="{{this.defaultValue}}" />'),f=e.compile('<td class="lead-label"><label for="{{id}}">{{label}}</label><select id="ysdate_day_{{id}}" name="ysdate_day_{{id}}">{{#enumerate "day" emptyFirstChoice=true}}<option value="{{@index}}">{{@index}}</option>{{/enumerate}}</select><select id="ysdate_month_{{id}}" name="ysdate_month_{{id}}">{{#enumerate "month" emptyFirstChoice=true}}<option value="{{@index}}">{{@value}}</option>{{/enumerate}}</select><select id="ysdate_year_{{id}}" name="ysdate_year_{{id}}">{{#enumerate "year" emptyFirstChoice=true}}<option value="{{@index}}">{{@index}}</option>{{/enumerate}}</select><input name="Values[{{index}}].Value" id="{{this.id}}" type="hidden" />');return e.registerHelper("fieldTemplate",t),t}),define("hbs!aura_components/viewport-lead-sharing/viewport-lead-sharing",["hbs","hbs/handlebars","templates/helpers/compare","templates/helpers/fieldTemplate","templates/helpers/safeString"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var r="",i;r+='\r\n                    <div class="leadsharing_form_infos">\r\n                        ',i=n["if"].call(e,e&&e.title,{hash:{},inverse:b.noop,fn:b.program(2,o,t),data:t});if(i||i===0)r+=i;r+="\r\n                        ",i=n["if"].call(e,e&&e.description,{hash:{},inverse:b.noop,fn:b.program(4,u,t),data:t});if(i||i===0)r+=i;return r+="\r\n                    </div>\r\n                ",r}function o(e,t){var r="",i;return r+='\r\n                            <h3 class="leadsharing-descrTitle">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e&&e.title,i=typeof i===g?i.call(e,{hash:{},data:t}):i),r+=y(i)+"</h3>\r\n                        ",r}function u(e,t){var r="",i,s;return r+='\r\n                            <p class="leadsharing-descr">\r\n                               <span>'+y((i=(i=e&&e.text,i==null||i===!1?i:i.description),typeof i===g?i.apply(e):i))+" :</span> ",(s=n.description)?s=s.call(e,{hash:{},data:t}):(s=e&&e.description,s=typeof s===g?s.call(e,{hash:{},data:t}):s),r+=y(s)+"\r\n                            </p>\r\n                        ",r}function a(e,t,r){var i="",s,o;i+="\r\n                        ",s=n["if"].call(e,e&&e.dependOnField,{hash:{},inverse:b.program(12,h,t),fn:b.program(7,f,t),data:t});if(s||s===0)i+=s;return i+="\r\n                                ",o={hash:{},data:t},i+=y((s=n.fieldTemplate||e&&e.fieldTemplate,s?s.call(e,e,(s=t,s==null||s===!1?s:s.index),r&&r.currentAccount,o):w.call(e,"fieldTemplate",e,(s=t,s==null||s===!1?s:s.index),r&&r.currentAccount,o)))+'\r\n                                <div style="display:none">\r\n                                    <input name="Values['+y((s=(s=t,s==null||s===!1?s:s.index),typeof s===g?s.apply(e):s))+'].FieldId" value="'+y((s=e&&e.id,typeof s===g?s.apply(e):s))+'" type="hidden" />\r\n                                </div>\r\n                            </div>\r\n                    ',i}function f(e,t){var r="",i,s,o;r+="\r\n                            ",o={hash:{operator:"=="},inverse:b.programWithDepth(10,c,t,e),fn:b.programWithDepth(8,l,t,e),data:t},s=(i=n.compare||e&&e.compare,i?i.call(e,(i=(i=e&&e.field,i==null||i===!1?i:i.dependOnField),i==null||i===!1?i:i.action),"show",o):w.call(e,"compare",(i=(i=e&&e.field,i==null||i===!1?i:i.dependOnField),i==null||i===!1?i:i.action),"show",o));if(s||s===0)r+=s;return r+="\r\n                        ",r}function l(e,t,n){var r="",i;return r+='\r\n                                <div class="yslp-'+y((i=e&&e.displayType,typeof i===g?i.apply(e):i))+'" style="display:none" id="ys_dependon_'+y((i=n&&n.id,typeof i===g?i.apply(e):i))+'">\r\n                            ',r}function c(e,t,n){var r="",i;return r+='\r\n                                <div class="yslp-'+y((i=e&&e.displayType,typeof i===g?i.apply(e):i))+'" id="ys_dependon_'+y((i=n&&n.id,typeof i===g?i.apply(e):i))+'">\r\n                            ',r}function h(e,t){var n="",r;return n+='\r\n                            <div class="yslp-'+y((r=e&&e.displayType,typeof r===g?r.apply(e):r))+'">\r\n                        ',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var p="",d,v,m,g="function",y=this.escapeExpression,b=this,w=n.helperMissing;p+='<div class="content">\r\n    <div class="subcontent">\r\n        <div class="subcontent2">\r\n            <div id="leadsharing_header" class="leadsharing_header">\r\n                <h3>'+y((d=(d=t&&t.text,d==null||d===!1?d:d.toAccessNeedMoreInformation),typeof d===g?d.apply(t):d))+"<b>"+y((d=(d=t&&t.text,d==null||d===!1?d:d.toAccessNeedMoreInformation2),typeof d===g?d.apply(t):d))+'</b></h3>\r\n            </div>\r\n\r\n            <form id="leadsharing_form" class="leadsharing_form ajax_form" action="/Premium/LeadSharingProcess/FillCampaignForm" method="POST">\r\n                ',m={hash:{operator:"||"},inverse:b.noop,fn:b.program(1,s,i),data:i},v=(d=n.compare||t&&t.compare,d?d.call(t,t&&t.title,t&&t.description,m):w.call(t,"compare",t&&t.title,t&&t.description,m));if(v||v===0)p+=v;p+='\r\n\r\n                <input type="hidden" value="',(v=n.id)?v=v.call(t,{hash:{},data:i}):(v=t&&t.id,v=typeof v===g?v.call(t,{hash:{},data:i}):v),p+=y(v)+'" name="id" />\r\n                <input type="hidden" value="',(v=n.referer)?v=v.call(t,{hash:{},data:i}):(v=t&&t.referer,v=typeof v===g?v.call(t,{hash:{},data:i}):v),p+=y(v)+'" name="Referer" />\r\n\r\n                <div class="leadsharing_form_content">\r\n\r\n                    ',v=n.each.call(t,t&&t.fields,{hash:{},inverse:b.noop,fn:b.programWithDepth(6,a,i,t),data:i});if(v||v===0)p+=v;return p+='\r\n\r\n                    <div class="leadsharing_form_cgu">\r\n                              ',m={hash:{},data:i},p+=y((d=n.safeString||t&&t.safeString,d?d.call(t,(d=t&&t.text,d==null||d===!1?d:d.acceptCondition),m):w.call(t,"safeString",(d=t&&t.text,d==null||d===!1?d:d.acceptCondition),m)))+'\r\n                    </div>\r\n\r\n                    <div class="leadsharing_form_valid-ctn">\r\n                        <div class="leadsharing_form_valid">\r\n                            <input id="yslead-submit-form" type="submit" Value="'+y((d=(d=t&&t.text,d==null||d===!1?d:d.validateAndShowDocument),typeof d===g?d.apply(t):d))+'" class="input_submit" />\r\n                            <label for="yslead-submit-form">\r\n                                <span id="yslead-submit-validate">'+y((d=(d=t&&t.text,d==null||d===!1?d:d.validateAndShowDocument),typeof d===g?d.apply(t):d))+'</span>\r\n                                <span id="yslead-submit-wait" class="lead-loading" style="display:none">'+y((d=(d=t&&t.text,d==null||d===!1?d:d.waitForValidation),typeof d===g?d.apply(t):d))+'</span>\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                    <span class="messages"></span>\r\n                    <span id="yslead-wait-message" style="display:none">'+y((d=(d=t&&t.text,d==null||d===!1?d:d.waitValidationMessage),typeof d===g?d.apply(t):d))+"</span>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n",p});return n}),function(e){e.version="0.1.0",e.replacements={"%20":"+","%2C":","},e.encode=function(t){var n=e.replacements;return encodeURIComponent(t).replace(/(\%[A-F0-9]{2})/g,function(e,t){return t in n?n[t]:t})},e.decode=function(e){return decodeURIComponent(e.replace(/\+/g," "))},e.parse=function(t,n){t.charAt(0)==="?"&&(t=t.substr(1));var r={};return t.split(n||"&").forEach(function(t){var n=t.split("=",2),i=e.decode(n[0]),s=n.length>1?e.decode(n[1]):!0;switch(s){case"true":s=!0;break;case"false":s=!1;break;case"":break;default:var o=+s;isNaN(o)||(s=o)}r[i]=s}),r},e.format=function(t,n,r){var i=[];for(var s in t)t.hasOwnProperty(s)&&typeof t[s]!="function"&&typeof t[s]!="undefined"&&i.push({key:s,value:String(t[s])});return r&&i.sort(function(e,t){return e.key>t.key?1:e.key<t.key?-1:0}),i.length?i.map(function(t){return[e.encode(t.key),e.encode(t.value)].join("=")}).join(n||"&"):""}}(typeof module=="object"?module.exports:this.qs={}),define("bower_components/qs/qs",function(){}),define("./__component__$viewport-lead-sharing@default",["underscore","i18n!nls/text","hbs!aura_components/viewport-lead-sharing/viewport-lead-sharing","bower_components/qs/qs"],function(e,t,n){var r=null,i=null;return{initialize:function(){e.bindAll(this,"formSubmited","beforeFormSubmitted","render","addTracking"),this.sandbox.on("reader.leadSharing.render",this.render),this.sandbox.leadSharing.show("Streaming")},formSubmited:function(t,n){var i=function(){var e=this;this.$el.fadeOut("fast",function(){e.$el.remove(),e.sandbox.leadSharing.set("display",!1)}),this.addTracking(n.Content),this.sandbox.leadSharing.get("referer")==="Download"&&window.setTimeout(function(){e.sandbox.emit("reader.popin.change","download")},700),this.sandbox.pages.set("currentIndex",this.sandbox.reader.get("previewPages").length,{silent:!0});var t={rights:this.sandbox.reader.get("rights")};t.rights.reading=!0,this.sandbox.reader.set(t),this.sandbox.emit("reader.rights.changed",t)};if(n.IsValid){var s=r.find("#form-email").val();r.find("#yslead-submit-validate").hide(),r.find("#yslead-submit-wait").show(),r.find("#yslead-wait-message").show(),this.sandbox.leadSharing.waitForValidation(s,e.bind(i,this))}},beforeFormSubmitted:function(e,t){return this.sandbox.leadSharing.processFormInput(r),r.find("#form-email").val(i.val()),!0},setValidation:function(e){$.validator&&($.validator.addMethod("maxLength",function(e,t,n){return e===""||e.length<=n}),$.validator.addMethod("dateRequired",function(e,t){var n=t.id.split("_");return $("#ysdate_day_"+n[2]).val()===""?!1:$("#ysdate_month_"+n[2]).val()===""?!1:e.length>0}));var t={},n={};for(var s=0;s<e.fields.length;s++){var o=e.fields[s];o.name==="email"&&(i=$("#"+o.id));if(o.dependOnField){var u=r.find("#"+o.dependOnField.fieldId),a=o.dependOnField.action;u.on("change",function(){$.inArray($(this).val(),o.dependOnField.values)>=0?r.find("#ys_dependon_"+o.id)[a]():r.find("#ys_dependon_"+o.id)[a==="show"?"hide":"show"]()}),$.inArray(u.val(),o.dependOnField.values)>=0?r.find("#ys_dependon_"+o.id)[a]():r.find("#ys_dependon_"+o.id)[a==="show"?"hide":"show"]()}o.validation&&this.sandbox.leadSharing.makeRulesAndMessages(o,s,t,n)}$.validator&&r.validate({success:function(e){e.addClass("valid")},rules:t,messages:n})},addHiddenInputs:function(e){$('<input type="hidden" name="ProductId" />').val(this.sandbox.reader.get("productId")).appendTo(r),$('<input type="hidden" name="Email" id="form-email" />').val(e.account?e.account.email:"").appendTo(r),$('<input type="hidden" name="ys_url" id="form-ysurl" />').val(document.URL).appendTo(r);var t=qs.parse(window.location.search);if(t.ys_source===undefined&&document.referrer!==""){var n=document.referrer.replace("http://","").replace("https://",""),i=n.indexOf("/");i>0&&(n=n.substring(0,i)),t.ys_source=n,n.indexOf("youscribe.com")>=0&&(t.ys_medium="direct")}t.ys_medium===undefined&&(t.ys_medium=document.referrer!==""?"referrer":"direct"),$.each(t,function(e,t){e.substring(0,3)==="ys_"&&$('<input type="hidden" name="'+e+'" />').val(t).appendTo(r)})},render:function(s){e.extend(s,{referer:this.sandbox.leadSharing.get("referer"),text:t}),this.html(n(s)),this.$el.show(),r=this.$el.find("form"),i=null,s.account&&r.find("#ysld-email").val(s.account.email),this.addHiddenInputs(s),this.setValidation(s),r.on("beforeSubmit",this.beforeFormSubmitted),r.on("submitted",this.formSubmited)},addTracking:function(e){$("<iframe marginheight='0' marginwidth='0' frameborder='0' width='0' height='0' src='/Adwords/Tracking/977039089?label=RLKaCK-bqQcQ8d3x0QM'></iframe>").appendTo("body");if(typeof e==typeof undefined||e===null)return;if(typeof e.userName!=typeof undefined)if(typeof _gaq!=typeof undefined){var t=["_trackEvent"];t.push("Premium"),t.push("SignUp"),t.push(e.userName),_gaq.push(t)}else typeof ga!=typeof undefined&&ga("_trackEvent","Premium","SignUp",e.userName)}}}),define("hbs!aura_components/viewport-page/viewport-page",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function s(e,t){var r="",i;return r+="\r\n 	<div id='content_page_",(i=n.pageNumber)?i=i.call(e,{hash:{}}):(i=e&&e.pageNumber,i=typeof i===a?i.call(e,{hash:{}}):i),r+=f(i)+"'></div>\r\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var o="",u,a="function",f=this.escapeExpression,l=this;u=n["if"].call(t,t&&t.flash,{hash:{},inverse:l.noop,fn:l.program(1,s,i)});if(u||u===0)o+=u;return o+="\r\n",o});return n}),define("./__component__$viewport-page@default",["underscore","hbs!aura_components/viewport-page/viewport-page"],function(e,t){var n=0;return{initialize:function(){e.bindAll(this,"render","createContent","loaded","scaleContent","toAttach"),this.pageIndex=this.options.pageIndex,this.sandbox.binders.get("zoom").add("after",this.scaleContent),this.sandbox.binders.get("fullscreen").add("after",this.scaleContent),this.sandbox.on("window.resized",this.scaleContent),this.sandbox.on("reader.pages.content.loaded",this.loaded),this.sandbox.on("reader.search.toAttach",this.toAttach),this.render()},toAttach:function(e){this.pageIndex===e.page-1&&(this.$el.append(e.$element[0]),this.sandbox.emit("reader.search.attached",e.index))},scaleContent:function(){this.sandbox.content.scale(this.sandbox.pages.at(this.pageIndex))},render:function(){return this.pageIndex=this.options.pageIndex,this.createContent(),this},createContent:function(){this.html(t({flash:this.sandbox.reader.get("capacities").flash,pageNumber:this.pageIndex})),this.sandbox.pages.at(this.pageIndex).set("$element",this.$el),this.sandbox.emit("reader.viewport.pageCreated")},loaded:function(t){if(this.sandbox.pages.indexOf(t)!==this.pageIndex)return;if(this.sandbox.viewport.get("display")!=="double"){var n=t.get("ratio"),r=100/(100*n)*100;this.$el.css("padding-bottom",r+"%")}if(this.sandbox.reader.get("capacities").html&&t.get("$content")[0].outerHTML){this.$el[0].innerHTML=t.get("$content")[0].outerHTML;var i=this.$el.children();t.set("$content",i)}else this.sandbox.reader.get("capacities").image&&this.$el.append(t.get("$content")[0]);this.$el.removeClass("loadingBG"),this.sandbox.viewport.get("display")==="double"&&this.$el.find(".rd-shadow").length===0&&this.pageIndex>0&&this.pageIndex<this.sandbox.pages.length()&&this.$el.prepend(this.sandbox.util.createShadowImage(this.pageIndex)),this.sandbox.reader.get("embed")&&this.$el.find(".extract").length===0&&this.sandbox.reader.get("rights").reading===!1&&!this.sandbox.reader.get("cover")&&this.sandbox.leadSharing.get("enable")===!1&&this.$el.append(this.sandbox.util.createExtractImage());if(this.$el.find(".extract").length===0){var s=this.sandbox.search.getHighLight(this.pageIndex);s!==null&&e.each(s,function(e){this.$el.append(e.get("$element"))},this)}}}}),require(["app"])})();